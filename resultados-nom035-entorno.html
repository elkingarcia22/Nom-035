<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBITS Playground - Resultados NOM 035 Entorno Laboral</title>
    
    <!-- Estilos locales -->
    <link rel="stylesheet" href="ubits-colors.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="fontawesome-icons.css">
    <link rel="stylesheet" href="ubits-typography.css">
    <!-- Font Awesome CDN como respaldo -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="components-sidebar.css">
    <link rel="stylesheet" href="components/tab-bar.css">
    <link rel="stylesheet" href="components/floating-menu.css">
    <link rel="stylesheet" href="components/profile-menu.css">
    <link rel="stylesheet" href="components/button.css">
    <link rel="stylesheet" href="components/input.css">
    <link rel="stylesheet" href="profile.css">
    <style>
        /* Estilos específicos para la página de resultados - FIEL AL DISEÑO */
        .results-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
            flex: 1;
            min-width: 0;
            width: 100%;
            overflow: visible;
            max-height: none;
        }

        /* Header de resultados - EXACTO COMO LA IMAGEN */
        .results-header {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 2px;
        }

        .back-button {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
            color: #1f2937;
        }

        .title-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .title-section h1 {
            margin: 0;
            color: #1f2937;
            font-size: 24px;
            font-weight: 700;
        }

        .title-section .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid;
            width: 100px;
            text-align: center;
            background: #f0fdf4;
            color: #166534;
            border-color: #22c55e;
        }

        .download-button {
            background: var(--ubits-accent-brand);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .download-button:hover {
            background: var(--ubits-accent-brand-hover);
        }

        /* Información de la encuesta - EXACTO COMO LA IMAGEN */
        .survey-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 0px;
        }

        .survey-description {
            color: #6b7280;
            margin-bottom: 0px;
            line-height: 1.5;
            font-size: 14px;
        }

        .survey-details {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #374151;
            font-size: 14px;
        }

        .detail-separator {
            width: 1px;
            height: 16px;
            background: #d1d5db;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.completed {
            background: #10b981;
            color: white;
        }

        /* Métricas - COMPACTAS COMO LA IMAGEN */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 2px;
            margin-bottom: 8px;
        }

        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .metric-title-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .metric-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f3f4f6;
            border-radius: 6px;
            color: #6b7280;
            font-size: 12px;
        }

        .metric-title {
            color: #374151;
            font-size: 14px;
            font-weight: 600;
            margin: 0;
        }

        .metric-value-section {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .metric-main-number {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            line-height: 1;
        }

        .metric-unit-text {
            font-size: 14px;
            color: #6b7280;
            font-weight: 500;
        }

        /* Panel emocional container */
        .panel-emocional-container {
            background: transparent;
            border-radius: 8px;
            padding: 0;
            margin-bottom: 2px;
        }

        .tabs-header {
            display: flex;
            gap: 8px;
        }

        .tab-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: transparent;
            border: none;
            border-radius: 6px;
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-direction: row;
        }

        .tab-button:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .tab-button.active {
            background: white;
            color: var(--ubits-accent-brand);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tab-icon {
            font-size: 16px;
        }

        .tab-content {
            background: white;
            border-radius: 8px;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 0 0 0;
            margin-top: 8px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* Panel Container - Layout de dos columnas */
        .panel-container {
            display: flex;
            height: 600px;
            gap: 16px;
        }

        .participants-panel {
            flex: 1;
            background: white;
            border-radius: 8px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            width: 100%;
            box-sizing: border-box;
        }

        .participant-details-panel {
            flex: 2;
            background: white;
            border-radius: 8px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            height: 600px;
        }

        /* Panel Header - Rediseñado desde cero */
        .panel-header {
            padding: 8px 24px 0px 24px;
            border-bottom: none;
            background: #f9fafb;
            border-radius: 8px 8px 0 0;
            margin-bottom: 0;
        }

        .panel-header h3 {
            margin: 0;
            color: #1f2937;
            font-size: 18px;
            font-weight: 600;
        }

        /* Search and Filters Container - Solo layout básico */
        .search-filters-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Buscador simple */
        .simple-search-container {
            position: relative;
            width: 100%;
        }

        .simple-search-input {
            width: 100%;
            height: 40px;
            padding: 8px 12px 8px 40px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            color: #374151;
            outline: none;
            box-sizing: border-box;
            transition: border-color 0.2s ease;
        }

        .simple-search-input:focus {
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .simple-search-input::placeholder {
            color: #9ca3af;
        }

        .simple-search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            color: #6b7280;
            pointer-events: none;
            z-index: 1;
        }

        .filters-button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #6b7280;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            width: 44px;
            height: 44px;
            flex-shrink: 0;
            position: relative;
        }

        .filters-button:hover {
            background: #e5e7eb;
            color: #374151;
            border-color: #9ca3af;
        }

        .filters-button:active {
            background: #d1d5db;
        }

        .filter-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--ubits-accent-brand);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }


        .filter-group {
            margin-bottom: 24px;
        }

        .filter-label {
            display: block;
            color: #374151;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 12px;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .filter-option:hover {
            background: #f3f4f6;
        }

        .filter-option input[type="checkbox"] {
            margin: 0;
        }

        .risk-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .risk-indicator.nulo { background: #9ca3af; }
        .risk-indicator.bajo { background: #10b981; }
        .risk-indicator.medio { background: #f59e0b; }
        .risk-indicator.alto { background: #ef4444; }
        .risk-indicator.muy-alto { background: #7c3aed; }

        .filter-actions {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            gap: 12px;
            padding: 20px;
            background: #fff;
            border-top: 1px solid #e5e7eb;
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
        }

        .apply-filters-btn {
            flex: 1;
            background: var(--ubits-accent-brand);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s ease;
        }

        .apply-filters-btn:hover {
            background: var(--ubits-accent-brand-hover);
        }

        .clear-filters-btn {
            flex: 1;
            background: #f3f4f6;
            color: #6b7280;
            border: 1px solid #d1d5db;
            padding: 10px 16px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s ease;
        }

        .clear-filters-btn:hover {
            background: #e5e7eb;
            color: #374151;
        }

        /* Participants List */
        .participants-list {
            flex: 1;
            overflow-y: auto;
        }

        .participant-item {
            display: flex;
            align-items: center;
            padding: 8px 24px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 2px;
            border-left: 4px solid transparent;
        }

        .participant-item:hover {
            background: #f3f4f6;
        }

        .participant-item.selected {
            background: #eff6ff;
            border-left-color: var(--ubits-accent-brand);
        }

        .participant-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .participant-info-content {
            flex: 1;
            min-width: 0;
        }

        .participant-name {
            color: #1f2937;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .participant-role {
            color: #6b7280;
            font-size: 12px;
        }

        .risk-level {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            flex-shrink: 0;
        }

        .risk-level.risk-nulo { background: #f3f4f6; color: #6b7280; }
        .risk-level.risk-bajo { background: #dcfce7; color: #166534; }
        .risk-level.risk-medio { background: #f8f9fa; color: #92400e; }
        .risk-level.risk-alto { background: #fed7aa; color: #c2410c; }
        .risk-level.risk-muy-alto { background: #fecaca; color: #dc2626; }

        /* Participant Details */
        .no-selection {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #9ca3af;
            text-align: center;
            padding: 40px;
        }

        .no-selection i {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .participant-details {
            padding: 16px;
            border-bottom: 1px solid #e5e7eb;
        }

        .participant-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .participant-avatar-large {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .participant-details-content h4 {
            margin: 0 0 2px 0;
            color: #1f2937;
            font-size: 16px;
            font-weight: 600;
        }

        .participant-details-content p {
            margin: 0;
            color: #6b7280;
            font-size: 12px;
        }

        /* Estilos para detalle del participante - Idénticos a emocional */
        .participant-details {
            display: none;
        }

        .participant-details.show {
            display: block;
        }

        .participant-details-content {
            flex: 1;
            overflow-y: auto;
            padding: 0;
            max-height: calc(600px - 40px);
        }

        /* Hacer fijo el header del participante */
        .participant-header {
            position: sticky;
            top: 0;
            background: white;
            z-index: 100;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px;
            margin-top: 0;
        }

        /* Asegurar que la tabla esté por debajo del header fijo */
        .detail-section {
            position: relative;
            z-index: 1;
        }

        .dimensions-table-container {
            position: relative;
            z-index: 1;
        }

        .dimensions-table {
            position: relative;
            z-index: 1;
        }

        /* Estilos para filtros del side modal */
        .filter-label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: background-color 0.2s ease;
        }

        .filter-option:hover {
            background-color: #f3f4f6;
        }

        .filter-option input[type="checkbox"] {
            display: none;
        }

        .checkmark {
            width: 18px;
            height: 18px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .filter-option input[type="checkbox"]:checked + .checkmark {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }

        .filter-option input[type="checkbox"]:checked + .checkmark::after {
            content: '✓';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .filter-text {
            color: #374151;
            font-size: 14px;
            line-height: 1.4;
        }

        .filters-actions {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            gap: 12px;
            padding: 20px;
            background: white;
            border-top: 1px solid #e5e7eb;
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
        }

        .participant-info-line {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .participant-name {
            font-weight: 600;
            color: #1f2937;
            font-size: 14px;
        }

        .participant-separator {
            color: #9ca3af;
            font-weight: 300;
        }

        .participant-role,
        .participant-department,
        .participant-age,
        .participant-gender,
        .participant-status,
        .participant-country,
        .participant-city,
        .participant-experience {
            color: #6b7280;
            font-size: 13px;
        }

        .participant-info {
            padding: 12px 16px;
        }

        .participant-info-line {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .participant-name {
            font-weight: 600;
            color: #1f2937;
        }

        .participant-separator {
            color: #d1d5db;
        }

        .participant-age, .participant-area, .participant-position, .participant-gender, .participant-marital {
            color: #6b7280;
            font-size: 14px;
        }

        /* Survey Results */
        .survey-results {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .survey-section {
            margin-bottom: 8px;
        }

        .section-header {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            background: #f9fafb;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 4px solid #e5e7eb;
        }

        .section-header:hover {
            background: #f3f4f6;
        }

        .section-header.open {
            background: #eff6ff;
            border-left-color: var(--ubits-accent-brand);
        }

        .section-risk-info {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }

        .section-risk-level {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .section-risk-level.nulo { background: #f3f4f6; color: #6b7280; }
        .section-risk-level.bajo { background: #dcfce7; color: #166534; }
        .section-risk-level.medio { background: #f8f9fa; color: #92400e; }
        .section-risk-level.alto { background: #fee2e2; color: #991b1b; }
        .section-risk-level.muy-alto { background: #f3e8ff; color: #6b21a8; }

        .section-percentage {
            color: #6b7280;
            font-size: 12px;
            font-weight: 500;
            min-width: 35px;
            text-align: right;
        }

        .section-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: transparent;
            color: #374151;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .section-title {
            flex: 1;
            font-weight: 600;
            color: #1f2937;
            font-size: 14px;
        }

        .section-chevron {
            color: #6b7280;
            font-size: 12px;
            transition: transform 0.2s ease;
        }

        .section-header.open .section-chevron {
            transform: rotate(180deg);
        }

        .section-content {
            display: none;
            padding: 16px;
            background: white;
            border-bottom: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 6px 6px;
        }

        .section-content.open {
            display: block;
        }

        .question-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .question-item:last-child {
            border-bottom: none;
        }

        .question-text {
            flex: 1;
            color: #374151;
            font-size: 14px;
            line-height: 1.4;
        }

        .question-answer {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .answer-yes {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 500;
        }

        .answer-yes::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ef4444;
            flex-shrink: 0;
        }

        .answer-no {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 500;
        }

        .answer-no::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #22c55e;
            flex-shrink: 0;
        }

        /* Custom Select Component */
        .custom-select {
            position: relative;
            width: 100%;
        }

        .select-trigger {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: #fff;
            color: #374151;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: border-color 0.2s ease;
        }

        .select-trigger:hover {
            border-color: #9ca3af;
        }

        .select-trigger.active {
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .select-trigger .select-text {
            flex: 1;
            text-align: left;
        }

        .select-trigger .select-arrow {
            transition: transform 0.2s ease;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #fff;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .select-dropdown.show {
            display: block;
        }

        .select-option {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s ease;
        }

        .select-option:hover {
            background: #f3f4f6;
        }

        .select-option.selected {
            background: #eff6ff;
            color: var(--ubits-accent-brand);
        }

        .select-option input[type="checkbox"] {
            margin: 0;
        }

        .select-option .option-text {
            flex: 1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .panel-container {
                flex-direction: column;
                height: auto;
            }

            .participants-panel {
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .survey-details {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .detail-separator {
                display: none;
            }
        }

        /* Download Dropdown Styles */
        .download-dropdown {
            position: relative;
            display: inline-block;
        }

        .download-dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
            border-radius: 8px;
            border-bottom: 1px solid #e5e7eb;
            z-index: 1000;
            top: 100%;
            margin-top: 4px;
        }

        .download-dropdown-content.show {
            display: block;
        }

        .download-dropdown-content a {
            color: #374151;
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid #f3f4f6;
        }

        .download-dropdown-content a:last-child {
            border-bottom: none;
        }

        .download-dropdown-content a:hover {
            background-color: #f9fafb;
        }

        .download-dropdown-content a i {
            width: 16px;
            text-align: center;
        }

        /* Tabs Styles */
        .tabs-container {
            margin-top: 16px;
        }

        .tabs-header {
            display: flex;
            gap: 0;
            margin-bottom: 16px;
        }

        .tab-button {
            background: transparent;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.2s ease;
            border-bottom: 2px solid transparent;
            position: relative;
        }

        .tab-button:hover {
            color: #374151;
            background-color: #f9fafb;
        }

        .tab-button.active {
            background: white;
            color: #3b82f6;
            font-weight: 700;
            border-bottom-color: transparent;
        }

        .tab-button i {
            font-size: 16px;
        }

        .tab-content {
            min-height: 200px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .panel-content {
            padding: 24px;
            background: white;
            border-radius: 8px;
            border-bottom: 1px solid #e5e7eb;
        }

        .panel-content h3 {
            margin: 0 0 16px 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
        }

        .panel-content p {
            margin: 0;
            color: #6b7280;
            line-height: 1.6;
        }

        /* Los nuevos tabs ahora usan las mismas clases que los tabs originales */

        /* Results Table Styles */
        .results-table-container {
            overflow-x: auto;
            margin-top: 16px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }

        .results-table thead {
            background: #f8fafc;
        }

        .results-table th {
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
            border-right: none;
            white-space: nowrap;
        }

        .results-table th:first-child {
            border-right: none;
        }

        .results-table td {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
            border-right: none;
            font-size: 14px;
            color: #374151;
            vertical-align: top;
        }

        .results-table td:first-child {
            border-right: none;
        }

        .results-table tbody tr:hover:not(.category-summary) {
            background-color: #fafbfc;
        }

        /* Asegurar que las celdas de dominio y dimensión no se vean afectadas por otros estilos */
        .results-table .category-summary td.category-domain-info,
        .results-table .category-summary td.category-dimension-info {
            background: inherit !important;
        }

        .category-cell {
            font-weight: 600;
            background: inherit !important;
            border-right: 1px solid #e5e7eb;
            min-width: 200px;
        }


        .summary-text {
            font-weight: 600;
            color: #6b7280;
            font-style: italic;
        }

        .risk-count {
            font-weight: 600;
            text-align: center;
            background: none !important;
            border: none !important;
            border-radius: 0 !important;
            padding: 0 !important;
            color: #374151 !important;
            display: inline !important;
            width: auto !important;
            height: auto !important;
            min-width: auto !important;
            min-height: auto !important;
        }
        
        /* Asegurar que los números no tengan formato de círculo */
        .results-table .risk-count {
            background: transparent !important;
            border: none !important;
            border-radius: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            display: inline !important;
            width: auto !important;
            height: auto !important;
        }
        
        /* Estilos específicos para la nueva tabla de prueba */
        .results-table-container .results-table .risk-count {
            background: none !important;
            border: none !important;
            border-radius: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            display: inline !important;
            width: auto !important;
            height: auto !important;
            min-width: auto !important;
            min-height: auto !important;
            font-size: 14px !important;
            line-height: normal !important;
        }
        
        /* Estado activo solo cuando el acordeón está abierto - usando colores de tabla original */
        .results-table-container .results-table .category-summary {
            background: #f9fafb;
            border-left: 4px solid #e5e7eb;
            transition: all 0.2s ease;
        }
        
        .results-table-container .results-table .category-summary:hover {
            background: #e5e7eb !important;
        }
        
        .results-table-container .results-table .category-summary.active {
            background: #dbeafe !important;
            border-left: 4px solid var(--ubits-accent-brand) !important;
        }
        
        /* Estilo para la celda de categoría con número en círculo */
        .results-table-container .results-table .category-cell {
            position: relative;
            padding-left: 50px !important;
        }
        
        .results-table-container .results-table .category-cell::before {
            content: attr(data-number);
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background: transparent;
            color: #374151;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        /* Asegurar que todas las celdas de la fila tengan el mismo comportamiento */
        .results-table-container .results-table .category-summary td {
            background: inherit !important;
        }
        
        .results-table-container .results-table .category-summary:hover td {
            background: #e5e7eb !important;
        }
        
        .results-table-container .results-table .category-summary.active td {
            background: #dbeafe !important;
        }

        .percentage {
            font-weight: 600;
            text-align: center;
            color: #6b7280;
        }

        .risk-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            min-width: 60px;
        }

        .risk-badge.nulo {
            background-color: #f3f4f6;
            color: #6b7280;
        }

        .risk-badge.bajo {
            background-color: #dcfce7;
            color: #166534;
        }

        .risk-badge.medio {
            background-color: #fef3c7;
            color: #92400e;
        }

        .risk-badge.alto {
            background-color: #fed7aa;
            color: #c2410c;
        }

        .risk-badge.muy-alto {
            background-color: #fecaca;
            color: #dc2626;
        }

        /* Estilos para respuestas con puntos de colores */
        .response-with-dot {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 500;
        }

        .response-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .response-dot.siempre {
            background-color: #22c55e;
        }

        .response-dot.casi-siempre {
            background-color: #f59e0b;
        }

        .response-dot.algunas-veces {
            background-color: #ef4444;
        }

        .response-dot.casi-nunca {
            background-color: #6b7280;
        }

        .response-dot.nunca {
            background-color: #374151;
        }

        /* Estilos para puntos de nivel de riesgo */
        .response-dot.bajo {
            background-color: #22c55e; /* Verde para bajo */
        }

        .response-dot.medio {
            background-color: #f59e0b; /* Amarillo para medio */
        }

        .response-dot.alto {
            background-color: #ef4444; /* Rojo para alto */
        }


        /* Estilos para las filas de categoría con dropdown - Estilo emocional */
        .category-summary {
            cursor: pointer;
            background: #f9fafb;
            border-radius: 6px;
            transition: all 0.2s ease;
            border-left: 4px solid #e5e7eb;
            margin-bottom: 8px;
        }

        .category-summary:hover {
            background: #e5e7eb !important;
        }

        .category-summary.open {
            background: #dbeafe !important;
            border-left-color: var(--ubits-accent-brand);
        }

        /* Asegurar que todas las celdas de la fila tengan el mismo comportamiento */
        .category-summary td {
            background: inherit !important;
            border-radius: 0;
        }

        .category-summary:hover td {
            background: #e5e7eb !important;
        }

        .category-summary.open td {
            background: #dbeafe !important;
        }

        .category-header-row {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            gap: 12px;
        }

        .category-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: transparent;
            color: #374151;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .category-domain-info {
            font-size: 13px;
            color: #374151;
            font-weight: 500;
            padding: 8px 16px;
            min-width: 200px;
            width: 200px;
            max-width: 200px;
            transition: color 0.3s ease;
            background: inherit !important;
        }

        .category-dimension-info {
            font-size: 12px;
            color: #6b7280;
            font-weight: 400;
            padding: 8px 16px;
            min-width: 250px;
            width: 250px;
            max-width: 250px;
            transition: color 0.3s ease;
            background: inherit !important;
        }

        /* Asegurar que las celdas mantengan el fondo correcto en todos los estados */
        .category-summary.open .category-domain-info,
        .category-summary.open .category-dimension-info {
            background: #dbeafe !important;
        }

        .category-summary:hover .category-domain-info,
        .category-summary:hover .category-dimension-info {
            background: #e5e7eb !important;
        }

        /* Eliminar borde inferior de las filas de categoría cuando están expandidas */
        .category-summary.open td {
            border-bottom: none !important;
        }

        .category-cell {
            font-weight: 600;
            background: transparent;
            padding: 0;
        }

        .category-cell span {
            font-size: 14px;
            color: #374151;
        }

        /* Estilos para dimensiones */
        .dimension-cell {
            font-weight: 600;
            background: transparent;
            padding: 0;
        }

        .dimension-cell span {
            font-size: 14px;
            color: #374151;
        }

        .dimension-header-row {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            gap: 12px;
        }

        .dimension-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: #3b82f6;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 600;
        }

        .category-risk-info {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: space-between;
            width: 100%;
        }

        .category-percentage {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            min-width: 35px;
            text-align: right;
        }

        .category-chevron {
            color: #6b7280;
            transition: transform 0.2s ease;
            font-size: 12px;
        }

        .category-summary.open .category-chevron {
            transform: rotate(180deg);
        }

        .category-detail {
            background: #fafbfc;
            border-radius: 4px;
            margin: 4px 0;
        }

        /* Estilos para las celdas de estadísticas en filas de resumen */
        .category-summary td:nth-child(4),
        .category-summary td:nth-child(5) {
            font-weight: 600;
            color: #374151;
            font-size: 12px;
        }

        .category-summary td:last-child {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* Estilos para los badges de riesgo */
        .risk-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .risk-badge.nulo {
            background: #f3f4f6;
            color: #6b7280;
        }

        .risk-badge.bajo {
            background: #dcfce7;
            color: #166534;
        }

        .risk-badge.medio {
            background: #fef3c7;
            color: #92400e;
        }

        .risk-badge.alto {
            background: #fed7aa;
            color: #c2410c;
        }

        .risk-badge.muy-alto {
            background: #fecaca;
            color: #dc2626;
        }

        /* Table Header and Controls */
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .table-header h3 {
            margin: 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
        }

        .table-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-left: auto;
        }

        /* Panel de Filtros */
        .filters-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .filters-panel.show {
            right: 0;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
        }

        .filters-header h3 {
            margin: 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
        }

        .close-filters-btn {
            background: none;
            border: none;
            color: #6b7280;
            font-size: 18px;
            cursor: pointer;
            padding: 4px;
        }

        .filters-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }

        .filter-group {
            margin-bottom: 24px;
        }

        .filter-label {
            display: block;
            margin-bottom: 8px;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
        }

        .filter-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            color: #374151;
            font-size: 14px;
        }

        .filter-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .filters-actions {
            padding: 20px 24px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 12px;
        }

        .filters-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .filters-backdrop.show {
            opacity: 1;
            visibility: visible;
        }






        .filters-side-panel * {
            max-width: 100%;
            box-sizing: border-box;
        }

        .filters-side-panel.show {
            right: 0 !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Backdrop para el side panel */
        .filters-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .filters-backdrop.show {
            opacity: 1 !important;
            visibility: visible !important;
            display: block !important;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
        }

        .filters-header h3 {
            margin: 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
        }

        .close-filters-btn {
            background: none;
            border: none;
            color: #6b7280;
            font-size: 18px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }

        .close-filters-btn:hover {
            background-color: #f3f4f6;
        }

        .filters-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            overflow-x: hidden;
            padding-bottom: 100px; /* Espacio para los botones fijos */
            max-width: 100%;
            box-sizing: border-box;
        }

        .filter-group {
            margin-bottom: 20px;
            max-width: 100%;
            overflow-x: hidden;
        }


        .filter-label {
            display: block;
            margin-bottom: 8px;
            color: #374151;
            font-size: 14px;
            font-weight: 600;
        }

        .custom-select {
            position: relative;
            width: 100%;
        }

        .select-trigger {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s ease;
        }

        .select-trigger:hover {
            border-color: #9ca3af;
        }

        .select-trigger.active {
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .select-text {
            color: #374151;
            font-size: 14px;
        }

        .select-arrow {
            color: #6b7280;
            font-size: 12px;
            transition: transform 0.2s ease;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .select-dropdown.show {
            display: block;
        }

        .select-option {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            gap: 8px;
        }

        .select-option:hover {
            background-color: #f9fafb;
        }

        .select-option input[type="checkbox"] {
            margin: 0;
        }

        .risk-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .risk-indicator.nulo {
            background-color: #f3f4f6;
        }

        .risk-indicator.bajo {
            background-color: #dcfce7;
        }

        .risk-indicator.medio {
            background-color: #fef3c7;
        }

        .risk-indicator.alto {
            background-color: #fed7d7;
        }

        .risk-indicator.muy-alto {
            background-color: #fecaca;
        }

        /* Estilos para Heatmap */
        .heatmap-table {
            border-collapse: collapse;
            width: 100%;
            min-width: 1200px;
            font-size: 12px;
        }

        .heatmap-cell {
            width: 24px;
            height: 24px;
            border: 1px solid #e5e7eb;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            font-size: 10px;
            font-weight: 600;
            color: #374151;
        }

        .heatmap-cell:hover {
            transform: scale(1.3);
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 2px solid #3b82f6;
        }

        .heatmap-cell.bajo {
            background-color: #dcfce7; /* Verde claro */
            color: #166534;
        }

        .heatmap-cell.medio {
            background-color: #fef3c7; /* Amarillo claro */
            color: #92400e;
        }

        .heatmap-cell.alto {
            background-color: #fed7aa; /* Naranja claro */
            color: #c2410c;
        }

        .heatmap-cell.muy-alto {
            background-color: #fecaca; /* Rojo claro */
            color: #dc2626;
        }

        .heatmap-participant-name {
            font-size: 11px;
            font-weight: 600;
            color: #374151;
            padding: 8px 12px;
            background: #f8f9fa;
            border-right: 2px solid #e5e7eb;
            min-width: 120px;
            text-align: left;
            white-space: nowrap;
        }

        .heatmap-question-number {
            font-size: 9px;
            font-weight: 500;
            color: #6b7280;
            text-align: center;
            padding: 4px 2px;
            background: #f8f9fa;
            border-bottom: 1px solid #e5e7eb;
            min-width: 24px;
            height: 24px;
        }

        .heatmap-tooltip {
            position: absolute;
            background: #1f2937;
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .heatmap-tooltip.show {
            opacity: 1;
        }

        /* Estilos para encabezados de dimensión */
        .heatmap-dimension-header {
            background: #e5e7eb;
            text-align: center;
            font-weight: 600;
            padding: 8px;
            border: 1px solid #d1d5db;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .heatmap-dimension-header:hover {
            background: #d1d5db;
        }


        .apply-filters-btn,
        .clear-filters-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s ease;
        }

        .apply-filters-btn {
            background: var(--ubits-accent-brand);
            color: white;
        }

        .apply-filters-btn:hover {
            background: #2563eb;
        }

        .clear-filters-btn {
            background: #f3f4f6;
            color: #374151;
        }

        .clear-filters-btn:hover {
            background: #e5e7eb;
        }

        .filters-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            padding: 20px 24px 24px 24px;
            margin: 0;
        }

        /* Filters Button - Tamaño fijo y bien alineado */
        .filters-button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #6b7280;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            position: relative;
            width: 40px;
            height: 40px;
        }

        .filters-button:hover {
            background: #e5e7eb;
            color: #374151;
            border-color: #9ca3af;
        }

        .filters-button:active {
            background: #d1d5db;
        }

        .filter-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--ubits-accent-brand);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            min-width: 18px;
        }

        /* CSS específico para filtros individuales - COPIADO EXACTAMENTE DE EMOCIONAL */
        .custom-select {
            position: relative;
            width: 100%;
        }

        .select-trigger {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: #fff;
            color: #374151;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .select-trigger:hover {
            border-color: #9ca3af;
        }

        .select-trigger.active {
            border-color: #3b82f6;
        }

        .select-arrow {
            color: #6b7280;
            transition: transform 0.2s ease;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #fff;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .select-dropdown.show {
            display: block;
        }

        .select-option {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s ease;
        }

        .select-option:hover {
            background: #f3f4f6;
        }

        .select-option input[type="checkbox"] {
            margin-right: 8px;
        }

        .option-text {
            color: #374151;
            font-size: 14px;
        }

        /* FORZAR ESTILOS PARA INDIVIDUAL FILTERS - ESPECIFICIDAD ALTA */
        #individual-filters-side-panel .custom-select {
            position: relative !important;
            width: 100% !important;
            margin-bottom: 16px !important;
        }

        #individual-filters-side-panel .select-trigger {
            width: 100% !important;
            padding: 8px 12px !important;
            border: 1px solid #d1d5db !important;
            border-radius: 6px !important;
            background: #fff !important;
            color: #374151 !important;
            font-size: 14px !important;
            cursor: pointer !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
        }

        #individual-filters-side-panel .select-trigger:hover {
            border-color: #9ca3af !important;
        }

        #individual-filters-side-panel .select-trigger.active {
            border-color: #3b82f6 !important;
        }

        #individual-filters-side-panel .select-arrow {
            color: #6b7280 !important;
            transition: transform 0.2s ease !important;
        }

        #individual-filters-side-panel .select-trigger.active .select-arrow {
            transform: rotate(180deg) !important;
        }

        #individual-filters-side-panel .select-dropdown {
            position: absolute !important;
            top: 100% !important;
            left: 0 !important;
            right: 0 !important;
            background: #fff !important;
            border: 1px solid #d1d5db !important;
            border-radius: 6px !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
            z-index: 1001 !important;
            max-height: 200px !important;
            overflow-y: auto !important;
            display: none !important;
        }

        #individual-filters-side-panel .select-dropdown.show {
            display: block !important;
        }

        /* FORZAR POSICIONAMIENTO CORRECTO */
        #individual-filters-side-panel {
            overflow: visible !important;
        }

        #individual-filters-side-panel .filters-content {
            overflow: visible !important;
        }

        #individual-filters-side-panel .custom-select {
            overflow: visible !important;
        }

        /* SOLUCIONAR OVERFLOW EN PANEL DE FILTROS NUEVOS */
        #new-table-filters-side-panel {
            overflow: visible !important;
        }

        #new-table-filters-side-panel .filters-content {
            overflow: visible !important;
        }

        #new-table-filters-side-panel .custom-select {
            overflow: visible !important;
        }

        /* FORZAR DROPDOWNS A APARECER */
        #new-table-filters-side-panel .select-dropdown {
            position: fixed !important;
            z-index: 9999 !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }

        #new-table-filters-side-panel .select-dropdown.show {
            position: fixed !important;
            z-index: 9999 !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }

        /* SOLUCIÓN ALTERNATIVA: DROPDOWN COMPLETAMENTE NUEVO */
        .ubits-dropdown-overlay {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 10000 !important;
            pointer-events: none !important;
        }

        .ubits-dropdown-container {
            position: fixed !important;
            z-index: 10001 !important;
            background: white !important;
            border: 1px solid #d1d5db !important;
            border-radius: 6px !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
            max-height: 200px !important;
            overflow-y: auto !important;
            pointer-events: auto !important;
            display: none !important;
        }

        .ubits-dropdown-container.show {
            display: block !important;
        }

        .ubits-dropdown-option {
            padding: 8px 12px !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            transition: background-color 0.2s ease !important;
        }

        .ubits-dropdown-option:hover {
            background: #f3f4f6 !important;
        }

        #individual-filters-side-panel .select-option {
            padding: 8px 12px !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            transition: background-color 0.2s ease !important;
        }

        #individual-filters-side-panel .select-option:hover {
            background: #f3f4f6 !important;
        }

        #individual-filters-side-panel .select-option input[type="checkbox"] {
            margin-right: 8px !important;
        }

        #individual-filters-side-panel .option-text {
            color: #374151 !important;
            font-size: 14px !important;
        }

        .filters-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .filters-overlay.show {
            display: block;
        }

        /* Estilos para la tabla de dimensiones */
        .dimension-row {
            border-bottom: 1px solid var(--ubits-border-1);
        }

        .dimension-row:hover {
            background: var(--ubits-bg-2);
        }

        .dimension-cell {
            padding: 12px 16px;
            font-weight: 600;
            color: var(--ubits-fg-1-high);
            background: inherit !important;
        }

        .dimension-header-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dimension-number {
            background: var(--ubits-fg-1-medium);
            color: var(--ubits-bg-1);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .dimension-domain-info {
            font-size: 13px;
            color: var(--ubits-fg-1-medium);
            font-weight: 500;
            padding: 12px 16px;
            background: inherit !important;
        }

        .dimension-risk-info {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Estilos para tabla de dimensiones individuales */
        .dimensions-table-container {
            margin-top: 16px;
            overflow-x: auto;
            max-width: 100%;
            width: 100%;
        }

        .dimensions-table {
            width: 100%;
            max-width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            table-layout: fixed;
        }

        .dimensions-table thead {
            background: #f8fafc;
        }

        .dimensions-table th {
            padding: 12px 16px;
            text-align: left;
            vertical-align: middle;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
            border-right: none;
            border-left: none;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dimensions-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #f3f4f6;
            border-right: none;
            border-left: none;
            font-size: 14px;
            vertical-align: middle;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dimensions-table tbody tr:hover {
            background: #f9fafb;
        }

        .dimension-name {
            font-weight: 500;
            color: #1f2937;
            vertical-align: middle;
        }

        .dimension-domain {
            color: #6b7280;
            font-size: 13px;
            vertical-align: middle;
        }

        /* Anchos específicos para columnas de la tabla de dimensiones */
        .dimensions-table th:nth-child(1),
        .dimensions-table td:nth-child(1) {
            width: 40%;
            max-width: 200px;
        }

        .dimensions-table th:nth-child(2),
        .dimensions-table td:nth-child(2) {
            width: 15%;
            max-width: 80px;
        }

        .dimensions-table th:nth-child(3),
        .dimensions-table td:nth-child(3) {
            width: 15%;
            max-width: 80px;
        }

        .dimensions-table th:nth-child(4),
        .dimensions-table td:nth-child(4) {
            width: 15%;
            max-width: 80px;
        }

        .dimensions-table th:nth-child(5),
        .dimensions-table td:nth-child(5) {
            width: 15%;
            max-width: 80px;
        }

        .dimension-score {
            font-weight: 600;
            color: #1f2937;
            vertical-align: middle;
        }

        .dimension-percentage {
            font-weight: 600;
            color: #1f2937;
            vertical-align: middle;
        }

        .dimension-risk {
            text-align: center;
            vertical-align: middle;
        }

        .risk-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .risk-bajo {
            background: #dcfce7;
            color: #166534;
        }

        .risk-medio {
            background: #f8f9fa;
            color: #92400e;
        }

        .risk-alto {
            background: #fed7d7;
            color: #c53030;
        }

        .risk-muy-alto {
            background: #fecaca;
            color: #991b1b;
        }

        /* FORZAR VISIBILIDAD DEL PANEL INDIVIDUAL */
        #individual-participant-details {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            min-height: 200px !important;
        }

        .participant-details {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .detail-section {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            margin-bottom: 20px !important;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Navigation -->
            <div id="top-nav-container"></div>

            <!-- Content Area -->
            <div class="content-area">
                <div class="results-container">
                    <!-- Header de resultados -->
                    <div class="results-header">
                        <button class="back-button" onclick="window.history.back()">
                            <i class="far fa-arrow-left"></i>
                            <span>Regresar</span>
                        </button>
                        <div class="title-section">
                            <h1>NOM 035 Entorno Laboral</h1>
                            <span class="status-badge">Completado</span>
                        </div>
                        <div style="margin-left: auto;">
                            <div class="download-dropdown">
                                <button class="ubits-button ubits-button--primary ubits-button--md" type="button" id="download-btn" onclick="toggleDownloadDropdown()">
                                    <i class="far fa-download"></i>
                                    <span>Descargar</span>
                                    <i class="far fa-chevron-down"></i>
                                </button>
                                <div class="download-dropdown-content" id="download-dropdown-content">
                                    <a href="#" onclick="downloadCSV()">
                                        <i class="far fa-file-csv"></i>
                                        Descargar CSV
                                    </a>
                                    <a href="#" onclick="downloadPDF()">
                                        <i class="far fa-file-pdf"></i>
                                        Descargar PDF
                                    </a>
                                    <a href="#" onclick="downloadExcel()">
                                        <i class="far fa-file-excel"></i>
                                        Descargar Excel
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Información de la encuesta -->
                    <div class="survey-info">
                        <div class="survey-details">
                            <div class="detail-item">
                                <i class="far fa-users"></i>
                                <span>Enviado a <strong>150 colaboradores</strong></span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-calendar"></i>
                                <span>Inicio <strong>15 octubre 2024</strong></span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-calendar"></i>
                                <span>Hasta <strong>15 noviembre 2024</strong></span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-globe"></i>
                                <span>Respuestas: <strong>Pública</strong></span>
                            </div>
                        </div>
                    </div>

                    <!-- Métricas -->
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-title-section">
                                <div class="metric-icon">
                                    <i class="far fa-users"></i>
                                </div>
                                <h3 class="metric-title">Total de casos canalizados</h3>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">5</div>
                                <div class="metric-unit-text">Casos</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title-section">
                                <div class="metric-icon">
                                    <i class="far fa-chart-bar"></i>
                                </div>
                                <h3 class="metric-title">Total de casos en riesgo alto</h3>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">8</div>
                                <div class="metric-unit-text">Casos</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title-section">
                                <div class="metric-icon">
                                    <i class="far fa-check-circle"></i>
                                </div>
                                <h3 class="metric-title">93% % de participación</h3>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">140 / 150</div>
                                <div class="metric-unit-text">Colaboradores</div>
                            </div>
                        </div>
                    </div>

                    <!-- NUEVOS TABS CON ESTILO ORIGINAL -->
                    <div class="tabs-container" style="margin-top: 24px;">
                        <div class="tabs-header">
                            <button class="tab-button active" data-new-tab="overview">
                                <i class="far fa-chart-bar"></i>
                                <span>Vista General</span>
                            </button>
                            <button class="tab-button" data-new-tab="dimensions">
                                <i class="far fa-layer-group"></i>
                                <span>Dimensiones</span>
                            </button>
                            <button class="tab-button" data-new-tab="individual">
                                <i class="far fa-user"></i>
                                <span>Individual</span>
                            </button>
                            <button class="tab-button" data-new-tab="heatmap">
                                <i class="far fa-th"></i>
                                <span>Heatmap</span>
                            </button>
                        </div>
                        
                        <!-- Tab Content -->
                        <div class="tab-panel active" id="new-overview-panel">
                            <div class="panel-content">
                                <div class="table-header">
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <h2 style="font-size: 24px; font-weight: 600; color: #1f2937; margin: 0;">Análisis general</h2>
                                        <span style="font-size: 14px; color: #6b7280;">5 categorías</span>
                                    </div>
                                    <div class="table-controls">
                                        <button class="filters-button" id="table-filters-btn" title="Filtros">
                                            <i class="far fa-filter"></i>
                                            <span class="filter-badge" id="filter-badge" style="display: none;">0</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Filters Side Panel - ELIMINADO -->
                                
                                <!-- Tabla Principal de Resultados -->
                                <div class="results-table-container">
                                <table class="results-table">
                                    <thead>
                                        <tr>
                                            <th>Categoría</th>
                                            <th>Dominio</th>
                                            <th>Dimensión</th>
                                            <th>Total Usuarios en Riesgo</th>
                                            <th>% Colaboradores Afectados</th>
                                            <th>Nivel de Riesgo</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                                <!-- Categoría 1: Ambiente de trabajo -->
                                                <tr class="category-summary">
                                                    <td class="category-cell" data-number="1">Ambiente de trabajo</td>
                                                    <td class="category-domain-info">-</td>
                                                    <td class="category-dimension-info">-</td>
                                            <td class="risk-count">12</td>
                                            <td class="percentage">8.0%</td>
                                                    <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                                
                                                <!-- Dominio: Condiciones físicas -->
                                                <tr class="category-detail">
                                                    <td></td>
                                            <td>Condiciones en el ambiente de trabajo</td>
                                            <td>Condiciones físicas, seguridad y comodidad</td>
                                            <td class="risk-count">12</td>
                                            <td class="percentage">8.0%</td>
                                                    <td>
                                                        <div class="response-with-dot">
                                                            <div class="response-dot bajo"></div>
                                                            <span>Bajo</span>
                                                        </div>
                                                    </td>
                                        </tr>
                                        
                                                <!-- Dominio: Condiciones de seguridad -->
                                                <tr class="category-detail">
                                                    <td></td>
                                                    <td>Condiciones en el ambiente de trabajo</td>
                                                    <td>Condiciones de seguridad</td>
                                                    <td class="risk-count">8</td>
                                                    <td class="percentage">5.3%</td>
                                                    <td>
                                                        <div class="response-with-dot">
                                                            <div class="response-dot bajo"></div>
                                                            <span>Bajo</span>
                                                </div>
                                            </td>
                                                </tr>
                                                
                                                <!-- Categoría 2: Factores propios de la actividad -->
                                                <tr class="category-summary">
                                                    <td class="category-cell" data-number="2">Factores propios de la actividad</td>
                                                    <td class="category-domain-info">-</td>
                                                    <td class="category-dimension-info">-</td>
                                                    <td class="risk-count">43</td>
                                                    <td class="percentage">28.7%</td>
                                                    <td><span class="risk-badge medio">Medio</span></td>
                                                </tr>
                                                
                                                <!-- Dominio: Exigencias cuantitativas -->
                                                <tr class="category-detail">
                                                    <td></td>
                                                    <td>Carga de trabajo</td>
                                                    <td>Exigencias cuantitativas, mentales y emocionales</td>
                                            <td class="risk-count">43</td>
                                            <td class="percentage">28.7%</td>
                                            <td>
                                                    <span class="risk-badge medio">Medio</span>
                                            </td>
                                        </tr>
                                                
                                                <!-- Dominio: Exigencias mentales -->
                                                <tr class="category-detail">
                                                    <td></td>
                                            <td>Carga de trabajo</td>
                                                    <td>Exigencias mentales</td>
                                                    <td class="risk-count">25</td>
                                                    <td class="percentage">16.7%</td>
                                                    <td>
                                                <span class="risk-badge medio">Medio</span>
                                            </td>
                                        </tr>
                                        
                                                <!-- Dominio: Exigencias emocionales -->
                                                <tr class="category-detail">
                                                    <td></td>
                                                    <td>Carga de trabajo</td>
                                                    <td>Exigencias emocionales</td>
                                            <td class="risk-count">22</td>
                                            <td class="percentage">14.7%</td>
                                            <td>
                                                    <span class="risk-badge medio">Medio</span>
                                            </td>
                                        </tr>
                                                
                                                <!-- Categoría 3: Violencia laboral -->
                                                <tr class="category-summary">
                                                    <td class="category-cell" data-number="3">Violencia laboral</td>
                                                    <td class="category-domain-info">-</td>
                                                    <td class="category-dimension-info">-</td>
                                                    <td class="risk-count">32</td>
                                                    <td class="percentage">21.3%</td>
                                                    <td><span class="risk-badge alto">Alto</span></td>
                                        </tr>
                                        
                                                <!-- Dominio: Violencia laboral -->
                                                <tr class="category-detail">
                                                    <td></td>
                                                    <td>Violencia laboral</td>
                                                    <td>Violencia laboral</td>
                                                    <td class="risk-count">32</td>
                                                    <td class="percentage">21.3%</td>
                                                    <td>
                                                <span class="risk-badge alto">Alto</span>
                                            </td>
                                        </tr>
                                                
                                                <!-- Categoría 4: Organización del tiempo de trabajo -->
                                                <tr class="category-summary">
                                                    <td class="category-cell" data-number="4">Organización del tiempo de trabajo</td>
                                                    <td class="category-domain-info">-</td>
                                                    <td class="category-dimension-info">-</td>
                                            <td class="risk-count">18</td>
                                            <td class="percentage">12.0%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                                
                                                <!-- Dominio: Jornada de trabajo -->
                                                <tr class="category-detail">
                                                    <td></td>
                                                    <td>Jornada de trabajo</td>
                                                    <td>Duración, distribución y pausas</td>
                                                    <td class="risk-count">18</td>
                                                    <td class="percentage">12.0%</td>
                                                    <td>
                                                        <div class="response-with-dot">
                                                            <div class="response-dot bajo"></div>
                                                            <span>Bajo</span>
                                                </div>
                                            </td>
                                        </tr>
                                        
                                                <!-- Categoría 5: Liderazgo y relaciones en el trabajo -->
                                                <tr class="category-summary">
                                                    <td class="category-cell" data-number="5">Liderazgo y relaciones en el trabajo</td>
                                                    <td class="category-domain-info">-</td>
                                                    <td class="category-dimension-info">-</td>
                                                    <td class="risk-count">28</td>
                                                    <td class="percentage">18.7%</td>
                                                    <td><span class="risk-badge medio">Medio</span></td>
                                                </tr>
                                                
                                                <!-- Dominio: Liderazgo -->
                                                <tr class="category-detail">
                                                    <td></td>
                                                    <td>Liderazgo</td>
                                                    <td>Estilo de liderazgo, comunicación, apoyo</td>
                                                    <td class="risk-count">15</td>
                                                    <td class="percentage">10.0%</td>
                                                    <td>
                                                <span class="risk-badge medio">Medio</span>
                                            </td>
                                        </tr>
                                                
                                                <!-- Dominio: Relaciones en el trabajo -->
                                                <tr class="category-detail">
                                                    <td></td>
                                                    <td>Relaciones en el trabajo</td>
                                                    <td>Comunicación, colaboración, confianza, respeto</td>
                                                    <td class="risk-count">13</td>
                                                    <td class="percentage">8.7%</td>
                                                    <td>
                                                <span class="risk-badge medio">Medio</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-panel" id="new-dimensions-panel">
                            <div class="panel-content">
                                <!-- Segment Control -->
                                <div class="segment-control-container" style="margin-bottom: 24px;">
                                    <div class="segment-control" style="display: flex; background: var(--ubits-bg-2); border-radius: 8px; padding: 4px; width: fit-content;">
                                        <button class="segment-option active" data-segment="dimensions" style="padding: 8px 16px; border: none; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                            Dimensiones
                                        </button>
                                        <button class="segment-option" data-segment="individual" style="padding: 8px 16px; border: none; background: transparent; color: var(--ubits-fg-1-medium); border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease;">
                                            Participantes
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Sección Dimensiones -->
                                <div class="segment-content" id="dimensions-content">
                                <div class="table-header">
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <h2 style="font-size: 24px; font-weight: 600; color: #1f2937; margin: 0;">Análisis por dimensión general</h2>
                                        <span style="font-size: 14px; color: #6b7280;">20 dimensiones</span>
                                    </div>
                                    <div class="table-controls">
                                        <!-- Controles de búsqueda -->
                                        <div style="position: relative;">
                                            <!-- Botón de búsqueda (icono) -->
                                            <button id="dimensions-table-search-btn" style="background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 6px; padding: 8px; cursor: pointer; color: #6b7280; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px;" title="Buscar dimensiones y dominios">
                                                <i class="far fa-search"></i>
                                            </button>
                                            
                                            <!-- Input de búsqueda (oculto por defecto) -->
                                            <div id="dimensions-table-search-container" style="position: absolute; top: 0; right: 0; display: none; background: white; border: 1px solid #d1d5db; border-radius: 6px; z-index: 1000;">
                                                <div style="display: flex; align-items: center; gap: 8px; padding: 8px;">
                                                    <input type="text" id="dimensions-table-search" placeholder="Buscar dimensiones y dominios..." style="padding: 8px 12px; border: none; outline: none; font-size: 14px; width: 250px; background: transparent;" />
                                                    <button id="dimensions-close-table-search" style="background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 4px; padding: 6px; cursor: pointer; color: #6b7280; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; width: 32px; height: 32px;" title="Limpiar búsqueda">
                                                        <i class="far fa-times"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <button class="filters-button" id="dimensions-table-filters-btn" title="Filtros">
                                            <i class="far fa-filter"></i>
                                            <span class="filter-badge" id="dimensions-table-filter-badge" style="display: none;">0</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <table class="results-table">
                                    <thead>
                                        <tr>
                                            <th>Dimensión</th>
                                            <th>Dominio</th>
                                            <th>Total Usuarios en Riesgo</th>
                                            <th>% Colaboradores Afectados</th>
                                            <th>Nivel de Riesgo</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Dimensión 1: Condiciones físicas -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Condiciones físicas</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Condiciones en el ambiente de trabajo</td>
                                            <td class="risk-count">12</td>
                                            <td class="percentage">8.0%</td>
                                            <td>
                                                <span class="risk-badge bajo">Bajo</span>
                                            </td>
                                        </tr>
                                        
                                        <!-- Dimensión 2: Condiciones de seguridad -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Condiciones de seguridad</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Condiciones en el ambiente de trabajo</td>
                                            <td class="risk-count">8</td>
                                            <td class="percentage">5.3%</td>
                                            <td>
                                                <span class="risk-badge bajo">Bajo</span>
                                            </td>
                                        </tr>
                                        
                                        <!-- Dimensión 3: Exigencias cuantitativas -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Exigencias cuantitativas</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Carga de trabajo</td>
                                            <td class="risk-count">18</td>
                                            <td class="percentage">12.0%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 4: Exigencias mentales -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Exigencias mentales</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Carga de trabajo</td>
                                            <td class="risk-count">25</td>
                                            <td class="percentage">16.7%</td>
                                            <td><span class="risk-badge medio">Medio</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 5: Exigencias emocionales -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Exigencias emocionales</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Carga de trabajo</td>
                                            <td class="risk-count">22</td>
                                            <td class="percentage">14.7%</td>
                                            <td><span class="risk-badge medio">Medio</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 6: Falta de control sobre el trabajo -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Falta de control sobre el trabajo</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Falta de control sobre el trabajo</td>
                                            <td class="risk-count">15</td>
                                            <td class="percentage">10.0%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 7: Falta de claridad de rol -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Falta de claridad de rol</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Falta de control sobre el trabajo</td>
                                            <td class="risk-count">10</td>
                                            <td class="percentage">6.7%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 8: Falta de autonomía -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Falta de autonomía</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Falta de control sobre el trabajo</td>
                                            <td class="risk-count">13</td>
                                            <td class="percentage">8.7%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 9: Falta de reconocimiento -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Falta de reconocimiento</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Falta de control sobre el trabajo</td>
                                            <td class="risk-count">20</td>
                                            <td class="percentage">13.3%</td>
                                            <td><span class="risk-badge medio">Medio</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 10: Jornada de trabajo -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Jornada de trabajo</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Jornada de trabajo</td>
                                            <td class="risk-count">22</td>
                                            <td class="percentage">14.7%</td>
                                            <td><span class="risk-badge medio">Medio</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 11: Distribución de la jornada -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Distribución de la jornada</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Jornada de trabajo</td>
                                            <td class="risk-count">16</td>
                                            <td class="percentage">10.7%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 12: Pausas -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Pausas</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Jornada de trabajo</td>
                                            <td class="risk-count">14</td>
                                            <td class="percentage">9.3%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 13: Liderazgo -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Liderazgo</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Liderazgo y Relaciones interpersonales</td>
                                            <td class="risk-count">18</td>
                                            <td class="percentage">12.0%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 14: Comunicación -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Comunicación</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Liderazgo y Relaciones interpersonales</td>
                                            <td class="risk-count">12</td>
                                            <td class="percentage">8.0%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 15: Apoyo social -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Apoyo social</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Liderazgo y Relaciones interpersonales</td>
                                            <td class="risk-count">8</td>
                                            <td class="percentage">5.3%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 16: Relaciones interpersonales -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Relaciones interpersonales</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Liderazgo y Relaciones interpersonales</td>
                                            <td class="risk-count">8</td>
                                            <td class="percentage">5.3%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 17: Violencia laboral -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Violencia laboral</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Violencia laboral</td>
                                            <td class="risk-count">32</td>
                                            <td class="percentage">21.3%</td>
                                            <td><span class="risk-badge alto">Alto</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 18: Equidad -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Equidad</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Entorno organizacional</td>
                                            <td class="risk-count">19</td>
                                            <td class="percentage">12.7%</td>
                                            <td><span class="risk-badge medio">Medio</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 19: Respeto -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Respeto</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Entorno organizacional</td>
                                            <td class="risk-count">15</td>
                                            <td class="percentage">10.0%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                        
                                        <!-- Dimensión 20: Seguridad laboral -->
                                        <tr class="dimension-row">
                                            <td class="dimension-cell">
                                                <div class="dimension-header-row">
                                                    <span>Seguridad laboral</span>
                                                </div>
                                            </td>
                                            <td class="dimension-domain-info">Entorno organizacional</td>
                                            <td class="risk-count">11</td>
                                            <td class="percentage">7.3%</td>
                                            <td><span class="risk-badge bajo">Bajo</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <!-- Panel de Filtros para Dimensiones -->
                                <div id="dimensions-table-filters-side-panel" class="filters-panel">
                                    <div class="filters-header">
                                        <h3>Filtros</h3>
                                        <button class="close-filters-btn" id="dimensions-close-filters-btn">
                                            <i class="far fa-times"></i>
                                        </button>
                                    </div>
                                    <div class="filters-content">
                                        <!-- Filtros Básicos -->
                                        <div class="filter-group">
                                            <label class="filter-label">Nivel de Riesgo</label>
                                            <select class="filter-select" id="risk-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="bajo">Bajo</option>
                                                <option value="medio">Medio</option>
                                                <option value="alto">Alto</option>
                                                <option value="muy-alto">Muy Alto</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">Dominio</label>
                                            <select class="filter-select" id="domain-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="condiciones">Condiciones en el ambiente de trabajo</option>
                                                <option value="carga">Carga de trabajo</option>
                                                <option value="control">Falta de control sobre el trabajo</option>
                                                <option value="jornada">Jornada de trabajo</option>
                                                <option value="liderazgo">Liderazgo</option>
                                                <option value="relaciones">Relaciones en el trabajo</option>
                                                <option value="violencia">Violencia laboral</option>
                                            </select>
                                        </div>
                                        
                                        <!-- Filtros Demográficos -->
                                        <div class="filter-group">
                                            <label class="filter-label">Área</label>
                                            <select class="filter-select" id="area-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="ventas">Ventas</option>
                                                <option value="desarrollo">Desarrollo</option>
                                                <option value="rrhh">Recursos Humanos</option>
                                                <option value="proyectos">Proyectos</option>
                                                <option value="marketing">Marketing</option>
                                                <option value="finanzas">Finanzas</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">Cargo</label>
                                            <select class="filter-select" id="position-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="gerente">Gerente</option>
                                                <option value="desarrollador">Desarrollador</option>
                                                <option value="analista">Analista</option>
                                                <option value="coordinador">Coordinador</option>
                                                <option value="director">Director</option>
                                                <option value="supervisor">Supervisor</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">Sexo</label>
                                            <select class="filter-select" id="gender-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="masculino">Masculino</option>
                                                <option value="femenino">Femenino</option>
                                                <option value="otro">Otro</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">Estado Civil</label>
                                            <select class="filter-select" id="marital-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="soltero">Soltero</option>
                                                <option value="casado">Casado</option>
                                                <option value="divorciado">Divorciado</option>
                                                <option value="viudo">Viudo</option>
                                                <option value="union-libre">Unión Libre</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">Edad</label>
                                            <select class="filter-select" id="age-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="18-25">18-25 años</option>
                                                <option value="26-35">26-35 años</option>
                                                <option value="36-45">36-45 años</option>
                                                <option value="46-55">46-55 años</option>
                                                <option value="56-65">56-65 años</option>
                                                <option value="65+">65+ años</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">País</label>
                                            <select class="filter-select" id="country-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="colombia">Colombia</option>
                                                <option value="mexico">México</option>
                                                <option value="argentina">Argentina</option>
                                                <option value="chile">Chile</option>
                                                <option value="peru">Perú</option>
                                                <option value="ecuador">Ecuador</option>
                                                <option value="venezuela">Venezuela</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">Ciudad</label>
                                            <select class="filter-select" id="city-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="bogota">Bogotá</option>
                                                <option value="medellin">Medellín</option>
                                                <option value="cali">Cali</option>
                                                <option value="barranquilla">Barranquilla</option>
                                                <option value="cartagena">Cartagena</option>
                                                <option value="mexico-df">Ciudad de México</option>
                                                <option value="buenos-aires">Buenos Aires</option>
                                            </select>
                                        </div>
                                        
                                        <div class="filter-group">
                                            <label class="filter-label">Líder</label>
                                            <select class="filter-select" id="leader-filter-dimensions">
                                                <option value="todos">Todos</option>
                                                <option value="maria-gonzalez">María González</option>
                                                <option value="carlos-rodriguez">Carlos Rodríguez</option>
                                                <option value="ana-lopez">Ana López</option>
                                                <option value="jose-martinez">José Martínez</option>
                                                <option value="laura-garcia">Laura García</option>
                                                <option value="pedro-hernandez">Pedro Hernández</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="filters-actions">
                                        <button class="ubits-button ubits-button--primary ubits-button--md" id="apply-filters-dimensions" style="flex: 1;">
                                            <i class="far fa-check"></i>
                                            <span>Aplicar</span>
                                        </button>
                                        <button class="ubits-button ubits-button--secondary ubits-button--md" id="clear-filters-dimensions" style="flex: 1;">
                                            <i class="far fa-times"></i>
                                            <span>Limpiar</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Backdrop para filtros -->
                                <div id="dimensions-filters-backdrop" class="filters-backdrop"></div>
                                
                                </div> <!-- Cierre de dimensions-content -->
                                
                                
                                <!-- Sección Individual -->
                                <div class="segment-content" id="individual-content" style="display: none;">
                                    <!-- Título de la sección -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <h2 style="font-size: 24px; font-weight: 600; color: #1f2937; margin: 0;">Análisis de dimensiones por participante</h2>
                                            <span style="font-size: 14px; color: #6b7280;">15 participantes</span>
                                        </div>
                                    </div>
                                    
                                    <div class="panel-container">
                                        <!-- Panel Izquierdo - Lista de Participantes -->
                                        <div class="participants-panel">
                                            <div class="panel-header">
                                                <h3>Participantes</h3>
                                                <div class="search-filters-container">
                                                    <div class="simple-search-container" style="flex: 1;">
                                                        <i class="far fa-search simple-search-icon"></i>
                                                        <input type="text" id="individual-participant-search" placeholder="Buscar participante..." class="simple-search-input">
                                                    </div>
                                                    <button class="filters-button" id="individual-filters-btn" title="Filtros">
                                                        <i class="far fa-filter"></i>
                                                        <span class="filter-badge" id="individual-filter-badge" style="display: none;">0</span>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="participants-list" id="individual-participants-list">
                                                <!-- Lista de participantes se generará dinámicamente -->
                                            </div>
                                        </div>

                                        <!-- Panel Derecho - Detalles del Participante -->
                                        <div class="participant-details-panel">
                                            <div class="panel-header">
                                                <h3>Detalles del Participante</h3>
                                            </div>
                                            <div class="participant-details-content" id="individual-participant-details">
                                                <div class="no-selection-message">
                                                    <i class="far fa-user"></i>
                                                    <p>Selecciona un participante para ver sus detalles</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-panel" id="new-individual-panel">
                            <div class="panel-content">
                                
                                <!-- Tabla de resultados individuales -->
                                <div style="padding: 24px 0;">
                                    <!-- Título de la sección -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <h2 style="font-size: 24px; font-weight: 600; color: #1f2937; margin: 0;">Respuestas individuales</h2>
                                            <span style="font-size: 14px; color: #6b7280;">15 usuarios</span>
                                        </div>
                                        <!-- Controles de búsqueda y filtros -->
                                        <div style="display: flex; gap: 8px; align-items: center;">
                                            <!-- Botón de búsqueda (icono) -->
                                            <div style="position: relative;">
                                                <button id="individual-search-btn" style="background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 6px; padding: 8px; cursor: pointer; color: #6b7280; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px;" title="Buscar participantes">
                                                    <i class="far fa-search"></i>
                                                </button>
                                                
                                                <!-- Input de búsqueda (oculto por defecto) -->
                                                <div id="individual-search-container" style="position: absolute; top: 0; right: 0; display: none; background: white; border: 1px solid #d1d5db; border-radius: 6px; z-index: 1000;">
                                                    <div style="display: flex; align-items: center; gap: 8px; padding: 8px;">
                                                        <input type="text" id="individual-search" placeholder="Buscar participantes..." style="padding: 8px 12px; border: none; outline: none; font-size: 14px; width: 250px; background: transparent;" />
                                                        <button id="clear-individual-search" style="background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 4px; padding: 6px; cursor: pointer; color: #6b7280; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; width: 32px; height: 32px;" title="Limpiar búsqueda">
                                                            <i class="far fa-times"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Botón de filtros -->
                                            <button class="filters-button" id="main-individual-filters-btn" title="Filtros">
                                                <i class="far fa-filter"></i>
                                                <span class="filter-badge" id="main-individual-filter-badge" style="display: none;">0</span>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div style="background: white; border-bottom: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                                        
                                        <!-- Tabla con scroll horizontal y vertical -->
                                        <div style="overflow-x: auto; overflow-y: auto; max-width: 100%; max-height: 600px;">
                                            <table style="width: 100%; border-collapse: collapse; min-width: 12000px;">
                                                <thead style="background: #f8f9fa; position: sticky; top: 0; z-index: 10;">
                                                    <tr>
                                                        <!-- Columna fija del participante -->
                                                        <th style="position: sticky; left: 0; background: #f8f9fa; border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: left; font-weight: 600; color: #374151; min-width: 200px; z-index: 11;">Participante</th>
                                                        <!-- Columnas de métricas principales -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 120px; background: #f8f9fa;">Nivel de Riesgo</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 100px; background: #f8f9fa;">Porcentaje</th>
                                                        
                                                        <!-- CATEGORÍA I. AMBIENTE DE TRABAJO -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu lugar de trabajo tiene buena iluminación, temperatura y ventilación?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Cuentas con las herramientas y equipos necesarios para realizar bien tus tareas?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu lugar de trabajo es seguro y tiene condiciones adecuadas para evitar accidentes?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Te sientes cómodo y tranquilo en el espacio donde trabajas?</th>
                                                        
                                                        <!-- CATEGORÍA II. FACTORES PROPIOS DE LA ACTIVIDAD -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu trabajo requiere que trabajes muy rápido o bajo presión constante?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes que atender varios asuntos o tareas al mismo tiempo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu trabajo demanda un alto nivel de concentración o esfuerzo mental?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Debes tomar decisiones importantes que generan presión o preocupación?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que tu trabajo te exige mucho esfuerzo emocional?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu trabajo requiere manejar situaciones difíciles con otras personas (clientes, usuarios o compañeros)?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes claridad sobre lo que se espera de ti y las metas que debes cumplir?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes suficiente autonomía para decidir cómo hacer tu trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Recibes reconocimiento o agradecimiento cuando haces bien tu trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que tu trabajo tiene sentido o utilidad para otras personas?</th>
                                                        
                                                        <!-- CATEGORÍA III. ORGANIZACIÓN DEL TIEMPO DE TRABAJO -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu jornada de trabajo te permite tener tiempo para ti o tu familia?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Puedes tomar descansos suficientes durante tu jornada laboral?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Con qué frecuencia tienes que quedarte más tiempo del establecido para cumplir tus tareas?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu horario de trabajo te permite conciliar tus responsabilidades personales y familiares?</th>
                                                        
                                                        <!-- CATEGORÍA IV. LIDERAZGO Y RELACIONES EN EL TRABAJO -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu jefe inmediato te escucha y te apoya cuando tienes dificultades?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu jefe te trata con respeto y equidad?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu jefe reconoce tu esfuerzo y te agradece por tu trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu jefe comunica claramente los objetivos del área o del proyecto?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu jefe te orienta o te da retroalimentación para mejorar tu desempeño?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿En tu equipo de trabajo hay buena comunicación entre compañeros?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que puedes confiar en las personas con las que trabajas?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Puedes contar con tus compañeros cuando necesitas ayuda laboral o emocional?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que en tu área hay un ambiente de colaboración y apoyo mutuo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿En tu lugar de trabajo se fomenta el respeto entre todos?</th>
                                                        
                                                        <!-- CATEGORÍA V. VIOLENCIA LABORAL -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Has sentido que alguien te ha tratado mal o te ha hecho sentir incómodo en el trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Has sido objeto de burlas, apodos o comentarios ofensivos?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Has sentido que te excluyen o te ignoran de manera intencional en el trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Has recibido amenazas o comentarios intimidantes en el trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Has sentido incomodidad por insinuaciones o comentarios de tipo sexual?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que te tratan de forma injusta por tu edad, sexo, apariencia o forma de pensar?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que tus opiniones o aportes son desvalorizados o ignorados?</th>
                                                        
                                                        <!-- CATEGORÍA VI. ENTORNO ORGANIZACIONAL -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Recibes oportunidades de crecimiento o capacitación para mejorar tu trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que tu esfuerzo y desempeño son valorados por la empresa?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes retroalimentación sobre los resultados de tu trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Te sientes motivado por las posibilidades de desarrollo que te ofrece tu puesto?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Te sientes orgulloso de trabajar en esta empresa?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que tus valores personales se alinean con los de la organización?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Recomendarías a otras personas trabajar aquí?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que tus ideas o sugerencias son tomadas en cuenta?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes estabilidad en tu empleo o temes perderlo sin razón?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que las decisiones de ascenso o promoción son justas y transparentes?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que la carga de trabajo está distribuida equitativamente?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Consideras que en la empresa se respetan las normas y políticas laborales?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que puedes expresar tus desacuerdos sin temor a represalias?</th>
                                                        
                                                        <!-- CATEGORÍA VII. FACTORES EXTRAORGANIZACIONALES -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu familia te apoya en tus responsabilidades laborales?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes suficiente apoyo económico para cubrir tus necesidades básicas?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Cuentas con una red de apoyo social fuera del trabajo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu situación económica te permite tomar decisiones laborales sin presión?</th>
                                                        
                                                        <!-- CATEGORÍA VIII. CARACTERÍSTICAS DEL TRABAJO -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu trabajo te ofrece variedad en las tareas que realizas?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Sientes que tu trabajo tiene un propósito claro y significativo?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Recibes retroalimentación regular sobre tu desempeño?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu trabajo te permite desarrollar nuevas habilidades?</th>
                                                        
                                                        <!-- CATEGORÍA IX. CONDICIONES DE TRABAJO -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿El nivel de ruido en tu lugar de trabajo es adecuado?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes suficiente espacio para realizar tus tareas cómodamente?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Las relaciones con tus compañeros son positivas y constructivas?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Te sientes respetado por tus superiores?</th>
                                                        
                                                        <!-- CATEGORÍA X. DESARROLLO PROFESIONAL -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes oportunidades de capacitación y desarrollo profesional?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Existen posibilidades reales de promoción en tu área?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu trabajo te permite aplicar y desarrollar tus conocimientos?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Recibes reconocimiento por tus logros y contribuciones?</th>
                                                        
                                                        <!-- CATEGORÍA XI. BALANCE TRABAJO-VIDA -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu trabajo te permite mantener un equilibrio entre vida personal y laboral?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Puedes tomar vacaciones cuando las necesitas?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tu horario de trabajo es flexible cuando lo requieres?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes tiempo suficiente para actividades personales y familiares?</th>
                                                        
                                                        <!-- CATEGORÍA XII. COMUNICACIÓN ORGANIZACIONAL -->
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿La información importante de la empresa se comunica de manera clara y oportuna?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Tienes la oportunidad de participar en decisiones que te afectan?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Los canales de comunicación en la empresa son efectivos?</th>
                                                        <th style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151; min-width: 150px; background: #f8f9fa; font-size: 11px;">¿Te sientes informado sobre los cambios y decisiones de la organización?</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Participante 1 -->
                                                    <tr style="background: white;">
                                                        <td style="position: sticky; left: 0; background: white; border-bottom: 1px solid #e5e7eb; padding: 12px; font-weight: 600; color: #374151; z-index: 1;">
                                                            <div style="display: flex; align-items: center; gap: 12px;">
                                                                <div class="participant-avatar" style="background: #667eea;">
                                                                    MG
                                            </div>
                                                                <div class="participant-info-content">
                                                                    <div class="participant-name">María González</div>
                                                                    <div class="participant-role">Gerente de Ventas</div>
                                            </div>
                                        </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <span class="risk-badge bajo">Bajo</span>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151;">85%</td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                        </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                    </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    
                                                    <!-- Participante 2 -->
                                                    <tr style="background: #f8f9fa;">
                                                        <td style="position: sticky; left: 0; background: #f8f9fa; border-bottom: 1px solid #e5e7eb; padding: 12px; font-weight: 600; color: #374151; z-index: 1;">
                                                            <div style="display: flex; align-items: center; gap: 12px;">
                                                                <div class="participant-avatar" style="background: #f093fb;">
                                                                    CR
                                            </div>
                                                                <div class="participant-info-content">
                                                                    <div class="participant-name">Carlos Rodríguez</div>
                                                                    <div class="participant-role">Desarrollador Senior</div>
                                            </div>
                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <span class="risk-badge medio">Medio</span>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151;">65%</td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                                        </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                    </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                                </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                        </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                    </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot casi-siempre"></div>
                                                                <span>Casi siempre</span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    
                                                    <!-- Participante 3 -->
                                                    <tr style="background: white;">
                                                        <td style="position: sticky; left: 0; background: white; border-bottom: 1px solid #e5e7eb; padding: 12px; font-weight: 600; color: #374151; z-index: 1;">
                                                            <div style="display: flex; align-items: center; gap: 12px;">
                                                                <div class="participant-avatar" style="background: #4facfe;">
                                                                    AL
                </div>
                                                                <div class="participant-info-content">
                                                                    <div class="participant-name">Ana López</div>
                                                                    <div class="participant-role">Analista de Recursos Humanos</div>
            </div>
        </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <span class="risk-badge alto">Alto</span>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151;">45%</td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot algunas-veces"></div>
                                                                <span>Algunas veces</span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    
                                                    <!-- Participante 4 -->
                                                    <tr style="background: #f8f9fa;">
                                                        <td style="position: sticky; left: 0; background: #f8f9fa; border-bottom: 1px solid #e5e7eb; padding: 12px; font-weight: 600; color: #374151; z-index: 1;">
                                                            <div style="display: flex; align-items: center; gap: 12px;">
                                                                <div class="participant-avatar" style="background: #fa709a;">
                                                                    JM
                                                                </div>
                                                                <div class="participant-info-content">
                                                                    <div class="participant-name">José Martínez</div>
                                                                    <div class="participant-role">Coordinador de Proyectos</div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <span class="risk-badge bajo">Bajo</span>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151;">78%</td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                        <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                                                            <div class="response-with-dot">
                                                                <div class="response-dot siempre"></div>
                                                                <span>Siempre</span>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <!-- Panel de Filtros para Individual -->
                                        <div id="individual-filters-side-panel" class="filters-panel">
                                            <div class="filters-header">
                                                <h3>Filtros</h3>
                                                <button class="close-filters-btn" id="individual-close-filters-btn">
                                                    <i class="far fa-times"></i>
                                                </button>
                                            </div>
                                            <div class="filters-content">
                                                <!-- Filtros Básicos -->
                                                <div class="filter-group">
                                                    <label class="filter-label">Nivel de Riesgo</label>
                                                    <select class="filter-select" id="individual-risk-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="bajo">Bajo</option>
                                                        <option value="medio">Medio</option>
                                                        <option value="alto">Alto</option>
                                                        <option value="muy-alto">Muy Alto</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Filtros Demográficos -->
                                                <div class="filter-group">
                                                    <label class="filter-label">Área</label>
                                                    <select class="filter-select" id="individual-area-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="Tecnología">Tecnología</option>
                                                        <option value="Recursos Humanos">Recursos Humanos</option>
                                                        <option value="Ventas">Ventas</option>
                                                        <option value="Marketing">Marketing</option>
                                                        <option value="Finanzas">Finanzas</option>
                                                        <option value="Operaciones">Operaciones</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="filter-group">
                                                    <label class="filter-label">Cargo</label>
                                                    <select class="filter-select" id="individual-position-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="Gerente">Gerente</option>
                                                        <option value="Desarrollador">Desarrollador</option>
                                                        <option value="Analista">Analista</option>
                                                        <option value="Contador">Contador</option>
                                                        <option value="Asistente">Asistente</option>
                                                        <option value="Director">Director</option>
                                                        <option value="Diseñador">Diseñador</option>
                                                        <option value="Coordinador">Coordinador</option>
                                                        <option value="Especialista">Especialista</option>
                                                        <option value="Supervisor">Supervisor</option>
                                                        <option value="Técnico">Técnico</option>
                                                        <option value="Psicólogo">Psicólogo</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="filter-group">
                                                    <label class="filter-label">Sexo</label>
                                                    <select class="filter-select" id="individual-gender-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="Masculino">Masculino</option>
                                                        <option value="Femenino">Femenino</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="filter-group">
                                                    <label class="filter-label">Estado Civil</label>
                                                    <select class="filter-select" id="individual-marital-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="Soltero">Soltero</option>
                                                        <option value="Casado">Casado</option>
                                                        <option value="Divorciado">Divorciado</option>
                                                        <option value="Viudo">Viudo</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="filter-group">
                                                    <label class="filter-label">Edad</label>
                                                    <select class="filter-select" id="individual-age-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="18-25">18-25 años</option>
                                                        <option value="26-35">26-35 años</option>
                                                        <option value="36-45">36-45 años</option>
                                                        <option value="46-55">46-55 años</option>
                                                        <option value="56-65">56-65 años</option>
                                                        <option value="65+">65+ años</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="filter-group">
                                                    <label class="filter-label">País</label>
                                                    <select class="filter-select" id="individual-country-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="Colombia">Colombia</option>
                                                        <option value="México">México</option>
                                                        <option value="Argentina">Argentina</option>
                                                        <option value="Chile">Chile</option>
                                                        <option value="Perú">Perú</option>
                                                        <option value="España">España</option>
                                                        <option value="Estados Unidos">Estados Unidos</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="filter-group">
                                                    <label class="filter-label">Ciudad</label>
                                                    <select class="filter-select" id="individual-city-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="Bogotá">Bogotá</option>
                                                        <option value="Medellín">Medellín</option>
                                                        <option value="Cali">Cali</option>
                                                        <option value="Barranquilla">Barranquilla</option>
                                                        <option value="Cartagena">Cartagena</option>
                                                        <option value="Ciudad de México">Ciudad de México</option>
                                                        <option value="Buenos Aires">Buenos Aires</option>
                                                        <option value="Santiago">Santiago</option>
                                                        <option value="Lima">Lima</option>
                                                        <option value="Madrid">Madrid</option>
                                                        <option value="Nueva York">Nueva York</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="filter-group">
                                                    <label class="filter-label">Líder</label>
                                                    <select class="filter-select" id="individual-leader-select">
                                                        <option value="todos">Todos</option>
                                                        <option value="Ana García">Ana García</option>
                                                        <option value="Carlos López">Carlos López</option>
                                                        <option value="María Rodríguez">María Rodríguez</option>
                                                        <option value="Juan Pérez">Juan Pérez</option>
                                                        <option value="Laura Martínez">Laura Martínez</option>
                                                        <option value="Pedro González">Pedro González</option>
                                                        <option value="Sofia Hernández">Sofia Hernández</option>
                                                        <option value="Diego Torres">Diego Torres</option>
                                                        <option value="Carmen Silva">Carmen Silva</option>
                                                        <option value="Roberto Díaz">Roberto Díaz</option>
                                                    </select>
                                                </div>
                                                
                                                <!-- Botones de Acción -->
                                                <div class="filters-actions">
                                                    <button class="ubits-button ubits-button--primary ubits-button--md" id="individual-apply-filters-btn" style="flex: 1;">
                                                        <i class="far fa-check"></i>
                                                        <span>Aplicar</span>
                                                    </button>
                                                    <button class="ubits-button ubits-button--secondary ubits-button--md" id="individual-clear-filters-btn" style="flex: 1;">
                                                        <i class="far fa-times"></i>
                                                        <span>Limpiar</span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Backdrop para cerrar filtros -->
                                        <div id="individual-filters-backdrop" class="filters-backdrop"></div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tab Heatmap -->
                        <div class="tab-panel" id="new-heatmap-panel">
                            <div class="panel-content">
                                <!-- Título de la sección -->
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <h2 style="font-size: 24px; font-weight: 600; color: #1f2937; margin: 0;">Heatmap NOM-035</h2>
                                        <span style="font-size: 14px; color: #6b7280;">15 participantes × 72 preguntas</span>
                                    </div>
                                </div>
                                
                                <!-- Contenedor del Heatmap -->
                                <div style="background: white; border-radius: 8px; padding: 24px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                                    <!-- Controles del Heatmap -->
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 16px;">
                                        <!-- Filtros -->
                                        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                            <select id="heatmap-dimension-filter" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; font-size: 14px;">
                                                <option value="">Todas las dimensiones</option>
                                                <option value="ambiente">Ambiente de trabajo</option>
                                                <option value="factores">Factores de riesgo</option>
                                                <option value="organizacion">Organización del tiempo</option>
                                                <option value="liderazgo">Liderazgo</option>
                                            </select>
                                            
                                            <select id="heatmap-area-filter" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; font-size: 14px;">
                                                <option value="">Todas las áreas</option>
                                                <option value="Ventas">Ventas</option>
                                                <option value="Marketing">Marketing</option>
                                                <option value="RRHH">RRHH</option>
                                                <option value="Tecnología">Tecnología</option>
                                                <option value="Finanzas">Finanzas</option>
                                            </select>
                                            
                                            <select id="heatmap-gender-filter" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; font-size: 14px;">
                                                <option value="">Todos los géneros</option>
                                                <option value="Femenino">Femenino</option>
                                                <option value="Masculino">Masculino</option>
                                                <option value="Otro">Otro</option>
                                            </select>
                                            
                                            <select id="heatmap-risk-filter" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; font-size: 14px;">
                                                <option value="">Todos los niveles</option>
                                                <option value="bajo">Bajo riesgo</option>
                                                <option value="medio">Medio riesgo</option>
                                                <option value="alto">Alto riesgo</option>
                                                <option value="muy-alto">Muy alto riesgo</option>
                                            </select>
                                        </div>
                                        
                                        <!-- Botón de aplicar filtros -->
                                        <button id="apply-heatmap-filters" style="padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer;">
                                            <i class="far fa-filter"></i> Aplicar Filtros
                                        </button>
                                    </div>
                                    
                                    <!-- Leyenda del Heatmap -->
                                    <div style="display: flex; justify-content: center; gap: 24px; margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <div class="heatmap-cell bajo" style="width: 16px; height: 16px;"></div>
                                            <span style="font-size: 14px; color: #374151; font-weight: 500;">Bajo Riesgo (1-3)</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <div class="heatmap-cell medio" style="width: 16px; height: 16px;"></div>
                                            <span style="font-size: 14px; color: #374151; font-weight: 500;">Medio Riesgo (4-5)</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <div class="heatmap-cell alto" style="width: 16px; height: 16px;"></div>
                                            <span style="font-size: 14px; color: #374151; font-weight: 500;">Alto Riesgo (6-7)</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <div class="heatmap-cell muy-alto" style="width: 16px; height: 16px;"></div>
                                            <span style="font-size: 14px; color: #374151; font-weight: 500;">Muy Alto Riesgo (8)</span>
                                        </div>
                                    </div>
                                    
                                    <div id="heatmap-container" style="overflow-x: auto; overflow-y: auto; max-height: 600px;">
                                        <!-- El heatmap se generará dinámicamente con JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script src="components/sidebar.js"></script>
    <script src="components/tab-bar.js"></script>
    <script src="components/floating-menu.js"></script>
    <script src="components/profile-menu.js"></script>
    <script src="components/button.js"></script>
    <script src="components/input.js"></script>

    <script>

        // Funciones para el dropdown de descarga
        function toggleDownloadDropdown() {
            const dropdown = document.getElementById('download-dropdown-content');
            dropdown.classList.toggle('show');
        }

        function downloadCSV() {
            alert('Descargando CSV de resultados de entorno laboral...');
            closeDownloadDropdown();
        }

        function downloadPDF() {
            alert('Descargando PDF de resultados de entorno laboral...');
            closeDownloadDropdown();
        }

        function downloadExcel() {
            alert('Descargando Excel de resultados de entorno laboral...');
            closeDownloadDropdown();
        }

        function closeDownloadDropdown() {
            const dropdown = document.getElementById('download-dropdown-content');
            dropdown.classList.remove('show');
        }

        // Cerrar dropdown al hacer clic fuera
        document.addEventListener('click', function(event) {
            const dropdown = document.querySelector('.download-dropdown');
            if (dropdown && !dropdown.contains(event.target)) {
                closeDownloadDropdown();
            }
        });

        // Funciones para los tabs - Versión simplificada y robusta
        function initializeTabs() {
            console.log('🔍 toggleCategoryRow antes de initializeTabs:', typeof toggleCategoryRow);
            console.log('Inicializando tabs...');
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanels = document.querySelectorAll('.tab-panel');
            
            console.log('Botones de tab encontrados:', tabButtons.length);
            console.log('Paneles de tab encontrados:', tabPanels.length);

            // Función para cambiar de tab
            function switchTab(targetTab) {
                console.log('Cambiando a tab:', targetTab);
                
                // Remover clase active de todos los botones
                tabButtons.forEach(btn => {
                    btn.classList.remove('active');
                    console.log('Removiendo active de botón:', btn.getAttribute('data-tab'));
                });
                
                // Remover clase active de todos los paneles
                tabPanels.forEach(panel => {
                    panel.classList.remove('active');
                    console.log('Removiendo active de panel:', panel.id);
                });
                
                // Activar el botón correspondiente
                const targetButton = document.querySelector(`[data-tab="${targetTab}"]`);
                if (targetButton) {
                    targetButton.classList.add('active');
                    console.log('Activando botón:', targetTab);
                }
                
                // Activar el panel correspondiente
                const targetPanel = document.getElementById(`${targetTab}-panel`);
                if (targetPanel) {
                    targetPanel.classList.add('active');
                    console.log('Activando panel:', targetPanel.id);
                    
                    // Cargar contenido específico según el tab
                    if (targetTab === 'dimension') {
                        console.log('🚀 ===== CAMBIO A TAB DIMENSIONES =====');
                        console.log('📊 Cargando dimensiones...');
                        console.log('🔍 Panel dimension-panel antes de cargar:', document.getElementById('dimension-panel') ? 'EXISTE' : 'NO EXISTE');
                        setTimeout(() => {
                            console.log('⏰ Ejecutando loadDimensionResults después de timeout...');
                            loadDimensionResults();
                        }, 100);
                    } else if (targetTab === 'dimensiones2') {
                        console.log('Cargando dimensiones 2...');
                        setTimeout(() => loadDimensiones2Results(), 100);
                    }
                } else {
                    console.error('No se encontró el panel:', `${targetTab}-panel`);
                }
            }

            // Agregar event listeners a todos los botones
            tabButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetTab = button.getAttribute('data-tab');
                    console.log('Click en tab:', targetTab);
                    switchTab(targetTab);
                });
            });
            
            // Verificar estado inicial
            const activeButton = document.querySelector('.tab-button.active');
            const activePanel = document.querySelector('.tab-panel.active');
            console.log('Botón activo inicial:', activeButton ? activeButton.getAttribute('data-tab') : 'ninguno');
            console.log('Panel activo inicial:', activePanel ? activePanel.id : 'ninguno');
            console.log('🔍 toggleCategoryRow al final de initializeTabs:', typeof toggleCategoryRow);
        }

        // Funciones para búsqueda y filtros de la tabla
        function initializeTableFilters() {
            console.log('🔧 ===== INICIANDO FILTROS DE TABLA =====');
            const searchBtn = document.getElementById('table-search-btn');
            const searchContainer = document.getElementById('table-search-container');
            const searchInput = document.getElementById('table-search');
            const closeSearch = document.getElementById('close-table-search');
            const filtersBtn = document.getElementById('table-filters-btn');
            const filtersSidePanel = document.getElementById('table-filters-side-panel');
            const filtersOverlay = document.getElementById('table-filters-overlay');
            const closeFiltersBtn = document.getElementById('close-table-filters-btn');
            const applyFiltersBtn = document.getElementById('apply-table-filters-btn');
            const clearFiltersBtn = document.getElementById('clear-table-filters-btn');
            
            console.log('🔧 Elementos encontrados:', {
                searchBtn: !!searchBtn,
                searchContainer: !!searchContainer,
                searchInput: !!searchInput,
                closeSearch: !!closeSearch,
                filtersBtn: !!filtersBtn,
                filtersSidePanel: !!filtersSidePanel,
                filtersOverlay: !!filtersOverlay,
                closeFiltersBtn: !!closeFiltersBtn,
                applyFiltersBtn: !!applyFiltersBtn,
                clearFiltersBtn: !!clearFiltersBtn
            });

            // BÚSQUEDA MANEJADA POR initializeNewTableControls() - ELIMINADA PARA EVITAR DUPLICACIÓN

            // Abrir panel de filtros
            if (filtersBtn && filtersSidePanel && filtersOverlay) {
            filtersBtn.addEventListener('click', () => {
                filtersSidePanel.classList.add('show');
                filtersOverlay.classList.add('show');
            });
            }

            // Cerrar panel de filtros
            if (closeFiltersBtn) {
            closeFiltersBtn.addEventListener('click', closeTableFiltersPanel);
            }
            if (filtersOverlay) {
            filtersOverlay.addEventListener('click', closeTableFiltersPanel);
            }

            // Aplicar filtros
            if (applyFiltersBtn) {
            applyFiltersBtn.addEventListener('click', () => {
                    if (typeof applyTableFilters === 'function') {
                applyTableFilters();
                    }
                    if (typeof closeTableFiltersPanel === 'function') {
                closeTableFiltersPanel();
                    }
            });
            }

            // Limpiar filtros
            if (clearFiltersBtn) {
            clearFiltersBtn.addEventListener('click', clearTableFilters);
            }

            // Búsqueda en tiempo real
            if (searchInput) {
            searchInput.addEventListener('input', applyTableFilters);
            }

            // Configurar selects personalizados
            if (typeof setupTableCustomSelects === 'function') {
            setupTableCustomSelects();
            }
            
            console.log('✅ ===== FILTROS DE TABLA INICIALIZADOS =====');
        }

        // Funciones para filtros de dimensiones - Nueva implementación
        function initializeDimensionsFilters() {
            console.log('🔧 Inicializando filtros de dimensiones...');
            
            const filtersBtn = document.getElementById('dimensions-table-filters-btn');
            const filtersPanel = document.getElementById('dimensions-table-filters-side-panel');
            const filtersBackdrop = document.getElementById('dimensions-filters-backdrop');
            const closeFiltersBtn = document.getElementById('dimensions-close-filters-btn');
            const applyFiltersBtn = document.getElementById('apply-filters-dimensions');
            const clearFiltersBtn = document.getElementById('clear-filters-dimensions');
            
            console.log('🔧 Elementos encontrados:', {
                filtersBtn: !!filtersBtn,
                filtersPanel: !!filtersPanel,
                filtersBackdrop: !!filtersBackdrop,
                closeFiltersBtn: !!closeFiltersBtn,
                applyFiltersBtn: !!applyFiltersBtn,
                clearFiltersBtn: !!clearFiltersBtn
            });

            // Abrir panel de filtros
            if (filtersBtn && filtersPanel && filtersBackdrop) {
                filtersBtn.addEventListener('click', openDimensionsFiltersPanel);
            }

            // Cerrar panel de filtros
            if (closeFiltersBtn) {
                closeFiltersBtn.addEventListener('click', closeDimensionsFiltersPanel);
            }
            if (filtersBackdrop) {
                filtersBackdrop.addEventListener('click', closeDimensionsFiltersPanel);
            }

            // Aplicar filtros
            if (applyFiltersBtn) {
                console.log('🔧 Configurando event listener para botón aplicar filtros');
                applyFiltersBtn.addEventListener('click', () => {
                    console.log('🔧 ===== CLICK EN BOTÓN APLICAR FILTROS =====');
                    applyDimensionsFilters();
                    closeDimensionsFiltersPanel();
                });
            } else {
                console.log('❌ ERROR: No se encontró el botón apply-filters-dimensions');
            }

            // Limpiar filtros
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', clearDimensionsFilters);
            }
            
            console.log('✅ Filtros de dimensiones inicializados');
        }

        // Funciones auxiliares para filtros de dimensiones
        function openDimensionsFiltersPanel() {
            console.log('🔧 Abriendo panel de filtros de dimensiones...');
            const panel = document.getElementById('dimensions-table-filters-side-panel');
            const backdrop = document.getElementById('dimensions-filters-backdrop');
            console.log('🔧 Elementos encontrados:', { panel: !!panel, backdrop: !!backdrop });
            if (panel && backdrop) {
                panel.classList.add('show');
                backdrop.classList.add('show');
                console.log('✅ Panel de filtros abierto');
            } else {
                console.log('❌ No se pudieron encontrar los elementos del panel');
            }
        }

        function closeDimensionsFiltersPanel() {
            const panel = document.getElementById('dimensions-table-filters-side-panel');
            const backdrop = document.getElementById('dimensions-filters-backdrop');
            if (panel && backdrop) {
                panel.classList.remove('show');
                backdrop.classList.remove('show');
            }
        }

        function applyDimensionsFilters() {
            console.log('🔍 ===== INICIANDO APLICACIÓN DE FILTROS DIMENSIONES =====');
            console.log('🔍 Aplicando filtros de dimensiones...');
            
            // Obtener valores de los filtros
            const riskFilterElement = document.getElementById('risk-filter-dimensions');
            console.log('🔍 Elemento risk-filter encontrado:', !!riskFilterElement);
            
            if (!riskFilterElement) {
                console.log('❌ ERROR: No se encontró el elemento risk-filter-dimensions');
                return;
            }
            
            const riskFilter = riskFilterElement.value;
            
            // Verificar todos los elementos de filtros
            const domainFilterElement = document.getElementById('domain-filter-dimensions');
            const areaFilterElement = document.getElementById('area-filter-dimensions');
            const positionFilterElement = document.getElementById('position-filter-dimensions');
            const genderFilterElement = document.getElementById('gender-filter-dimensions');
            const maritalFilterElement = document.getElementById('marital-filter-dimensions');
            const ageFilterElement = document.getElementById('age-filter-dimensions');
            const countryFilterElement = document.getElementById('country-filter-dimensions');
            const cityFilterElement = document.getElementById('city-filter-dimensions');
            const leaderFilterElement = document.getElementById('leader-filter-dimensions');
            
            console.log('🔍 Elementos de filtros encontrados:', {
                risk: !!riskFilterElement,
                domain: !!domainFilterElement,
                area: !!areaFilterElement,
                position: !!positionFilterElement,
                gender: !!genderFilterElement,
                marital: !!maritalFilterElement,
                age: !!ageFilterElement,
                country: !!countryFilterElement,
                city: !!cityFilterElement,
                leader: !!leaderFilterElement
            });
            
            const domainFilter = domainFilterElement ? domainFilterElement.value : 'todos';
            const areaFilter = areaFilterElement ? areaFilterElement.value : 'todos';
            const positionFilter = positionFilterElement ? positionFilterElement.value : 'todos';
            const genderFilter = genderFilterElement ? genderFilterElement.value : 'todos';
            const maritalFilter = maritalFilterElement ? maritalFilterElement.value : 'todos';
            const ageFilter = ageFilterElement ? ageFilterElement.value : 'todos';
            const countryFilter = countryFilterElement ? countryFilterElement.value : 'todos';
            const cityFilter = cityFilterElement ? cityFilterElement.value : 'todos';
            const leaderFilter = leaderFilterElement ? leaderFilterElement.value : 'todos';
            
            console.log('🔍 Filtros seleccionados:', {
                risk: riskFilter,
                domain: domainFilter,
                area: areaFilter,
                position: positionFilter,
                gender: genderFilter,
                marital: maritalFilter,
                age: ageFilter,
                country: countryFilter,
                city: cityFilter,
                leader: leaderFilter
            });
            
            // Aplicar filtros básicos (ocultar/mostrar filas)
            const tableRows = document.querySelectorAll('#dimensions-content .results-table tbody tr');
            console.log('🔍 Filas encontradas:', tableRows.length);
            
            tableRows.forEach((row, index) => {
                const riskBadge = row.querySelector('.risk-badge');
                const domainText = row.querySelector('.dimension-domain-info')?.textContent.toLowerCase() || '';
                
                console.log(`🔍 Fila ${index + 1}:`, {
                    hasRiskBadge: !!riskBadge,
                    riskText: riskBadge ? riskBadge.textContent : 'No encontrado',
                    domainText: domainText
                });
                
                let shouldShow = true;
                
                // Filtro de nivel de riesgo
                if (riskFilter !== 'todos' && riskBadge) {
                    const riskLevel = riskBadge.textContent.toLowerCase().trim();
                    console.log(`🔍 Comparando riesgo: "${riskLevel}" con "${riskFilter}"`);
                    if (riskLevel !== riskFilter) {
                        shouldShow = false;
                        console.log('❌ Fila oculta por filtro de riesgo');
                    } else {
                        console.log('✅ Fila pasa filtro de riesgo');
                    }
                }
                
                // Filtro de dominio
                if (domainFilter !== 'todos') {
                    const domainKeywords = {
                        'condiciones': 'condiciones',
                        'carga': 'carga',
                        'control': 'control',
                        'jornada': 'jornada',
                        'liderazgo': 'liderazgo',
                        'relaciones': 'relaciones',
                        'violencia': 'violencia'
                    };
                    
                    const keyword = domainKeywords[domainFilter];
                    console.log(`🔍 Comparando dominio: "${domainText}" con keyword "${keyword}"`);
                    if (keyword && !domainText.includes(keyword)) {
                        shouldShow = false;
                        console.log('❌ Fila oculta por filtro de dominio');
                    } else {
                        console.log('✅ Fila pasa filtro de dominio');
                    }
                }
                
                // Mostrar/ocultar fila
                row.style.display = shouldShow ? '' : 'none';
            });
            
            // Aplicar filtros demográficos (cambiar datos)
            updateDimensionsDemographicData(areaFilter, positionFilter, genderFilter, maritalFilter, ageFilter, countryFilter, cityFilter, leaderFilter);
            
            // Actualizar badge
            updateDimensionsFilterBadge();
            
            console.log('✅ ===== FILTROS DE DIMENSIONES APLICADOS COMPLETAMENTE =====');
        }

        function clearDimensionsFilters() {
            console.log('🧹 Limpiando filtros de dimensiones...');
            
            // Resetear todos los selects a "Todos"
            const selectIds = [
                'risk-filter-dimensions',
                'domain-filter-dimensions', 
                'area-filter-dimensions',
                'position-filter-dimensions',
                'gender-filter-dimensions',
                'marital-filter-dimensions',
                'age-filter-dimensions',
                'country-filter-dimensions',
                'city-filter-dimensions',
                'leader-filter-dimensions'
            ];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.value = 'todos';
                }
            });
            
            // Mostrar todas las filas
            const tableRows = document.querySelectorAll('#dimensions-content .results-table tbody tr');
            tableRows.forEach(row => {
                row.style.display = '';
            });
            
            // Restaurar datos originales
            restoreDimensionsOriginalData();
            
            // Ocultar badge
            hideDimensionsFilterBadge();
            
            console.log('✅ Filtros de dimensiones limpiados');
        }

        function updateDimensionsFilterBadge() {
            const badge = document.getElementById('dimensions-table-filter-badge');
            if (!badge) return;
            
            let activeFilters = 0;
            
            // Contar filtros activos
            const selectIds = [
                'risk-filter-dimensions',
                'domain-filter-dimensions',
                'area-filter-dimensions', 
                'position-filter-dimensions',
                'gender-filter-dimensions',
                'marital-filter-dimensions',
                'age-filter-dimensions',
                'country-filter-dimensions',
                'city-filter-dimensions',
                'leader-filter-dimensions'
            ];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select && select.value !== 'todos') {
                    activeFilters++;
                }
            });
            
            if (activeFilters > 0) {
                badge.textContent = activeFilters;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        function hideDimensionsFilterBadge() {
            const badge = document.getElementById('dimensions-table-filter-badge');
            if (badge) {
                badge.style.display = 'none';
            }
        }

        function updateDimensionsDemographicData(areaFilter, positionFilter, genderFilter, maritalFilter, ageFilter, countryFilter, cityFilter, leaderFilter) {
            console.log('📊 Actualizando datos demográficos de dimensiones...');
            
            const tableRows = document.querySelectorAll('#dimensions-content .results-table tbody tr');
            
            tableRows.forEach((row, index) => {
                const riskCountCell = row.querySelector('.risk-count');
                const percentageCell = row.querySelector('.percentage');
                
                if (riskCountCell && percentageCell) {
                    // Simular datos demográficos
                    const demographicData = getSimulatedDemographicDataForDimensions(index);
                    
                    // Verificar si coincide con los filtros
                    const matchesFilters = checkDimensionsDemographicMatch(demographicData, areaFilter, positionFilter, genderFilter, maritalFilter, ageFilter, countryFilter, cityFilter, leaderFilter);
                    
                    if (matchesFilters) {
                        // Mostrar datos normales
                        riskCountCell.textContent = demographicData.riskCount;
                        percentageCell.textContent = demographicData.percentage + '%';
                        riskCountCell.style.color = '#374151';
                        percentageCell.style.color = '#374151';
                    } else {
                        // Mostrar datos filtrados (en gris)
                        const filteredData = getFilteredDimensionsData(index);
                        riskCountCell.textContent = filteredData.riskCount;
                        percentageCell.textContent = filteredData.percentage + '%';
                        riskCountCell.style.color = '#6b7280';
                        percentageCell.style.color = '#6b7280';
                    }
                }
            });
        }

        function getSimulatedDemographicDataForDimensions(index) {
            const areas = ['ventas', 'desarrollo', 'rrhh', 'proyectos', 'marketing', 'finanzas'];
            const positions = ['gerente', 'desarrollador', 'analista', 'coordinador', 'director', 'supervisor'];
            const genders = ['masculino', 'femenino', 'otro'];
            const maritalStatuses = ['soltero', 'casado', 'divorciado', 'viudo', 'union-libre'];
            const ages = [25, 30, 35, 40, 45, 50, 55, 60];
            const countries = ['colombia', 'mexico', 'argentina', 'chile', 'peru', 'ecuador', 'venezuela'];
            const cities = ['bogota', 'medellin', 'cali', 'barranquilla', 'cartagena', 'mexico-df', 'buenos-aires'];
            const leaders = ['maria-gonzalez', 'carlos-rodriguez', 'ana-lopez', 'jose-martinez', 'laura-garcia', 'pedro-hernandez'];
            
            // Usar índice para generar datos consistentes
            const seed = index * 7 + 13;
            
            return {
                area: areas[seed % areas.length],
                position: positions[seed % positions.length],
                gender: genders[seed % genders.length],
                marital: maritalStatuses[seed % maritalStatuses.length],
                age: ages[seed % ages.length],
                country: countries[seed % countries.length],
                city: cities[seed % cities.length],
                leader: leaders[seed % leaders.length],
                riskCount: 8 + (seed % 15),
                percentage: 5 + (seed % 20)
            };
        }

        function checkDimensionsDemographicMatch(data, areaFilter, positionFilter, genderFilter, maritalFilter, ageFilter, countryFilter, cityFilter, leaderFilter) {
            if (areaFilter !== 'todos' && data.area !== areaFilter) return false;
            if (positionFilter !== 'todos' && data.position !== positionFilter) return false;
            if (genderFilter !== 'todos' && data.gender !== genderFilter) return false;
            if (maritalFilter !== 'todos' && data.marital !== maritalFilter) return false;
            if (ageFilter !== 'todos' && !matchesAgeRangeForDimensions(data.age, ageFilter)) return false;
            if (countryFilter !== 'todos' && data.country !== countryFilter) return false;
            if (cityFilter !== 'todos' && data.city !== cityFilter) return false;
            if (leaderFilter !== 'todos' && data.leader !== leaderFilter) return false;
            
            return true;
        }

        function matchesAgeRangeForDimensions(age, ageRange) {
            switch (ageRange) {
                case '18-25': return age >= 18 && age <= 25;
                case '26-35': return age >= 26 && age <= 35;
                case '36-45': return age >= 36 && age <= 45;
                case '46-55': return age >= 46 && age <= 55;
                case '56-65': return age >= 56 && age <= 65;
                case '65+': return age > 65;
                default: return true;
            }
        }

        function getFilteredDimensionsData(index) {
            // Datos filtrados (menores)
            const seed = index * 3 + 5;
            return {
                riskCount: 2 + (seed % 8),
                percentage: 1 + (seed % 10)
            };
        }

        function restoreDimensionsOriginalData() {
            const tableRows = document.querySelectorAll('#dimensions-content .results-table tbody tr');
            
            tableRows.forEach((row, index) => {
                const riskCountCell = row.querySelector('.risk-count');
                const percentageCell = row.querySelector('.percentage');
                
                if (riskCountCell && percentageCell) {
                    // Restaurar datos originales
                    const originalData = getSimulatedDemographicDataForDimensions(index);
                    riskCountCell.textContent = originalData.riskCount;
                    percentageCell.textContent = originalData.percentage + '%';
                    riskCountCell.style.color = '#374151';
                    percentageCell.style.color = '#374151';
                }
            });
        }







        function closeTableFiltersPanel() {
            document.getElementById('table-filters-side-panel').classList.remove('show');
            document.getElementById('table-filters-overlay').classList.remove('show');
        }

        // NUEVA FUNCIÓN DE FILTROS SIMPLE Y FUNCIONAL
        function applyTableFilters() {
            console.log('🔧 ===== APLICANDO NUEVOS FILTROS =====');
            
            // Obtener filtros seleccionados
            const riskFilter = getSelectedFilterValue('new-risk-select');
            const categoryFilter = getSelectedFilterValue('new-category-select');
            const domainFilter = getSelectedFilterValue('new-domain-select');
            const dimensionFilter = getSelectedFilterValue('new-dimension-select');
            
            console.log('🔧 Filtros seleccionados:', {
                risk: riskFilter,
                category: categoryFilter,
                domain: domainFilter,
                dimension: dimensionFilter
            });
            
            // Obtener todas las filas de categoría
            const categoryRows = document.querySelectorAll('.results-table tbody tr.category-summary');
            console.log('🔧 Filas de categoría encontradas:', categoryRows.length);
            
            let visibleCount = 0;
            
            categoryRows.forEach((row, index) => {
                const categoryText = row.querySelector('.category-cell')?.textContent.toLowerCase() || '';
                const domainText = row.querySelector('.category-domain-info')?.textContent.toLowerCase() || '';
                const dimensionText = row.querySelector('.category-dimension-info')?.textContent.toLowerCase() || '';
                const riskBadge = row.querySelector('.risk-badge');
                const riskLevel = riskBadge ? riskBadge.textContent.toLowerCase().trim() : '';
                
                // Aplicar filtros
                let shouldShow = true;
                
                if (riskFilter && riskFilter !== 'todos') {
                    shouldShow = shouldShow && riskLevel === riskFilter.toLowerCase();
                }
                
                if (categoryFilter && categoryFilter !== 'todos') {
                    shouldShow = shouldShow && categoryText.includes(categoryFilter.toLowerCase());
                }
                
                if (domainFilter && domainFilter !== 'todos') {
                    shouldShow = shouldShow && domainText.includes(domainFilter.toLowerCase());
                }
                
                if (dimensionFilter && dimensionFilter !== 'todos') {
                    shouldShow = shouldShow && dimensionText.includes(dimensionFilter.toLowerCase());
                }
                
                console.log(`🔧 Fila ${index} (${categoryText}):`, shouldShow);
                
                if (shouldShow) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            console.log('🔧 Resultado:', `${visibleCount} de ${categoryRows.length} filas visibles`);
        }
        
        // Función auxiliar para obtener valor seleccionado de un filtro
        function getSelectedFilterValue(selectId) {
            const select = document.getElementById(selectId);
            if (!select) return null;
            
            const checkedBox = select.querySelector('input[type="checkbox"]:checked');
            if (!checkedBox) return null;
            
            const value = checkedBox.value || checkedBox.id.replace(selectId.replace('-select', '-'), '');
            return value === 'todos' ? 'todos' : value;
        }




        // Función simplificada para toggle de filas de categoría
        function toggleCategoryRow(row) {
            console.log('🔧 toggleCategoryRow llamado');
            
            const domainCell = row.querySelector('.category-domain-info');
            const dimensionCell = row.querySelector('.category-dimension-info');
            const chevron = row.querySelector('.accordion-icon');
            
            // Encontrar filas de detalle
            const allRows = Array.from(document.querySelectorAll('.results-table tbody tr'));
            const currentIndex = allRows.indexOf(row);
            const detailRows = [];
            
            for (let i = currentIndex + 1; i < allRows.length; i++) {
                const nextRow = allRows[i];
                if (nextRow.classList.contains('category-detail')) {
                    detailRows.push(nextRow);
                } else if (nextRow.classList.contains('category-summary')) {
                    break;
                }
            }
            
            // Toggle de filas de detalle
            const isOpen = detailRows.length > 0 && detailRows[0].style.display !== 'none';
            
            detailRows.forEach(detailRow => {
                detailRow.style.display = isOpen ? 'none' : '';
            });
            
            // Toggle de información en encabezado
            if (isOpen) {
                // Cerrar: mostrar info
                if (domainCell) domainCell.style.color = '#374151';
                if (dimensionCell) dimensionCell.style.color = '#6b7280';
                if (chevron) chevron.style.transform = 'rotate(0deg)';
                row.classList.remove('open');
            } else {
                // Abrir: ocultar info
                if (domainCell) domainCell.style.color = 'transparent';
                if (dimensionCell) dimensionCell.style.color = 'transparent';
                if (chevron) chevron.style.transform = 'rotate(180deg)';
                row.classList.add('open');
            }
        }
        
        console.log('✅ toggleCategoryRow definida correctamente:', typeof toggleCategoryRow);

        // Función para cargar dimensiones en la tabla de dimensiones
        function loadDimensionResults() {
            console.log('🚀 ===== INICIANDO loadDimensionResults =====');
            console.log('🔍 toggleCategoryRow antes de loadDimensionResults:', typeof toggleCategoryRow);
            console.log('📊 Cargando contenido del tab de dimensiones...');
            
            // Verificar que el panel de dimensiones existe
            const dimensionPanel = document.getElementById('dimension-panel');
            if (!dimensionPanel) {
                console.error('❌ ERROR: No se encontró el panel dimension-panel');
                return;
            }
            console.log('✅ Panel dimension-panel encontrado:', dimensionPanel);
            
            // Verificar que el contenido del panel existe
            const panelContent = dimensionPanel.querySelector('.panel-content');
            if (!panelContent) {
                console.error('❌ ERROR: No se encontró .panel-content dentro de dimension-panel');
                return;
            }
            console.log('✅ Panel content encontrado:', panelContent);
            
            // Verificar que el contenido simple existe
            const simpleContent = panelContent.querySelector('div[style*="padding: 40px"]');
            if (!simpleContent) {
                console.error('❌ ERROR: No se encontró el contenido simple del tab de dimensiones');
                return;
            }
            console.log('✅ Contenido simple encontrado:', simpleContent);
            
            // Verificar que el título existe
            const title = simpleContent.querySelector('h2');
            if (!title) {
                console.error('❌ ERROR: No se encontró el título h2');
                return;
            }
            console.log('✅ Título encontrado:', title.textContent);
            
            // Verificar que el estado existe
            const statusDiv = simpleContent.querySelector('div[style*="margin-top: 24px"]');
            if (!statusDiv) {
                console.error('❌ ERROR: No se encontró el div de estado');
                return;
            }
            console.log('✅ Div de estado encontrado:', statusDiv);
            
            console.log('🎉 ===== loadDimensionResults COMPLETADO EXITOSAMENTE =====');
            console.log('✅ El tab de dimensiones está funcionando correctamente con contenido simple');
        }

        // Función para obtener el texto del nivel de riesgo
        function getRiskLevelText(riskLevel) {
            const riskLevels = {
                'nulo': 'Nulo',
                'bajo': 'Bajo',
                'medio': 'Medio',
                'alto': 'Alto',
                'muy-alto': 'Muy Alto'
            };
            return riskLevels[riskLevel] || 'Nulo';
        }

        // Función simple para cargar dimensiones en el nuevo tab
        function loadDimensiones2Results() {
            console.log('Cargando dimensiones 2...');
            const tbody = document.getElementById('dimensiones2-results-tbody');
            
            if (!tbody) {
                console.error('No se encontró dimensiones2-results-tbody');
                return;
            }
            
            const dimensionsData = [
                {
                    dimension: "Condiciones físicas, seguridad y comodidad",
                    domain: "Condiciones en el ambiente de trabajo",
                    riskCount: 12,
                    percentage: 8.0,
                    riskLevel: "bajo"
                },
                {
                    dimension: "Exigencias cuantitativas, mentales y emocionales",
                    domain: "Carga de trabajo",
                    riskCount: 43,
                    percentage: 28.7,
                    riskLevel: "medio"
                },
                {
                    dimension: "Duración, distribución y pausas",
                    domain: "Jornada de trabajo",
                    riskCount: 22,
                    percentage: 14.7,
                    riskLevel: "medio"
                },
                {
                    dimension: "Estilo de liderazgo, comunicación, apoyo y relaciones",
                    domain: "Liderazgo y Relaciones interpersonales",
                    riskCount: 26,
                    percentage: 17.3,
                    riskLevel: "bajo"
                },
                {
                    dimension: "Acoso, hostigamiento y violencia",
                    domain: "Violencia laboral",
                    riskCount: 5,
                    percentage: 3.3,
                    riskLevel: "nulo"
                },
                {
                    dimension: "Cultura organizacional y políticas",
                    domain: "Entorno organizacional",
                    riskCount: 77,
                    percentage: 51.3,
                    riskLevel: "alto"
                }
            ];
            
            let html = '';
            dimensionsData.forEach((dim, index) => {
                html += `
                    <tr>
                        <td>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="background: #6b7280; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600;">
                                    ${index + 1}
                                </div>
                                <span style="font-weight: 600;">${dim.dimension}</span>
                            </div>
                        </td>
                        <td style="color: #6b7280; font-weight: 500;">${dim.domain}</td>
                        <td style="text-align: center; font-weight: 600;">${dim.riskCount}</td>
                        <td style="text-align: center; font-weight: 600;">${dim.percentage}%</td>
                        <td style="text-align: center;">
                            <span class="risk-badge ${dim.riskLevel}" style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; text-transform: uppercase;">
                                ${getRiskLevelText(dim.riskLevel)}
                            </span>
                        </td>
                    </tr>
                `;
            });
            
            // tbody.innerHTML = html; // Comentado porque tbody no está definido
            console.log('Dimensiones 2 cargadas exitosamente');
            console.log('🔍 toggleCategoryRow después de loadDimensionResults:', typeof toggleCategoryRow);
        }

        // Función para actualizar números de dominio basados en filtros demográficos
        function updateDomainNumbers(domainItem, areaFilters, positionFilters, genderFilters, maritalFilters, ageFilters, countryFilters, cityFilters) {
            const riskCountCell = domainItem.querySelector('.risk-count');
            const percentageCell = domainItem.querySelector('.percentage');
            
            if (riskCountCell && percentageCell) {
                // Guardar valores originales si no están guardados
                if (!riskCountCell.dataset.originalValue) {
                    riskCountCell.dataset.originalValue = riskCountCell.textContent;
                }
                if (!percentageCell.dataset.originalValue) {
                    percentageCell.dataset.originalValue = percentageCell.textContent;
                }
                
                // Simular datos demográficos para este dominio
                const domainName = domainItem.querySelector('.domain-name')?.textContent || '';
                const simulatedArea = getSimulatedArea('', domainName);
                const simulatedPosition = getSimulatedPosition('', domainName);
                const simulatedGender = getSimulatedGender('', domainName);
                const simulatedMaritalStatus = getSimulatedMaritalStatus('', domainName);
                const simulatedAge = getSimulatedAge('', domainName);
                const simulatedCountry = getSimulatedCountry('', domainName);
                const simulatedCity = getSimulatedCity('', domainName);
                
                // Verificar si coincide con los filtros demográficos
                const matchesFilters = checkDemographicFilter(areaFilters, simulatedArea) &&
                    checkDemographicFilter(positionFilters, simulatedPosition) &&
                    checkDemographicFilter(genderFilters, simulatedGender) &&
                    checkDemographicFilter(maritalFilters, simulatedMaritalStatus) &&
                    checkDemographicFilter(ageFilters, simulatedAge) &&
                    checkDemographicFilter(countryFilters, simulatedCountry) &&
                    checkDemographicFilter(cityFilters, simulatedCity);
                
                if (matchesFilters) {
                    // Si coincide, mantener números originales
                    riskCountCell.textContent = riskCountCell.dataset.originalValue;
                    percentageCell.textContent = percentageCell.dataset.originalValue;
                } else {
                    // Si no coincide, reducir números (simulado)
                    const originalCount = parseInt(riskCountCell.dataset.originalValue) || 0;
                    const originalPercentage = parseFloat(percentageCell.dataset.originalValue) || 0;
                    
                    const newCount = Math.max(0, Math.floor(originalCount * 0.3)); // Reducir a 30%
                    const newPercentage = Math.max(0, Math.floor(originalPercentage * 0.3));
                    
                    riskCountCell.textContent = newCount.toString();
                    percentageCell.textContent = newPercentage + '%';
                }
            }
        }

        // Función para restaurar números originales de dominio
        function restoreDomainNumbers(domainItem) {
            const riskCountCell = domainItem.querySelector('.risk-count');
            const percentageCell = domainItem.querySelector('.percentage');
            
            if (riskCountCell && riskCountCell.dataset.originalValue) {
                riskCountCell.textContent = riskCountCell.dataset.originalValue;
            }
            if (percentageCell && percentageCell.dataset.originalValue) {
                percentageCell.textContent = percentageCell.dataset.originalValue;
            }
        }

        // Función para restaurar números originales
        function restoreOriginalNumbers(row) {
            const riskCountCell = row.querySelector('.risk-count');
            const percentageCell = row.querySelector('.percentage');
            
            if (riskCountCell && percentageCell) {
                if (riskCountCell.dataset.originalValue) {
                    riskCountCell.textContent = riskCountCell.dataset.originalValue;
                } else {
                    // Si no hay valor original guardado, usar el valor actual como original
                    riskCountCell.dataset.originalValue = riskCountCell.textContent;
                }
            }
            if (percentageCell) {
                if (percentageCell.dataset.originalValue) {
                    percentageCell.textContent = percentageCell.dataset.originalValue;
                } else {
                    // Si no hay valor original guardado, usar el valor actual como original
                    percentageCell.dataset.originalValue = percentageCell.textContent;
                }
            }
        }

        // Funciones para simular datos demográficos basados en categoría/dominio
        function getSimulatedArea(categoryText, domainText) {
            const areas = ['Recursos Humanos', 'Ventas', 'Marketing', 'Finanzas', 'Operaciones', 'Tecnología'];
            const hash = (categoryText + domainText).length;
            return areas[hash % areas.length];
        }

        function getSimulatedPosition(categoryText, domainText) {
            const positions = ['Gerente', 'Coordinador', 'Analista', 'Asistente', 'Especialista'];
            const hash = (categoryText + domainText).length + 1;
            return positions[hash % positions.length];
        }

        function getSimulatedGender(categoryText, domainText) {
            const genders = ['Masculino', 'Femenino', 'Masculino', 'Femenino', 'Masculino']; // Más masculino para simular
            const hash = (categoryText + domainText).length + 2;
            return genders[hash % genders.length];
        }

        function getSimulatedMaritalStatus(categoryText, domainText) {
            const statuses = ['Soltero', 'Casado', 'Divorciado', 'Viudo'];
            const hash = (categoryText + domainText).length + 3;
            return statuses[hash % statuses.length];
        }

        function getSimulatedAge(categoryText, domainText) {
            const ages = ['18-25', '26-35', '36-45', '46-55', '55+'];
            const hash = (categoryText + domainText).length + 4;
            return ages[hash % ages.length];
        }

        function getSimulatedCountry(categoryText, domainText) {
            const countries = ['Colombia', 'México', 'Argentina', 'Chile', 'Perú'];
            const hash = (categoryText + domainText).length + 5;
            return countries[hash % countries.length];
        }

        function getSimulatedCity(categoryText, domainText) {
            const cities = ['Bogotá', 'Medellín', 'Cali', 'Ciudad de México', 'Buenos Aires', 'Santiago', 'Lima'];
            const hash = (categoryText + domainText).length + 6;
            return cities[hash % cities.length];
        }

        function getSimulatedLeader(categoryText, domainText) {
            const leaders = ['Juan Pérez', 'María García', 'Carlos López', 'Ana Martínez', 'Luis Rodríguez'];
            const hash = (categoryText + domainText).length + 7;
            return leaders[hash % leaders.length];
        }

        function clearTableFilters() {
            const selectIds = ['new-risk-select', 'new-category-select', 'new-department-select', 'new-position-select', 'new-gender-select', 'new-marital-status-select', 'new-age-select', 'new-country-select', 'new-city-select', 'new-domain-select', 'new-dimension-select'];
            
            selectIds.forEach(selectId => {
                const checkboxes = document.querySelectorAll(`#${selectId} input[type="checkbox"]`);
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Marcar "Todos" como seleccionado
                const todosCheckbox = document.querySelector(`#${selectId} input[type="checkbox"][id$="-todos"]`);
                if (todosCheckbox) {
                    todosCheckbox.checked = true;
                }
                
                updateTableSelectText(selectId);
            });

            document.getElementById('table-search').value = '';
            
            // Mostrar todas las filas y restaurar números originales
            const tableRows = document.querySelectorAll('.results-table tbody tr');
            tableRows.forEach(row => {
                row.style.display = '';
                restoreOriginalNumbers(row);
            });
            
            const badge = document.getElementById('table-filter-badge');
            badge.style.display = 'none';
        }

        function updateTableFilterBadge() {
            const badge = document.getElementById('new-table-filter-badge');
            let activeFilters = 0;

            const selectIds = ['new-risk-select', 'new-category-select', 'new-department-select', 'new-position-select', 'new-gender-select', 'new-marital-status-select', 'new-age-select', 'new-country-select', 'new-city-select', 'new-domain-select', 'new-dimension-select'];
            
            selectIds.forEach(selectId => {
                const selectedValues = getTableSelectedValues(selectId);
                if (selectedValues.length > 0 && !selectedValues.includes('todos')) {
                    activeFilters++;
                }
            });

            const searchTerm = document.getElementById('table-search').value;
            if (searchTerm.trim() !== '') {
                activeFilters++;
            }

            if (activeFilters > 0) {
                badge.textContent = activeFilters;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        function setupTableCustomSelects() {
            const selectIds = ['new-risk-select', 'new-category-select', 'new-department-select', 'new-position-select', 'new-gender-select', 'new-marital-status-select', 'new-age-select', 'new-country-select', 'new-city-select', 'new-domain-select', 'new-dimension-select'];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (!select) return; // Si el select no existe, continuar con el siguiente
                
                const trigger = select.querySelector('.select-trigger');
                const dropdown = select.querySelector('.select-dropdown');
                const options = select.querySelectorAll('.select-option');
                
                if (!trigger || !dropdown) return; // Si no existen los elementos necesarios, continuar

                // Toggle dropdown
                trigger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = trigger.classList.contains('active');
                    
                    // Cerrar otros selects
                    selectIds.forEach(id => {
                        if (id !== selectId) {
                            const otherSelect = document.getElementById(id);
                            if (otherSelect) {
                                const otherTrigger = otherSelect.querySelector('.select-trigger');
                                const otherDropdown = otherSelect.querySelector('.select-dropdown');
                                if (otherTrigger) otherTrigger.classList.remove('active');
                                if (otherDropdown) otherDropdown.classList.remove('show');
                            }
                        }
                    });
                    
                    trigger.classList.toggle('active');
                    dropdown.classList.toggle('show');
                });

                // Manejar clics en opciones
                options.forEach(option => {
                    option.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const checkbox = option.querySelector('input[type="checkbox"]');
                        const isTodos = option.dataset.value === 'todos';
                        
                        if (isTodos) {
                            handleTableTodosOption(selectId, checkbox);
                        } else {
                            checkbox.checked = !checkbox.checked;
                            
                            // Si se selecciona cualquier opción que no sea "Todos", desmarcar "Todos"
                            const todosCheckbox = select.querySelector('input[type="checkbox"][id$="-todos"]');
                            if (checkbox.checked && todosCheckbox.checked) {
                                todosCheckbox.checked = false;
                            }
                            
                            // Si no hay ninguna opción seleccionada, marcar "Todos"
                            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]:not([id$="-todos"])');
                            const checkedBoxes = select.querySelectorAll('input[type="checkbox"]:not([id$="-todos"]):checked');
                            if (checkedBoxes.length === 0) {
                                todosCheckbox.checked = true;
                            }
                        }
                        
                        updateTableSelectText(selectId);
                    });
                });
            });

            // Cerrar dropdowns al hacer clic fuera
            document.addEventListener('click', (event) => {
                // No cerrar si se hizo clic en el botón de regresar
                if (event.target.closest('.back-button')) {
                    return;
                }
                selectIds.forEach(selectId => {
                    const select = document.getElementById(selectId);
                    if (select) {
                        const trigger = select.querySelector('.select-trigger');
                        const dropdown = select.querySelector('.select-dropdown');
                        if (trigger) trigger.classList.remove('active');
                        if (dropdown) dropdown.classList.remove('show');
                    }
                });
            });
        }

        function handleTableTodosOption(selectId, todosCheckbox) {
            const select = document.getElementById(selectId);
            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]');
            
            if (todosCheckbox.checked) {
                // Si "Todos" está marcado, desmarcar todo
                allCheckboxes.forEach(cb => cb.checked = false);
            } else {
                // Si "Todos" no está marcado, marcar "Todos" y desmarcar el resto
                allCheckboxes.forEach(cb => cb.checked = false);
                todosCheckbox.checked = true;
            }
        }

        function updateTableSelectText(selectId) {
            const select = document.getElementById(selectId);
            const textElement = select.querySelector('.select-text');
            const selectedValues = getTableSelectedValues(selectId);
            
            if (selectedValues.length === 0 || selectedValues.includes('todos')) {
                textElement.textContent = 'Seleccionar opciones';
            } else if (selectedValues.length === 1) {
                textElement.textContent = selectedValues[0];
            } else {
                textElement.textContent = `${selectedValues.length} seleccionados`;
            }
        }

        function getTableSelectedValues(selectId) {
            const select = document.getElementById(selectId);
            if (!select) {
                console.log(`❌ Select no encontrado: ${selectId}`);
                return [];
            }
            const checkedBoxes = select.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(checkedBoxes).map(cb => {
                // Extraer el valor del ID del checkbox
                const id = cb.id;
                if (id.includes('-todos')) {
                    return 'todos';
                }
                // Remover el prefijo del select ID y el sufijo del checkbox
                const prefix = selectId.replace('-select', '-');
                return id.replace(prefix, '').replace('-todos', 'todos');
            });
        }

        // FUNCIÓN PARA TOGGLE DE CATEGORÍAS EN NUEVOS TABS
        function toggleNewCategoryRow(clickedRow) {
            console.log('🔄 ===== TOGGLE NUEVA CATEGORÍA =====');
            console.log('🔍 Fila clickeada:', clickedRow);
            
            const allRows = document.querySelectorAll('#new-overview-panel .category-summary, #new-overview-panel .category-detail');
            console.log('🔍 Total de filas encontradas:', allRows.length);
            
            // Encontrar todas las filas de detalle de esta categoría
            const detailRows = [];
            let currentRow = clickedRow.nextElementSibling;
            
            while (currentRow && currentRow.classList.contains('category-detail')) {
                detailRows.push(currentRow);
                currentRow = currentRow.nextElementSibling;
            }
            
            console.log('🔍 Filas de detalle encontradas:', detailRows.length);
            
            // Verificar si la categoría está expandida
            const isExpanded = detailRows.some(row => row.style.display !== 'none');
            console.log('🔍 Categoría expandida:', isExpanded);
            
            // Toggle de las filas de detalle
            detailRows.forEach(row => {
                if (isExpanded) {
                    row.style.display = 'none';
                    console.log('❌ Ocultando fila de detalle:', row);
                } else {
                    row.style.display = '';
                    console.log('✅ Mostrando fila de detalle:', row);
                }
            });
            
            // Cambiar el ícono del chevron
            const chevron = clickedRow.querySelector('.category-chevron');
            if (chevron) {
                if (isExpanded) {
                    chevron.className = 'far fa-chevron-down category-chevron';
                    console.log('🔄 Cambiando chevron a abajo');
                } else {
                    chevron.className = 'far fa-chevron-up category-chevron';
                    console.log('🔄 Cambiando chevron a arriba');
                }
            }
            
            console.log('🎉 ===== TOGGLE NUEVA CATEGORÍA COMPLETADO =====');
        }

        // FUNCIÓN PARA INICIALIZAR LOS NUEVOS TABS (CON ESTILO ORIGINAL)
        function initializeNewTabs() {
            console.log('🚀 ===== INICIANDO NUEVOS TABS CON ESTILO ORIGINAL =====');
            
            // Buscar botones que tengan data-new-tab (los nuevos tabs)
            const newTabButtons = document.querySelectorAll('[data-new-tab]');
            const newTabPanels = document.querySelectorAll('#new-overview-panel, #new-dimensions-panel, #new-individual-panel');
            
            console.log('🔍 Botones de nuevos tabs encontrados:', newTabButtons.length);
            console.log('🔍 Paneles de nuevos tabs encontrados:', newTabPanels.length);
            
            // Función para cambiar de tab
            function switchNewTab(targetTab) {
                console.log('🔄 Cambiando a nuevo tab:', targetTab);
                
                // Remover clase active de todos los botones nuevos
                newTabButtons.forEach(btn => {
                    btn.classList.remove('active');
                    console.log('❌ Removiendo active de botón:', btn.getAttribute('data-new-tab'));
                });
                
                // Remover clase active de todos los paneles nuevos
                newTabPanels.forEach(panel => {
                    panel.classList.remove('active');
                    console.log('❌ Removiendo active de panel:', panel.id);
                });
                
                // Activar el botón seleccionado
                const targetButton = document.querySelector(`[data-new-tab="${targetTab}"]`);
                if (targetButton) {
                    targetButton.classList.add('active');
                    console.log('✅ Activando botón:', targetTab);
                }
                
                // Activar el panel seleccionado
                const targetPanel = document.getElementById(`new-${targetTab}-panel`);
                if (targetPanel) {
                    targetPanel.classList.add('active');
                    console.log('✅ Activando panel:', targetPanel.id);
                }
                
                console.log('🎉 Cambio de nuevo tab completado:', targetTab);
            }
            
            // Agregar event listeners a los botones nuevos
            newTabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-new-tab');
                    console.log('🖱️ Click en nuevo tab:', targetTab);
                    switchNewTab(targetTab);
                });
            });
            
            // Verificar estado inicial
            const activeNewButton = document.querySelector('[data-new-tab].active');
            const activeNewPanel = document.querySelector('#new-overview-panel.active, #new-dimensions-panel.active, #new-individual-panel.active');
            console.log('🔍 Botón activo inicial (nuevos tabs):', activeNewButton ? activeNewButton.getAttribute('data-new-tab') : 'ninguno');
            console.log('🔍 Panel activo inicial (nuevos tabs):', activeNewPanel ? activeNewPanel.id : 'ninguno');
            
            console.log('✅ ===== NUEVOS TABS CON ESTILO ORIGINAL INICIALIZADOS EXITOSAMENTE =====');
            
            // Inicializar controles de la tabla en los nuevos tabs
            initializeNewTableControls();
            
            // Inicializar controles del tab Dimensiones
            initializeDimensionsTableControls();
            
            // Inicializar la nueva tabla con la primera categoría abierta
            setTimeout(() => {
                const newTableDetailRows = document.querySelectorAll('#new-overview-panel .category-detail');
                newTableDetailRows.forEach((row, index) => {
                    // Abrir solo las filas de detalle de la primera categoría
                    const isFirstCategory = index < 2; // Las primeras 2 filas de detalle pertenecen a la primera categoría
                    row.style.display = isFirstCategory ? 'table-row' : 'none';
                });
                
                // Marcar la primera categoría como activa en la nueva tabla
                const firstNewCategoryRow = document.querySelector('#new-overview-panel .category-summary');
                if (firstNewCategoryRow) {
                    firstNewCategoryRow.classList.add('active');
                    const accordionIcon = firstNewCategoryRow.querySelector('.accordion-icon');
                    if (accordionIcon) {
                        accordionIcon.style.transform = 'rotate(90deg)';
                    }
                }
            }, 100);
        }

        // Función para actualizar el texto del select
        function updateSelectText(selectId) {
            const select = document.getElementById(selectId);
            if (!select) return;
            
            const selectedValues = getSelectedValues(selectId);
            const selectText = select.querySelector('.select-text');
            
            if (selectedValues.length === 0) {
                selectText.textContent = selectText.textContent.split(':')[0] + ': Seleccionar';
            } else if (selectedValues.includes('todos')) {
                selectText.textContent = selectText.textContent.split(':')[0] + ': Todos';
            } else if (selectedValues.length === 1) {
                selectText.textContent = selectText.textContent.split(':')[0] + ': ' + selectedValues[0];
            } else {
                selectText.textContent = selectText.textContent.split(':')[0] + ': ' + selectedValues.length + ' seleccionados';
            }
        }

        // Función para obtener valores seleccionados
        function getSelectedValues(selectId) {
            const select = document.getElementById(selectId);
            if (!select) {
                console.log(`❌ Select ${selectId} no encontrado`);
                return [];
            }
            
            const checkboxes = select.querySelectorAll('input[type="checkbox"]:checked');
            const values = Array.from(checkboxes).map(cb => {
                const option = cb.closest('.select-option');
                const value = option ? option.dataset.value : cb.value;
                console.log(`🔍 Checkbox seleccionado: ${cb.value} -> ${value}`);
                return value;
            });
            
            console.log(`🔍 getSelectedValues(${selectId}):`, values);
            return values;
        }

        // Función para manejar la opción "Todos"
        function handleTodosOption(selectId, todosCheckbox) {
            const select = document.getElementById(selectId);
            if (!select) return;
            
            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]');
            
            if (todosCheckbox.checked) {
                // Si se selecciona "Todos", deseleccionar todo lo demás
                allCheckboxes.forEach(cb => {
                    if (cb !== todosCheckbox) {
                        cb.checked = false;
                    }
                });
            } else {
                // Si se deselecciona "Todos", verificar si hay otras opciones seleccionadas
                const otherSelected = Array.from(allCheckboxes).some(cb => cb !== todosCheckbox && cb.checked);
                if (!otherSelected) {
                    // Si no hay otras opciones seleccionadas, seleccionar "Todos"
                    todosCheckbox.checked = true;
                }
            }
        }

        // Configurar componente select personalizado para los nuevos filtros
        function setupNewCustomSelects() {
            console.log('🔧 ===== INICIANDO SETUP DE CUSTOM SELECTS NUEVOS =====');
            const newCustomSelects = document.querySelectorAll('#new-table-filters-side-panel .custom-select');
            console.log('🔧 Selects encontrados:', newCustomSelects.length);
            
            newCustomSelects.forEach((select, index) => {
                console.log(`🔧 Configurando select ${index + 1}:`, select.id);
                const selectTrigger = select.querySelector('.select-trigger');
                const selectDropdown = select.querySelector('.select-dropdown');
                const selectOptions = select.querySelectorAll('.select-option');
                
                console.log(`🔧 Select ${index + 1} elementos:`, {
                    trigger: !!selectTrigger,
                    dropdown: !!selectDropdown,
                    options: selectOptions.length
                });
                
                // Toggle dropdown - USAR NUEVO SISTEMA
                selectTrigger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    console.log(`🔧 Click en trigger del select ${select.id}`);
                    
                    // Cerrar otros dropdowns nuevos
                    newCustomSelects.forEach(otherSelect => {
                        if (otherSelect !== select) {
                            closeNewDropdown(otherSelect.id);
                        }
                    });
                    
                    // Crear opciones para el nuevo dropdown
                    const options = [];
                    console.log(`🔧 DIAGNÓSTICO OPCIONES ${select.id}:`);
                    console.log('  📋 SelectOptions encontrados:', selectOptions.length);
                    
                    selectOptions.forEach((option, index) => {
                        console.log(`  📋 Opción ${index + 1}:`, {
                            element: option,
                            innerHTML: option.innerHTML,
                            textContent: option.textContent,
                            tagName: option.tagName,
                            className: option.className
                        });
                        
                        // Buscar checkbox de diferentes formas
                        const checkbox = option.querySelector('input[type="checkbox"]') || 
                                       option.querySelector('input') ||
                                       option.querySelector('checkbox');
                        
                        // Buscar label de diferentes formas  
                        const label = option.querySelector('label') ||
                                    option.querySelector('span') ||
                                    option.querySelector('div');
                        
                        console.log(`  📋 Opción ${index + 1} elementos:`, {
                            checkbox: !!checkbox,
                            label: !!label,
                            checkboxValue: checkbox ? checkbox.value : 'N/A',
                            labelText: label ? label.textContent : 'N/A',
                            checkboxType: checkbox ? checkbox.type : 'N/A',
                            labelTagName: label ? label.tagName : 'N/A'
                        });
                        
                        // Mostrar todos los elementos hijos
                        const allChildren = option.querySelectorAll('*');
                        console.log(`  📋 Opción ${index + 1} todos los hijos:`, Array.from(allChildren).map(child => ({
                            tagName: child.tagName,
                            className: child.className,
                            textContent: child.textContent,
                            type: child.type || 'N/A'
                        })));
                        
                        if (checkbox && label) {
                            options.push({
                                value: checkbox.value,
                                text: label.textContent,
                                checked: checkbox.checked
                            });
                            console.log(`  ✅ Opción ${index + 1} agregada:`, {
                                value: checkbox.value,
                                text: label.textContent,
                                checked: checkbox.checked
                            });
                        } else {
                            console.log(`  ❌ Opción ${index + 1} NO agregada - elementos faltantes`);
                        }
                    });
                    
                    console.log(`🔧 OPCIONES FINALES ${select.id}:`, options);
                    
                    // Crear nuevo dropdown
                    createNewDropdown(select.id, options, (value, checked) => {
                        console.log(`🔧 Opción seleccionada: ${value} = ${checked}`);
                        
                        // Actualizar checkbox original
                        const originalCheckbox = select.querySelector(`input[value="${value}"]`);
                        console.log(`🔧 Checkbox original encontrado:`, !!originalCheckbox, originalCheckbox);
                        if (originalCheckbox) {
                            originalCheckbox.checked = checked;
                            console.log(`🔧 Checkbox actualizado: ${originalCheckbox.value} = ${originalCheckbox.checked}`);
                        } else {
                            console.log(`❌ No se encontró checkbox con value="${value}"`);
                        }
                        
                        // Manejar lógica de "Todos"
                        const todosCheckbox = select.querySelector('input[type="checkbox"][id$="-todos"]');
                        if (value === 'todos') {
                            handleTodosOption(select.id, todosCheckbox);
                        } else {
                            // Si se selecciona una opción específica, deseleccionar "Todos"
                            if (checked && todosCheckbox) {
                                todosCheckbox.checked = false;
                            }
                            
                            // Si no hay opciones seleccionadas, seleccionar "Todos"
                            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]');
                            const hasSelected = Array.from(allCheckboxes).some(cb => cb.checked);
                            if (!hasSelected && todosCheckbox) {
                                todosCheckbox.checked = true;
                            }
                        }
                        
                        updateSelectText(select.id);
                    });
                });
                
                // Manejar clicks en opciones
                selectOptions.forEach(option => {
                    const checkbox = option.querySelector('input[type="checkbox"]');
                    const todosCheckbox = select.querySelector('input[type="checkbox"][id$="-todos"]');
                    
                    option.addEventListener('click', (e) => {
                        e.stopPropagation();
                        
                        if (checkbox === todosCheckbox) {
                            handleTodosOption(select.id, todosCheckbox);
                        } else {
                            checkbox.checked = !checkbox.checked;
                            
                            // Si se selecciona una opción específica, deseleccionar "Todos"
                            if (checkbox.checked && todosCheckbox) {
                                console.log('🔧 Desmarcando "todos" porque se seleccionó opción específica');
                                todosCheckbox.checked = false;
                            }
                            
                            // Si no hay opciones seleccionadas, seleccionar "Todos"
                            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]');
                            const hasSelected = Array.from(allCheckboxes).some(cb => cb.checked);
                            if (!hasSelected && todosCheckbox) {
                                console.log('🔧 Marcando "todos" porque no hay opciones seleccionadas');
                                todosCheckbox.checked = true;
                            }
                        }
                        
                        updateSelectText(select.id);
                    });
                });
            });
            
            // Cerrar dropdowns al hacer click fuera - USAR NUEVO SISTEMA
            document.addEventListener('click', function(event) {
                // No cerrar si se hizo clic en el botón de regresar
                if (event.target.closest('.back-button')) {
                    return;
                }
                // Solo cerrar si no se hizo click en un trigger de dropdown
                if (!event.target.closest('.select-trigger')) {
                    newCustomSelects.forEach(select => {
                        closeNewDropdown(select.id);
                    });
                }
            });
        }

        // NUEVA FUNCIÓN: DROPDOWN COMPLETAMENTE NUEVO
        function createNewDropdown(selectId, options, onSelect) {
            console.log('🚀 ===== CREANDO NUEVO DROPDOWN =====');
            console.log('🔧 Select ID:', selectId);
            console.log('🔧 Options:', options);
            
            // Crear overlay
            const overlay = document.createElement('div');
            overlay.className = 'ubits-dropdown-overlay';
            overlay.id = `${selectId}-overlay`;
            
            // Crear contenedor del dropdown
            const container = document.createElement('div');
            container.className = 'ubits-dropdown-container';
            container.id = `${selectId}-container`;
            
            // Crear opciones
            options.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'ubits-dropdown-option';
                optionElement.innerHTML = `
                    <input type="checkbox" id="${option.value}" value="${option.value}">
                    <label for="${option.value}">${option.text}</label>
                `;
                
                optionElement.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const checkbox = optionElement.querySelector('input[type="checkbox"]');
                    checkbox.checked = !checkbox.checked;
                    
                    // FORZAR: Si se selecciona una opción específica, desmarcar "todos"
                    if (checkbox.checked && option.value !== 'todos') {
                        console.log('🔧 FORZANDO: Desmarcando "todos" porque se seleccionó opción específica');
                        const todosCheckbox = document.querySelector('input[id="risk-todos"]');
                        if (todosCheckbox) {
                            todosCheckbox.checked = false;
                        }
                    }
                    
                    // FORZAR: Si se selecciona "todos", desmarcar todas las demás
                    if (checkbox.checked && option.value === 'todos') {
                        console.log('🔧 FORZANDO: Desmarcando todas las opciones porque se seleccionó "todos"');
                        const allCheckboxes = document.querySelectorAll('#new-risk-select input[type="checkbox"]');
                        allCheckboxes.forEach(cb => {
                            if (cb.id !== 'risk-todos') {
                                cb.checked = false;
                            }
                        });
                    }
                    
                    onSelect(option.value, checkbox.checked);
                });
                
                container.appendChild(optionElement);
            });
            
            // Agregar al body
            document.body.appendChild(overlay);
            document.body.appendChild(container);
            
            // Posicionar el dropdown
            const selectElement = document.getElementById(selectId);
            console.log(`🔧 DIAGNÓSTICO POSICIONAMIENTO ${selectId}:`);
            console.log('  📍 SelectElement encontrado:', !!selectElement);
            
            if (selectElement) {
                const rect = selectElement.getBoundingClientRect();
                console.log('  📍 Rect del select:', {
                    top: rect.top,
                    left: rect.left,
                    bottom: rect.bottom,
                    right: rect.right,
                    width: rect.width,
                    height: rect.height
                });
                
                container.style.top = `${rect.bottom + 5}px`;
                container.style.left = `${rect.left}px`;
                container.style.width = `${rect.width}px`;
                container.classList.add('show');
                
                console.log('🔧 Dropdown posicionado:', {
                    top: container.style.top,
                    left: container.style.left,
                    width: container.style.width,
                    showClass: container.classList.contains('show')
                });
                
                // Verificar posicionamiento después de un momento
                setTimeout(() => {
                    const containerRect = container.getBoundingClientRect();
                    console.log('🔧 Dropdown posicionamiento final:', {
                        top: containerRect.top,
                        left: containerRect.left,
                        width: containerRect.width,
                        height: containerRect.height,
                        visible: containerRect.width > 0 && containerRect.height > 0
                    });
                }, 100);
            } else {
                console.log('❌ SelectElement NO encontrado para:', selectId);
            }
            
            // Cerrar al hacer click en overlay
            overlay.addEventListener('click', () => {
                closeNewDropdown(selectId);
            });
            
            return { overlay, container };
        }

        function closeNewDropdown(selectId) {
            console.log('🔧 Cerrando nuevo dropdown:', selectId);
            const overlay = document.getElementById(`${selectId}-overlay`);
            const container = document.getElementById(`${selectId}-container`);
            
            if (overlay) overlay.remove();
            if (container) container.remove();
        }

        // Función para actualizar todos los textos de los selects
        function updateAllSelectTexts() {
            const selectIds = [
                'new-risk-select',
                'new-department-select', 
                'new-position-select',
                'new-gender-select',
                'new-marital-status-select',
                'new-age-select',
                'new-country-select',
                'new-city-select',
                'new-leader-select',
                'new-category-nom035-select',
                'new-domain-select',
                'new-dimension-select'
            ];
            
            selectIds.forEach(selectId => {
                updateSelectText(selectId);
            });
        }

        // Función para aplicar filtros en la tabla general
        function applyNewFilters() {
            console.log('🔍 ===== APLICANDO FILTROS EN TABLA GENERAL =====');
            
            // Obtener valores de todos los filtros
            const riskFilters = getSelectedValues('new-risk-select');
            const departmentFilters = getSelectedValues('new-department-select');
            const positionFilters = getSelectedValues('new-position-select');
            const genderFilters = getSelectedValues('new-gender-select');
            const maritalStatusFilters = getSelectedValues('new-marital-status-select');
            const ageFilters = getSelectedValues('new-age-select');
            const countryFilters = getSelectedValues('new-country-select');
            const cityFilters = getSelectedValues('new-city-select');
            const leaderFilters = getSelectedValues('new-leader-select');
            const categoryFilters = getSelectedValues('new-category-nom035-select');
            const domainFilters = getSelectedValues('new-domain-select');
            const dimensionFilters = getSelectedValues('new-dimension-select');
            
            console.log('🔍 Filtros seleccionados:', {
                risk: riskFilters,
                department: departmentFilters,
                position: positionFilters,
                gender: genderFilters,
                maritalStatus: maritalStatusFilters,
                age: ageFilters,
                country: countryFilters,
                city: cityFilters,
                leader: leaderFilters,
                category: categoryFilters,
                domain: domainFilters,
                dimension: dimensionFilters
            });
            
            // Obtener todas las filas de la tabla
            const tableRows = document.querySelectorAll('#new-overview-panel .results-table tbody tr');
            console.log(`🔍 Total de filas encontradas en Vista General: ${tableRows.length}`);
            
            // Log de la estructura de las primeras filas
            tableRows.forEach((row, index) => {
                if (index < 3) { // Solo las primeras 3 filas
                    console.log(`🔍 Fila ${index + 1}:`, {
                        classes: row.className,
                        hasRiskBadge: !!row.querySelector('.risk-badge'),
                        hasCategoryCell: !!row.querySelector('.category-cell'),
                        hasDomainCell: !!row.querySelector('.category-domain-info'),
                        hasDimensionCell: !!row.querySelector('.category-dimension-info'),
                        textContent: row.textContent.substring(0, 100) + '...'
                    });
                }
            });
            
            let visibleCount = 0;
            
            tableRows.forEach(row => {
                let shouldShow = true;
                
                // Filtrar por nivel de riesgo
                if (riskFilters.length > 0 && !riskFilters.includes('todos')) {
                    const riskBadge = row.querySelector('.risk-badge');
                    if (riskBadge) {
                        const riskLevel = riskBadge.textContent.trim().toLowerCase();
                        const riskMapping = {
                            'nulo': 'nulo',
                            'bajo': 'bajo',
                            'medio': 'medio',
                            'alto': 'alto',
                            'muy alto': 'muy-alto'
                        };
                        const mappedRisk = riskMapping[riskLevel];
                        if (!riskFilters.includes(mappedRisk)) {
                            shouldShow = false;
                        }
                    }
                }
                
                // Filtrar por categoría NOM-035
                if (categoryFilters.length > 0 && !categoryFilters.includes('todos')) {
                    const categoryCell = row.querySelector('.category-cell span');
                    if (categoryCell) {
                        const categoryText = categoryCell.textContent.trim();
                        let categoryMatch = false;
                        
                        categoryFilters.forEach(filter => {
                            if (filter === 'ambiente' && categoryText.includes('Ambiente de trabajo')) categoryMatch = true;
                            if (filter === 'factores' && categoryText.includes('Factores propios')) categoryMatch = true;
                            if (filter === 'tiempo' && categoryText.includes('Organización del tiempo')) categoryMatch = true;
                            if (filter === 'liderazgo' && categoryText.includes('Liderazgo y relaciones')) categoryMatch = true;
                            if (filter === 'entorno' && categoryText.includes('Entorno organizacional')) categoryMatch = true;
                        });
                        
                        if (!categoryMatch) {
                            shouldShow = false;
                        }
                    }
                }
                
                // Filtrar por dominio
                if (domainFilters.length > 0 && !domainFilters.includes('todos')) {
                    const domainCell = row.querySelector('.category-domain-info');
                    if (domainCell) {
                        const domainText = domainCell.textContent.trim();
                        let domainMatch = false;
                        
                        domainFilters.forEach(filter => {
                            if (filter === 'condiciones-fisicas' && domainText.includes('Condiciones en el ambiente')) domainMatch = true;
                            if (filter === 'carga-trabajo' && domainText.includes('Carga de trabajo')) domainMatch = true;
                            if (filter === 'jornada-trabajo' && domainText.includes('Jornada de trabajo')) domainMatch = true;
                            if (filter === 'liderazgo-supervision' && domainText.includes('Liderazgo y supervisión')) domainMatch = true;
                            if (filter === 'relaciones-trabajo' && domainText.includes('Relaciones en el trabajo')) domainMatch = true;
                            if (filter === 'entorno-organizacional' && domainText.includes('Entorno organizacional')) domainMatch = true;
                        });
                        
                        if (!domainMatch) {
                            shouldShow = false;
                        }
                    }
                }
                
                // Filtrar por dimensión
                if (dimensionFilters.length > 0 && !dimensionFilters.includes('todos')) {
                    const dimensionCell = row.querySelector('.category-dimension-info');
                    if (dimensionCell) {
                        const dimensionText = dimensionCell.textContent.trim();
                        let dimensionMatch = false;
                        
                        dimensionFilters.forEach(filter => {
                            if (filter === 'condiciones-fisicas' && dimensionText.includes('Condiciones físicas')) dimensionMatch = true;
                            if (filter === 'condiciones-seguridad' && dimensionText.includes('Condiciones de seguridad')) dimensionMatch = true;
                            if (filter === 'exigencias-cuantitativas' && dimensionText.includes('Exigencias cuantitativas')) dimensionMatch = true;
                            if (filter === 'exigencias-mentales' && dimensionText.includes('Exigencias mentales')) dimensionMatch = true;
                            if (filter === 'exigencias-emocionales' && dimensionText.includes('Exigencias emocionales')) dimensionMatch = true;
                            if (filter === 'jornada-trabajo' && dimensionText.includes('Jornada de trabajo')) dimensionMatch = true;
                            if (filter === 'liderazgo' && dimensionText.includes('Liderazgo')) dimensionMatch = true;
                            if (filter === 'relaciones-trabajo' && dimensionText.includes('Relaciones en el trabajo')) dimensionMatch = true;
                            if (filter === 'entorno-organizacional' && dimensionText.includes('Entorno organizacional')) dimensionMatch = true;
                        });
                        
                        if (!dimensionMatch) {
                            shouldShow = false;
                        }
                    }
                }
                
                // Verificar si hay filtros demográficos activos
                const hasDemographicFilters = genderFilters.length > 0 || maritalStatusFilters.length > 0 || 
                    ageFilters.length > 0 || countryFilters.length > 0 || cityFilters.length > 0 || 
                    departmentFilters.length > 0 || positionFilters.length > 0 || leaderFilters.length > 0;
                
                if (hasDemographicFilters) {
                    // Actualizar números basados en filtros demográficos
                    updateNewRowNumbers(row, departmentFilters, positionFilters, genderFilters, maritalStatusFilters, 
                        ageFilters, countryFilters, cityFilters, leaderFilters);
                } else {
                    // Restaurar números originales si no hay filtros demográficos
                    restoreNewOriginalNumbers(row);
                }
                
                // Mostrar u ocultar la fila
                if (shouldShow) {
                    row.style.display = '';
                    visibleCount++;
                    console.log(`✅ Fila visible:`, row.querySelector('.dimension-cell span')?.textContent || 'Sin texto');
                } else {
                    row.style.display = 'none';
                    console.log(`❌ Fila oculta:`, row.querySelector('.dimension-cell span')?.textContent || 'Sin texto');
                }
            });
            
            console.log(`✅ Filtros aplicados. ${visibleCount} filas visibles de ${tableRows.length} totales`);
            
            // Actualizar contador de resultados si existe
            const resultCount = document.querySelector('#new-overview-panel .table-info .result-count');
            if (resultCount) {
                resultCount.textContent = `${visibleCount} resultados`;
            }
            
            // Cerrar el side panel y backdrop después de aplicar filtros
            const filtersPanel = document.getElementById('new-table-filters-side-panel');
            const filtersBackdrop = document.getElementById('new-filters-backdrop');
            
            if (filtersPanel) {
                filtersPanel.classList.remove('show');
            }
            if (filtersBackdrop) {
                filtersBackdrop.classList.remove('show');
            }
            
            console.log('✅ Side panel y backdrop cerrados después de aplicar filtros');
            
            // Cerrar todos los dropdowns nuevos que puedan estar abiertos
            const newCustomSelects = document.querySelectorAll('#new-table-filters-side-panel .custom-select');
            newCustomSelects.forEach(select => {
                closeNewDropdown(select.id);
            });
            console.log('✅ Todos los dropdowns nuevos cerrados después de aplicar filtros');
            
            // Actualizar badge de filtros
            updateFilterBadge();
        }

        // Función para contar filtros activos y actualizar badge
        function updateFilterBadge() {
            const badge = document.getElementById('new-table-filter-badge');
            if (!badge) return;
            
            let activeFiltersCount = 0;
            
            // Contar filtros activos (excluyendo "todos")
            const riskFilters = getSelectedValues('new-risk-select');
            if (riskFilters.length > 0 && !riskFilters.includes('todos')) {
                activeFiltersCount += riskFilters.length;
            }
            
            const departmentFilters = getSelectedValues('new-department-select');
            if (departmentFilters.length > 0 && !departmentFilters.includes('todos')) {
                activeFiltersCount += departmentFilters.length;
            }
            
            const positionFilters = getSelectedValues('new-position-select');
            if (positionFilters.length > 0 && !positionFilters.includes('todos')) {
                activeFiltersCount += positionFilters.length;
            }
            
            const genderFilters = getSelectedValues('new-gender-select');
            if (genderFilters.length > 0 && !genderFilters.includes('todos')) {
                activeFiltersCount += genderFilters.length;
            }
            
            const maritalStatusFilters = getSelectedValues('new-marital-status-select');
            if (maritalStatusFilters.length > 0 && !maritalStatusFilters.includes('todos')) {
                activeFiltersCount += maritalStatusFilters.length;
            }
            
            const ageFilters = getSelectedValues('new-age-select');
            if (ageFilters.length > 0 && !ageFilters.includes('todos')) {
                activeFiltersCount += ageFilters.length;
            }
            
            const countryFilters = getSelectedValues('new-country-select');
            if (countryFilters.length > 0 && !countryFilters.includes('todos')) {
                activeFiltersCount += countryFilters.length;
            }
            
            const cityFilters = getSelectedValues('new-city-select');
            if (cityFilters.length > 0 && !cityFilters.includes('todos')) {
                activeFiltersCount += cityFilters.length;
            }
            
            const leaderFilters = getSelectedValues('new-leader-select');
            if (leaderFilters.length > 0 && !leaderFilters.includes('todos')) {
                activeFiltersCount += leaderFilters.length;
            }
            
            const categoryFilters = getSelectedValues('new-category-select');
            if (categoryFilters.length > 0 && !categoryFilters.includes('todos')) {
                activeFiltersCount += categoryFilters.length;
            }
            
            const domainFilters = getSelectedValues('new-domain-select');
            if (domainFilters.length > 0 && !domainFilters.includes('todos')) {
                activeFiltersCount += domainFilters.length;
            }
            
            const dimensionFilters = getSelectedValues('new-dimension-select');
            if (dimensionFilters.length > 0 && !dimensionFilters.includes('todos')) {
                activeFiltersCount += dimensionFilters.length;
            }
            
            // Actualizar badge
            if (activeFiltersCount > 0) {
                badge.textContent = activeFiltersCount.toString();
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
            
            console.log(`🏷️ Badge actualizado: ${activeFiltersCount} filtros activos`);
        }

        // Función para limpiar filtros en la tabla general
        // Función para actualizar números de fila basados en filtros demográficos
        function updateNewRowNumbers(row, departmentFilters, positionFilters, genderFilters, maritalStatusFilters, ageFilters, countryFilters, cityFilters, leaderFilters) {
            const categoryText = row.querySelector('.category-cell span')?.textContent.trim() || '';
            const domainText = row.querySelector('.category-domain-info')?.textContent.trim() || '';
            
            // Obtener datos demográficos simulados para esta fila
            const simulatedDepartment = getSimulatedArea(categoryText, domainText);
            const simulatedPosition = getSimulatedPosition(categoryText, domainText);
            const simulatedGender = getSimulatedGender(categoryText, domainText);
            const simulatedMaritalStatus = getSimulatedMaritalStatus(categoryText, domainText);
            const simulatedAge = getSimulatedAge(categoryText, domainText);
            const simulatedCountry = getSimulatedCountry(categoryText, domainText);
            const simulatedCity = getSimulatedCity(categoryText, domainText);
            const simulatedLeader = getSimulatedLeader(categoryText, domainText);
            
            // Verificar si esta fila coincide con los filtros demográficos
            const matchesDepartment = departmentFilters.length === 0 || departmentFilters.includes('todos') || departmentFilters.includes(simulatedDepartment);
            const matchesPosition = positionFilters.length === 0 || positionFilters.includes('todos') || positionFilters.includes(simulatedPosition);
            const matchesGender = genderFilters.length === 0 || genderFilters.includes('todos') || genderFilters.includes(simulatedGender);
            const matchesMaritalStatus = maritalStatusFilters.length === 0 || maritalStatusFilters.includes('todos') || maritalStatusFilters.includes(simulatedMaritalStatus);
            const matchesAge = ageFilters.length === 0 || ageFilters.includes('todos') || ageFilters.includes(simulatedAge);
            const matchesCountry = countryFilters.length === 0 || countryFilters.includes('todos') || countryFilters.includes(simulatedCountry);
            const matchesCity = cityFilters.length === 0 || cityFilters.includes('todos') || cityFilters.includes(simulatedCity);
            const matchesLeader = leaderFilters.length === 0 || leaderFilters.includes('todos') || leaderFilters.includes(simulatedLeader);
            
            const matchesAllDemographic = matchesDepartment && matchesPosition && matchesGender && matchesMaritalStatus && matchesAge && matchesCountry && matchesCity && matchesLeader;
            
            // Actualizar números basados en si coincide con los filtros
            const riskCountCell = row.querySelector('.risk-count');
            const percentageCell = row.querySelector('.percentage');
            
            if (riskCountCell && percentageCell) {
                // Guardar valores originales si no están guardados
                if (!riskCountCell.dataset.originalValue) {
                    riskCountCell.dataset.originalValue = riskCountCell.textContent;
                }
                if (!percentageCell.dataset.originalValue) {
                    percentageCell.dataset.originalValue = percentageCell.textContent;
                }
                
                if (matchesAllDemographic) {
                    // Si coincide con todos los filtros, mantener números originales
                    riskCountCell.textContent = riskCountCell.dataset.originalValue;
                    percentageCell.textContent = percentageCell.dataset.originalValue;
                } else {
                    // Si no coincide, reducir números proporcionalmente
                    const originalCount = parseInt(riskCountCell.dataset.originalValue) || 0;
                    const originalPercentage = parseFloat(percentageCell.dataset.originalValue) || 0;
                    
                    // Calcular factor de reducción basado en cuántos filtros coinciden
                    let matchCount = 0;
                    let totalFilters = 0;
                    
                    if (departmentFilters.length > 0 && !departmentFilters.includes('todos')) { totalFilters++; if (matchesDepartment) matchCount++; }
                    if (positionFilters.length > 0 && !positionFilters.includes('todos')) { totalFilters++; if (matchesPosition) matchCount++; }
                    if (genderFilters.length > 0 && !genderFilters.includes('todos')) { totalFilters++; if (matchesGender) matchCount++; }
                    if (maritalStatusFilters.length > 0 && !maritalStatusFilters.includes('todos')) { totalFilters++; if (matchesMaritalStatus) matchCount++; }
                    if (ageFilters.length > 0 && !ageFilters.includes('todos')) { totalFilters++; if (matchesAge) matchCount++; }
                    if (countryFilters.length > 0 && !countryFilters.includes('todos')) { totalFilters++; if (matchesCountry) matchCount++; }
                    if (cityFilters.length > 0 && !cityFilters.includes('todos')) { totalFilters++; if (matchesCity) matchCount++; }
                    if (leaderFilters.length > 0 && !leaderFilters.includes('todos')) { totalFilters++; if (matchesLeader) matchCount++; }
                    
                    const reductionFactor = totalFilters > 0 ? matchCount / totalFilters : 1;
                    const newCount = Math.round(originalCount * reductionFactor);
                    const newPercentage = Math.round(originalPercentage * reductionFactor * 100) / 100;
                    
                    riskCountCell.textContent = newCount;
                    percentageCell.textContent = newPercentage.toFixed(1) + '%';
                }
            }
        }
        
        // Función para restaurar números originales
        function restoreNewOriginalNumbers(row) {
            const riskCountCell = row.querySelector('.risk-count');
            const percentageCell = row.querySelector('.percentage');
            
            if (riskCountCell && riskCountCell.dataset.originalValue) {
                riskCountCell.textContent = riskCountCell.dataset.originalValue;
            }
            if (percentageCell && percentageCell.dataset.originalValue) {
                percentageCell.textContent = percentageCell.dataset.originalValue;
            }
        }
        
        function clearNewFilters() {
            console.log('🧹 ===== LIMPIANDO FILTROS EN TABLA GENERAL =====');
            
            // Limpiar todos los checkboxes
            const checkboxes = document.querySelectorAll('#new-table-filters-side-panel input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
            
            // Seleccionar "Todos" en cada filtro
            const todosCheckboxes = document.querySelectorAll('#new-table-filters-side-panel input[type="checkbox"][id$="-todos"]');
            todosCheckboxes.forEach(cb => cb.checked = true);
            
            // Actualizar textos de los selects
            updateAllSelectTexts();
            
            // Mostrar todas las filas y restaurar números originales
            const tableRows = document.querySelectorAll('#new-overview-panel .results-table tbody tr');
            tableRows.forEach(row => {
                row.style.display = '';
                restoreNewOriginalNumbers(row);
            });
            
            console.log(`✅ Filtros limpiados. ${tableRows.length} filas visibles`);
            
            // Actualizar badge de filtros
            updateFilterBadge();
            
            // Actualizar contador de resultados si existe
            const resultCount = document.querySelector('#new-overview-panel .table-info .result-count');
            if (resultCount) {
                resultCount.textContent = `${tableRows.length} resultados`;
            }
        }

        // ===== FUNCIONES PARA FILTROS DE DIMENSIONES =====

        // Función para aplicar filtros en la tabla de dimensiones
        function applyDimensionsFilters() {
            console.log('🔍 ===== APLICANDO FILTROS EN TABLA DIMENSIONES =====');
            
            // Obtener valores de todos los filtros
            const riskFilter = document.getElementById('risk-filter-dimensions')?.value || 'todos';
            const domainFilter = document.getElementById('domain-filter-dimensions')?.value || 'todos';
            const areaFilter = document.getElementById('area-filter-dimensions')?.value || 'todos';
            const positionFilter = document.getElementById('position-filter-dimensions')?.value || 'todos';
            const genderFilter = document.getElementById('gender-filter-dimensions')?.value || 'todos';
            const maritalFilter = document.getElementById('marital-filter-dimensions')?.value || 'todos';
            const ageFilter = document.getElementById('age-filter-dimensions')?.value || 'todos';
            const countryFilter = document.getElementById('country-filter-dimensions')?.value || 'todos';
            const cityFilter = document.getElementById('city-filter-dimensions')?.value || 'todos';
            const leaderFilter = document.getElementById('leader-filter-dimensions')?.value || 'todos';
            
            console.log('🔍 Filtros seleccionados:', {
                risk: riskFilter,
                domain: domainFilter,
                area: areaFilter,
                position: positionFilter,
                gender: genderFilter,
                marital: maritalFilter,
                age: ageFilter,
                country: countryFilter,
                city: cityFilter,
                leader: leaderFilter
            });
            
            // Obtener todas las filas de la tabla de dimensiones
            const tableRows = document.querySelectorAll('#new-dimensions-panel .results-table tbody tr');
            console.log(`🔍 Total de filas encontradas: ${tableRows.length}`);
            
            let visibleRows = 0;
            
            // Verificar si hay filtros demográficos activos
            const hasDemographicFilters = (genderFilter !== 'todos') ||
                                        (maritalFilter !== 'todos') ||
                                        (ageFilter !== 'todos') ||
                                        (countryFilter !== 'todos') ||
                                        (cityFilter !== 'todos') ||
                                        (areaFilter !== 'todos') ||
                                        (positionFilter !== 'todos') ||
                                        (leaderFilter !== 'todos');
            
            tableRows.forEach((row, index) => {
                let shouldShow = true;
                
                // Obtener datos de la fila usando los selectores correctos
                const dimensionCell = row.querySelector('.dimension-cell span');
                const domainCell = row.querySelector('.dimension-domain-info');
                const riskCountCell = row.querySelector('.risk-count');
                const percentageCell = row.querySelector('.percentage');
                const riskBadge = row.querySelector('.risk-badge');
                
                if (!dimensionCell || !domainCell || !riskBadge) {
                    console.log(`⚠️ Fila ${index} no tiene las celdas esperadas`);
                    return;
                }
                
                const dimensionText = dimensionCell.textContent.trim();
                const domainText = domainCell.textContent.trim();
                const riskText = riskBadge.textContent.trim();
                
                console.log(`🔍 Fila ${index}:`, {
                    dimension: dimensionText,
                    domain: domainText,
                    risk: riskText
                });
                
                // Aplicar filtros de contenido (nivel de riesgo)
                if (shouldShow && riskFilter !== 'todos') {
                    const riskTextLower = riskText.toLowerCase();
                    const filterLower = riskFilter.toLowerCase();
                    const riskMatch = riskTextLower.includes(filterLower) || 
                                     (filterLower === 'muy-alto' && riskTextLower.includes('muy alto'));
                    if (!riskMatch) shouldShow = false;
                }
                
                // Aplicar filtro de dominio
                if (shouldShow && domainFilter !== 'todos') {
                    const domainKeywords = {
                        'condiciones': 'condiciones',
                        'carga': 'carga',
                        'control': 'control',
                        'jornada': 'jornada',
                        'liderazgo': 'liderazgo',
                        'relaciones': 'relaciones',
                        'violencia': 'violencia'
                    };
                    
                    const keyword = domainKeywords[domainFilter];
                    if (keyword && !domainText.toLowerCase().includes(keyword)) {
                        shouldShow = false;
                    }
                }
                
                // Si hay filtros demográficos activos, actualizar los números
                if (shouldShow && hasDemographicFilters && riskCountCell && percentageCell) {
                    const originalCount = parseInt(riskCountCell.textContent) || 0;
                    const originalPercentage = parseFloat(percentageCell.textContent.replace('%', '')) || 0;
                    
                    // Calcular nuevo número basado en filtros demográficos
                    let demographicMultiplier = 1.0;
                    
                    // Aplicar multiplicadores basados en filtros demográficos
                    if (genderFilter !== 'todos') {
                        if (genderFilter === 'Masculino') {
                            demographicMultiplier *= 0.6; // 60% son masculinos
                        } else if (genderFilter === 'Femenino') {
                            demographicMultiplier *= 0.4; // 40% son femeninos
                        }
                    }
                    
                    if (maritalFilter !== 'todos') {
                        if (maritalFilter === 'Soltero') {
                            demographicMultiplier *= 0.5; // 50% son solteros
                        } else if (maritalFilter === 'Casado') {
                            demographicMultiplier *= 0.4; // 40% son casados
                        } else if (maritalFilter === 'Divorciada') {
                            demographicMultiplier *= 0.1; // 10% son divorciados
                        }
                    }
                    
                    if (ageFilter !== 'todos') {
                        if (ageFilter === '20-30') {
                            demographicMultiplier *= 0.3; // 30% en este rango
                        } else if (ageFilter === '31-40') {
                            demographicMultiplier *= 0.4; // 40% en este rango
                        } else if (ageFilter === '41-50') {
                            demographicMultiplier *= 0.2; // 20% en este rango
                        } else if (ageFilter === '51+') {
                            demographicMultiplier *= 0.1; // 10% en este rango
                        }
                    }
                    
                    if (areaFilter !== 'todos') {
                        demographicMultiplier *= 0.5; // Distribución uniforme
                    }
                    
                    if (positionFilter !== 'todos') {
                        demographicMultiplier *= 0.5; // Distribución uniforme
                    }
                    
                    if (countryFilter !== 'todos') {
                        demographicMultiplier *= 0.5; // Distribución uniforme
                    }
                    
                    if (cityFilter !== 'todos') {
                        demographicMultiplier *= 0.5; // Distribución uniforme
                    }
                    
                    if (leaderFilter !== 'todos') {
                        demographicMultiplier *= 0.5; // Distribución uniforme
                    }
                    
                    // Calcular nuevos valores
                    const newCount = Math.round(originalCount * demographicMultiplier);
                    const newPercentage = Math.round((newCount / 150) * 100 * 10) / 10; // Asumiendo 150 usuarios totales
                    
                    // Actualizar los valores en la tabla
                    riskCountCell.textContent = newCount.toString();
                    percentageCell.textContent = `${newPercentage}%`;
                    
                    console.log(`📊 Fila ${index} actualizada:`, {
                        dimension: dimensionText,
                        originalCount: originalCount,
                        newCount: newCount,
                        originalPercentage: originalPercentage,
                        newPercentage: newPercentage,
                        multiplier: demographicMultiplier
                    });
                }
                
                // Mostrar u ocultar fila
                if (shouldShow) {
                    row.style.display = '';
                    visibleRows++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            console.log(`✅ Filtros aplicados. ${visibleRows} filas visibles de ${tableRows.length} total`);
            
            // Cerrar panel y backdrop
            const filtersPanel = document.getElementById('dimensions-table-filters-side-panel');
            const filtersBackdrop = document.getElementById('dimensions-filters-backdrop');
            if (filtersPanel) filtersPanel.classList.remove('show');
            if (filtersBackdrop) filtersBackdrop.classList.remove('show');
            
            // Cerrar todos los dropdowns de dimensiones que puedan estar abiertos
            const dimensionsCustomSelects = document.querySelectorAll('#dimensions-table-filters-side-panel .custom-select');
            console.log('🔧 CERRANDO DROPDOWNS DIMENSIONES:', dimensionsCustomSelects.length);
            dimensionsCustomSelects.forEach((select, index) => {
                console.log(`🔧 Cerrando dropdown dimensiones ${index + 1}:`, select.id);
                closeNewDropdown(select.id);
            });
            console.log('✅ Todos los dropdowns de dimensiones cerrados después de aplicar filtros');
            
            // Actualizar badge de filtros
            updateDimensionsFilterBadge();
            
            // Actualizar contador de resultados si existe
            const resultCount = document.querySelector('#new-dimensions-panel .table-info .result-count');
            if (resultCount) {
                resultCount.textContent = `${visibleRows} resultados`;
            }
        }
        
        function clearDimensionsFilters() {
            console.log('🧹 ===== LIMPIANDO FILTROS EN TABLA DIMENSIONES =====');
            
            // Limpiar todos los checkboxes
            const checkboxes = document.querySelectorAll('#dimensions-table-filters-side-panel input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
            
            // Seleccionar "Todos" en cada filtro
            const todosCheckboxes = document.querySelectorAll('#dimensions-table-filters-side-panel input[type="checkbox"][id$="-todos"]');
            todosCheckboxes.forEach(cb => cb.checked = true);
            
            // Actualizar textos de los selects
            updateDimensionsSelectTexts();
            
            // Restaurar números originales y mostrar todas las filas
            const tableRows = document.querySelectorAll('#new-dimensions-panel .results-table tbody tr');
            tableRows.forEach(row => {
                row.style.display = '';
                
                // Restaurar números originales usando los selectores correctos
                const riskCountCell = row.querySelector('.risk-count');
                const percentageCell = row.querySelector('.percentage');
                
                if (riskCountCell && percentageCell) {
                    // Restaurar valores originales basados en el contenido de la dimensión
                    const dimensionCell = row.querySelector('.dimension-cell span');
                    if (dimensionCell) {
                        const dimensionText = dimensionCell.textContent.trim();
                        
                        // Mapeo de dimensiones a valores originales
                        const originalValues = {
                            'Condiciones físicas': { count: 12, percentage: 8.0 },
                            'Condiciones de seguridad': { count: 8, percentage: 5.3 },
                            'Exigencias cuantitativas': { count: 18, percentage: 12.0 },
                            'Exigencias mentales': { count: 25, percentage: 16.7 },
                            'Exigencias emocionales': { count: 22, percentage: 14.7 },
                            'Falta de control sobre el trabajo': { count: 15, percentage: 10.0 },
                            'Falta de autonomía': { count: 10, percentage: 6.7 },
                            'Falta de claridad de rol': { count: 13, percentage: 8.7 },
                            'Falta de reconocimiento': { count: 20, percentage: 13.3 },
                            'Jornada de trabajo': { count: 22, percentage: 14.7 },
                            'Liderazgo': { count: 18, percentage: 12.0 },
                            'Relaciones interpersonales': { count: 8, percentage: 5.3 },
                            'Violencia laboral': { count: 32, percentage: 21.3 }
                        };
                        
                        // Buscar la dimensión correspondiente
                        for (const [key, values] of Object.entries(originalValues)) {
                            if (dimensionText.includes(key)) {
                                riskCountCell.textContent = values.count.toString();
                                percentageCell.textContent = `${values.percentage}%`;
                                break;
                            }
                        }
                    }
                }
            });
            
            console.log(`✅ Filtros limpiados. ${tableRows.length} filas visibles`);
            
            // Actualizar badge de filtros
            updateDimensionsFilterBadge();
            
            // Actualizar contador de resultados si existe
            const resultCount = document.querySelector('#new-dimensions-panel .table-info .result-count');
            if (resultCount) {
                resultCount.textContent = `${tableRows.length} resultados`;
            }
        }
        
        function updateDimensionsSelectTexts() {
            const selectIds = [
                'dimensions-risk-select',
                'dimensions-department-select',
                'dimensions-position-select',
                'dimensions-gender-select',
                'dimensions-marital-status-select',
                'dimensions-age-select',
                'dimensions-country-select',
                'dimensions-city-select',
                'dimensions-leader-select',
                'dimensions-category-select',
                'dimensions-domain-select',
                'dimensions-dimension-select'
            ];
            
            selectIds.forEach(selectId => {
                updateSelectText(selectId);
            });
        }
        
        
        // Configurar componente select personalizado para los filtros de dimensiones
        function setupDimensionsCustomSelects() {
            console.log('🔧 ===== INICIANDO SETUP DE CUSTOM SELECTS DIMENSIONES =====');
            const dimensionsCustomSelects = document.querySelectorAll('#dimensions-table-filters-side-panel .custom-select');
            console.log('🔧 Selects de dimensiones encontrados:', dimensionsCustomSelects.length);
            
            dimensionsCustomSelects.forEach((select, index) => {
                console.log(`🔧 Configurando select dimensiones ${index + 1}:`, select.id);
                const selectTrigger = select.querySelector('.select-trigger');
                const selectDropdown = select.querySelector('.select-dropdown');
                const selectOptions = select.querySelectorAll('.select-option');
                
                console.log(`🔧 Select dimensiones ${index + 1} elementos:`, {
                    trigger: !!selectTrigger,
                    dropdown: !!selectDropdown,
                    options: selectOptions.length
                });
                
                // Toggle dropdown - USAR NUEVO SISTEMA
                selectTrigger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    console.log(`🔧 Click en trigger del select dimensiones ${select.id}`);
                    
                    // Cerrar otros dropdowns de dimensiones
                    dimensionsCustomSelects.forEach(otherSelect => {
                        if (otherSelect !== select) {
                            closeNewDropdown(otherSelect.id);
                        }
                    });
                    
                    // Crear opciones para el nuevo dropdown
                    const options = [];
                    console.log(`🔧 DIAGNÓSTICO OPCIONES DIMENSIONES ${select.id}:`);
                    console.log('  📋 SelectOptions encontrados:', selectOptions.length);
                    
                    selectOptions.forEach((option, index) => {
                        console.log(`  📋 Opción ${index + 1}:`, {
                            element: option,
                            innerHTML: option.innerHTML,
                            textContent: option.textContent,
                            tagName: option.tagName,
                            className: option.className
                        });
                        
                        // Buscar checkbox de diferentes formas
                        const checkbox = option.querySelector('input[type="checkbox"]') || 
                                       option.querySelector('input') ||
                                       option.querySelector('checkbox');
                        
                        // Buscar label de diferentes formas  
                        const label = option.querySelector('label') ||
                                    option.querySelector('span') ||
                                    option.querySelector('div');
                        
                        console.log(`  📋 Opción ${index + 1} elementos:`, {
                            checkbox: !!checkbox,
                            label: !!label,
                            checkboxValue: checkbox ? checkbox.value : 'N/A',
                            labelText: label ? label.textContent : 'N/A',
                            checkboxType: checkbox ? checkbox.type : 'N/A',
                            labelTagName: label ? label.tagName : 'N/A'
                        });
                        
                        // Mostrar todos los elementos hijos
                        const allChildren = option.querySelectorAll('*');
                        console.log(`  📋 Opción ${index + 1} todos los hijos:`, Array.from(allChildren).map(child => ({
                            tagName: child.tagName,
                            className: child.className,
                            textContent: child.textContent,
                            type: child.type || 'N/A'
                        })));
                        
                        if (checkbox && label) {
                            options.push({
                                value: checkbox.value,
                                text: label.textContent,
                                checked: checkbox.checked
                            });
                            console.log(`  ✅ Opción ${index + 1} agregada:`, {
                                value: checkbox.value,
                                text: label.textContent,
                                checked: checkbox.checked
                            });
                        } else {
                            console.log(`  ❌ Opción ${index + 1} NO agregada - elementos faltantes`);
                        }
                    });
                    
                    console.log(`🔧 OPCIONES FINALES DIMENSIONES ${select.id}:`, options);
                    
                    // Crear nuevo dropdown
                    createNewDropdown(select.id, options, (value, checked) => {
                        console.log(`🔧 Opción seleccionada dimensiones: ${value} = ${checked}`);
                        
                        // Actualizar checkbox original
                        const originalCheckbox = select.querySelector(`input[value="${value}"]`);
                        if (originalCheckbox) {
                            originalCheckbox.checked = checked;
                        }
                        
                        // Manejar lógica de "Todos"
                        const todosCheckbox = select.querySelector('input[type="checkbox"][id$="-todos"]');
                        if (value === 'todos') {
                            handleTodosOption(select.id, todosCheckbox);
                        } else {
                            // Si se selecciona una opción específica, deseleccionar "Todos"
                            if (checked && todosCheckbox) {
                                todosCheckbox.checked = false;
                            }
                            
                            // Si no hay opciones seleccionadas, seleccionar "Todos"
                            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]');
                            const hasSelected = Array.from(allCheckboxes).some(cb => cb.checked);
                            if (!hasSelected && todosCheckbox) {
                                todosCheckbox.checked = true;
                            }
                        }
                        
                        updateDimensionsSelectTexts();
                    });
                });
                
                // Manejar opciones
                selectOptions.forEach(option => {
                    const checkbox = option.querySelector('input[type="checkbox"]');
                    const optionText = option.querySelector('.option-text');
                    
                    if (checkbox && optionText) {
                        option.addEventListener('click', function(e) {
                            e.stopPropagation();
                            checkbox.checked = !checkbox.checked;
                            
                            // Manejar lógica de "Todos"
                            const selectId = select.id;
                            if (option.dataset.value === 'todos') {
                                if (checkbox.checked) {
                                    // Desmarcar todas las otras opciones
                                    selectOptions.forEach(opt => {
                                        if (opt !== option) {
                                            const otherCheckbox = opt.querySelector('input[type="checkbox"]');
                                            if (otherCheckbox) otherCheckbox.checked = false;
                                        }
                                    });
                                }
                            } else {
                                // Si se selecciona una opción específica, desmarcar "Todos"
                                const todosOption = select.querySelector('.select-option[data-value="todos"]');
                                if (todosOption) {
                                    const todosCheckbox = todosOption.querySelector('input[type="checkbox"]');
                                    if (todosCheckbox) todosCheckbox.checked = false;
                                }
                            }
                            
                            // Actualizar texto del select
                            updateSelectText(selectId);
                        });
                    }
                });
            });
            
            // Cerrar dropdowns al hacer click fuera
            document.addEventListener('click', function() {
                dimensionsCustomSelects.forEach(select => {
                    const selectDropdown = select.querySelector('.select-dropdown');
                    if (selectDropdown) {
                        selectDropdown.classList.remove('show');
                    }
                });
            });
        }

        // FUNCIÓN PARA INICIALIZAR CONTROLES DE LA TABLA EN NUEVOS TABS
        function initializeNewTableControls() {
            console.log('🚀 ===== INICIANDO CONTROLES DE TABLA NUEVOS TABS =====');
            
            // Botón de filtros
            const filtersBtn = document.getElementById('new-table-filters-btn');
            const filtersPanel = document.getElementById('new-table-filters-side-panel');
            const closeFiltersBtn = document.getElementById('new-close-table-filters');
            const filtersBackdrop = document.getElementById('new-filters-backdrop');
            
            if (filtersBtn && filtersPanel) {
                console.log('✅ Botón de filtros encontrado:', filtersBtn);
                console.log('✅ Panel de filtros encontrado:', filtersPanel);
                
                filtersBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🔍 Click en botón de filtros (nuevos tabs)');
                    console.log('📋 filtersPanel:', filtersPanel);
                    console.log('📋 filtersBackdrop:', filtersBackdrop);
                    
                    // Verificar clases antes del toggle
                    console.log('📋 Clases del panel antes:', filtersPanel.className);
                    
                    filtersPanel.classList.toggle('show');
                    console.log('📋 Panel show class toggled');
                    console.log('📋 Clases del panel después:', filtersPanel.className);
                    
                    if (filtersBackdrop) {
                        filtersBackdrop.classList.toggle('show');
                        console.log('📋 Backdrop show class toggled');
                        console.log('📋 Backdrop classes:', filtersBackdrop.className);
                    } else {
                        console.log('❌ filtersBackdrop not found!');
                    }
                });
            } else {
                console.log('❌ Elementos no encontrados:', {
                    filtersBtn: !!filtersBtn,
                    filtersPanel: !!filtersPanel
                });
            }
            
            if (closeFiltersBtn && filtersPanel) {
                closeFiltersBtn.addEventListener('click', function() {
                    console.log('❌ Cerrando filtros (nuevos tabs)');
                    filtersPanel.classList.remove('show');
                    if (filtersBackdrop) {
                        filtersBackdrop.classList.remove('show');
                    }
                });
            }
            
            // Cerrar panel al hacer click en el backdrop
            if (filtersBackdrop) {
                filtersBackdrop.addEventListener('click', function() {
                    console.log('❌ Click en backdrop - cerrando filtros');
                    filtersPanel.classList.remove('show');
                    filtersBackdrop.classList.remove('show');
                });
            }
            
            // Botones de filtros
            const applyFiltersBtn = document.getElementById('new-apply-table-filters');
            const clearFiltersBtn = document.getElementById('new-clear-table-filters');
            
            if (applyFiltersBtn) {
                applyFiltersBtn.addEventListener('click', function() {
                    console.log('✅ Aplicando filtros (nuevos tabs)');
                    console.log('🔍 Botón de aplicar filtros clickeado');
                    applyNewFilters();
                    // Cerrar el panel de filtros
                    filtersPanel.classList.remove('show');
                    if (filtersBackdrop) {
                        filtersBackdrop.classList.remove('show');
                    }
                });
            } else {
                console.log('❌ Botón de aplicar filtros no encontrado');
            }
            
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', function() {
                    console.log('🧹 Limpiando filtros (nuevos tabs)');
                    clearNewFilters();
                });
            }

            // Configurar selects personalizados para los nuevos filtros
            setupNewCustomSelects();
            
            console.log('✅ ===== CONTROLES DE TABLA NUEVOS TABS INICIALIZADOS =====');
        }

        // Función para aplicar filtros de la tabla general
        function applyNewTableFilters() {
            console.log('🔍 ===== APLICANDO FILTROS DE TABLA GENERAL =====');
            console.log('🔍 PASO 1: Verificando si la función se ejecuta');
            
            // Verificar si estamos en el tab correcto
            const overviewPanel = document.getElementById('new-overview-panel');
            console.log('🔍 PASO 2: Panel overview encontrado:', !!overviewPanel);
            if (overviewPanel) {
                console.log('🔍 PASO 2.1: Panel overview visible:', overviewPanel.style.display);
                console.log('🔍 PASO 2.2: Panel overview clases:', overviewPanel.className);
            }
            
            // Obtener todas las filas de la tabla
            const tableRows = document.querySelectorAll('#new-overview-panel .results-table tbody tr');
            console.log(`🔍 PASO 3: Total de filas encontradas: ${tableRows.length}`);
            
            if (tableRows.length === 0) {
                console.log('❌ PASO 3.1: No se encontraron filas en la tabla');
                console.log('🔍 PASO 3.2: Verificando estructura de la tabla...');
                const table = document.querySelector('#new-overview-panel .results-table');
                console.log('🔍 PASO 3.3: Tabla encontrada:', !!table);
                if (table) {
                    const tbody = table.querySelector('tbody');
                    console.log('🔍 PASO 3.4: Tbody encontrado:', !!tbody);
                    if (tbody) {
                        const allRows = tbody.querySelectorAll('tr');
                        console.log('🔍 PASO 3.5: Filas en tbody:', allRows.length);
                        allRows.forEach((row, index) => {
                            console.log(`🔍 PASO 3.6: Fila ${index + 1}:`, row.className, row.textContent.substring(0, 50));
                        });
                    }
                }
                return;
            }
            
            console.log('🔍 PASO 4: Filas encontradas, continuando con filtros...');
            
            // Obtener filtros seleccionados de manera simple
            console.log('🔍 PASO 5: Obteniendo elementos de filtros...');
            const riskSelect = document.getElementById('new-risk-select');
            const categorySelect = document.getElementById('new-category-select');
            const domainSelect = document.getElementById('new-domain-select');
            const dimensionSelect = document.getElementById('new-dimension-select');
            
            console.log('🔍 PASO 5.1: Risk select encontrado:', !!riskSelect);
            console.log('🔍 PASO 5.2: Category select encontrado:', !!categorySelect);
            console.log('🔍 PASO 5.3: Domain select encontrado:', !!domainSelect);
            console.log('🔍 PASO 5.4: Dimension select encontrado:', !!dimensionSelect);
            
        // Obtener valores seleccionados
        const selectedRisks = [];
        const selectedCategories = [];
        const selectedDomains = [];
        const selectedDimensions = [];
        
        console.log('🔍 PASO 6: Obteniendo valores seleccionados...');
        
        if (riskSelect) {
            console.log('🔍 PASO 6.1: Procesando filtros de riesgo...');
            const riskCheckboxes = riskSelect.querySelectorAll('input[type="checkbox"]:checked');
            console.log('🔍 PASO 6.1.1: Checkboxes de riesgo seleccionados:', riskCheckboxes.length);
            
            // Verificar si "todos" está seleccionado
            const todosCheckbox = riskSelect.querySelector('input[id="risk-todos"]');
            const todosSelected = todosCheckbox && todosCheckbox.checked;
            console.log('🔍 PASO 6.1.1.1: Todos seleccionado:', todosSelected);
            
            // FORZAR: Si hay más de 1 checkbox seleccionado, ignorar "todos"
            if (riskCheckboxes.length > 1) {
                console.log('🔍 PASO 6.1.1.2: Múltiples opciones seleccionadas, ignorando "todos"');
                riskCheckboxes.forEach((checkbox, index) => {
                    console.log(`🔍 PASO 6.1.2: Checkbox ${index + 1} ID:`, checkbox.id);
                    const option = checkbox.closest('.select-option');
                    const value = option ? option.getAttribute('data-value') : null;
                    console.log(`🔍 PASO 6.1.3: Checkbox ${index + 1} value:`, value);
                    if (value && value !== 'todos') {
                        selectedRisks.push(value);
                        console.log(`🔍 PASO 6.1.4: Agregado a selectedRisks:`, value);
                    }
                });
            } else if (todosSelected && riskCheckboxes.length === 1) {
                console.log('🔍 PASO 6.1.1.3: Solo "todos" está seleccionado, no aplicar filtro');
                // No agregar nada a selectedRisks, significa mostrar todos
            } else {
                console.log('🔍 PASO 6.1.1.4: Aplicando filtros específicos');
                riskCheckboxes.forEach((checkbox, index) => {
                    console.log(`🔍 PASO 6.1.2: Checkbox ${index + 1} ID:`, checkbox.id);
                    const option = checkbox.closest('.select-option');
                    const value = option ? option.getAttribute('data-value') : null;
                    console.log(`🔍 PASO 6.1.3: Checkbox ${index + 1} value:`, value);
                    if (value && value !== 'todos') {
                        selectedRisks.push(value);
                        console.log(`🔍 PASO 6.1.4: Agregado a selectedRisks:`, value);
                    }
                });
            }
            
            // DIAGNÓSTICO ADICIONAL: Verificar si hay checkboxes marcados que no sean "todos"
            console.log('🔍 PASO 6.1.1.5: DIAGNÓSTICO ADICIONAL - Verificando todos los checkboxes...');
            const allRiskCheckboxes = riskSelect.querySelectorAll('input[type="checkbox"]');
            allRiskCheckboxes.forEach((checkbox, index) => {
                console.log(`🔍 PASO 6.1.1.5.${index + 1}: Checkbox ${index + 1} ID: ${checkbox.id}, Checked: ${checkbox.checked}`);
                if (checkbox.checked && checkbox.id !== 'risk-todos') {
                    console.log(`🔍 PASO 6.1.1.5.${index + 1}: ¡ENCONTRADO! Checkbox específico marcado: ${checkbox.id}`);
                    const option = checkbox.closest('.select-option');
                    const value = option ? option.getAttribute('data-value') : null;
                    console.log(`🔍 PASO 6.1.1.5.${index + 1}: Valor del checkbox específico: ${value}`);
                    if (value && value !== 'todos') {
                        selectedRisks.push(value);
                        console.log(`🔍 PASO 6.1.1.5.${index + 1}: Agregado a selectedRisks: ${value}`);
                    }
                }
            });
            console.log('🔍 PASO 6.1.5: selectedRisks final:', selectedRisks);
        } else {
            console.log('❌ PASO 6.1: Risk select no encontrado');
        }
            
            if (categorySelect) {
                const categoryCheckboxes = categorySelect.querySelectorAll('input[type="checkbox"]:checked');
                categoryCheckboxes.forEach(checkbox => {
                    const option = checkbox.closest('.select-option');
                    const value = option ? option.getAttribute('data-value') : null;
                    if (value && value !== 'todos') {
                        selectedCategories.push(value);
                    }
                });
            }
            
            if (domainSelect) {
                const domainCheckboxes = domainSelect.querySelectorAll('input[type="checkbox"]:checked');
                domainCheckboxes.forEach(checkbox => {
                    const option = checkbox.closest('.select-option');
                    const value = option ? option.getAttribute('data-value') : null;
                    if (value && value !== 'todos') {
                        selectedDomains.push(value);
                    }
                });
            }
            
            if (dimensionSelect) {
                const dimensionCheckboxes = dimensionSelect.querySelectorAll('input[type="checkbox"]:checked');
                dimensionCheckboxes.forEach(checkbox => {
                    const option = checkbox.closest('.select-option');
                    const value = option ? option.getAttribute('data-value') : null;
                    if (value && value !== 'todos') {
                        selectedDimensions.push(value);
                    }
                });
            }
            
            console.log('🔍 PASO 7: Filtros seleccionados finales:', {
                risk: selectedRisks,
                category: selectedCategories,
                domain: selectedDomains,
                dimension: selectedDimensions
            });
            
            console.log('🔍 PASO 8: Iniciando procesamiento de filas...');
            let visibleCount = 0;
            
            tableRows.forEach((row, index) => {
                console.log(`🔍 PASO 8.${index + 1}: Procesando fila ${index + 1}`);
                console.log(`🔍 PASO 8.${index + 1}.1: Clases de la fila:`, row.className);
                console.log(`🔍 PASO 8.${index + 1}.2: Contenido de la fila:`, row.textContent.substring(0, 100));
                
                let shouldShow = true;
                
                // Filtrar por nivel de riesgo
                if (selectedRisks.length > 0) {
                    console.log(`🔍 PASO 8.${index + 1}.3: Aplicando filtro de riesgo...`);
                    const riskBadge = row.querySelector('.risk-badge');
                    console.log(`🔍 PASO 8.${index + 1}.3.1: Risk badge encontrado:`, !!riskBadge);
                    if (riskBadge) {
                        const riskLevel = riskBadge.textContent.trim();
                        console.log(`🔍 PASO 8.${index + 1}.3.2: Nivel de riesgo de la fila: "${riskLevel}"`);
                        console.log(`🔍 PASO 8.${index + 1}.3.3: Riesgos seleccionados:`, selectedRisks);
                        console.log(`🔍 PASO 8.${index + 1}.3.4: ¿Incluye el riesgo?`, selectedRisks.includes(riskLevel));
                        if (!selectedRisks.includes(riskLevel)) {
                            shouldShow = false;
                            console.log(`❌ PASO 8.${index + 1}.3.5: Fila ${index + 1} oculta por riesgo`);
                        } else {
                            console.log(`✅ PASO 8.${index + 1}.3.5: Fila ${index + 1} pasa filtro de riesgo`);
                        }
                    } else {
                        console.log(`❌ PASO 8.${index + 1}.3.1: No se encontró risk-badge en la fila`);
                    }
                } else {
                    console.log(`🔍 PASO 8.${index + 1}.3: No hay filtros de riesgo aplicados`);
                }
                
                // Filtrar por categoría
                if (selectedCategories.length > 0) {
                    const categoryCell = row.querySelector('.category-cell span');
                    if (categoryCell) {
                        const categoryText = categoryCell.textContent.trim();
                        console.log(`🔍 Fila ${index + 1} - Categoría: "${categoryText}"`);
                        if (!selectedCategories.includes(categoryText)) {
                            shouldShow = false;
                            console.log(`❌ Fila ${index + 1} oculta por categoría`);
                        }
                    }
                }
                
                // Filtrar por dominio
                if (selectedDomains.length > 0) {
                    const domainCell = row.querySelector('.category-domain-info');
                    if (domainCell) {
                        const domainText = domainCell.textContent.trim();
                        console.log(`🔍 Fila ${index + 1} - Dominio: "${domainText}"`);
                        if (!selectedDomains.includes(domainText)) {
                            shouldShow = false;
                            console.log(`❌ Fila ${index + 1} oculta por dominio`);
                        }
                    }
                }
                
                // Filtrar por dimensión
                if (selectedDimensions.length > 0) {
                    const dimensionCell = row.querySelector('.category-dimension-info');
                    if (dimensionCell) {
                        const dimensionText = dimensionCell.textContent.trim();
                        console.log(`🔍 Fila ${index + 1} - Dimensión: "${dimensionText}"`);
                        if (!selectedDimensions.includes(dimensionText)) {
                            shouldShow = false;
                            console.log(`❌ Fila ${index + 1} oculta por dimensión`);
                        }
                    }
                }
                
                // Mostrar/ocultar fila
                console.log(`🔍 PASO 8.${index + 1}.FINAL: shouldShow = ${shouldShow}`);
                if (shouldShow) {
                    row.style.display = '';
                    visibleCount++;
                    console.log(`✅ PASO 8.${index + 1}.FINAL: Fila ${index + 1} VISIBLE`);
                } else {
                    row.style.display = 'none';
                    console.log(`❌ PASO 8.${index + 1}.FINAL: Fila ${index + 1} OCULTA`);
                }
            });
            
            console.log(`🔍 PASO 9: RESULTADO FINAL - ${visibleCount} filas visibles de ${tableRows.length} totales`);
            console.log('🔍 PASO 9.1: Verificando filas visibles...');
            tableRows.forEach((row, index) => {
                const isVisible = row.style.display !== 'none';
                console.log(`🔍 PASO 9.2: Fila ${index + 1} visible: ${isVisible}`);
            });
        }

        // Función para limpiar filtros de la tabla general
        function clearNewTableFilters() {
            console.log('🧹 ===== LIMPIANDO FILTROS DE TABLA GENERAL =====');
            
            // Limpiar todos los selects
            const selectIds = ['new-risk-select', 'new-category-select', 'new-domain-select', 'new-dimension-select'];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    // Desmarcar todos los checkboxes
                    const checkboxes = select.querySelectorAll('input[type="checkbox"]');
                    checkboxes.forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    
                    // Marcar solo "todos" como seleccionado
                    const todosCheckbox = select.querySelector('input[id$="-todos"]');
                    if (todosCheckbox) {
                        todosCheckbox.checked = true;
                    }
                    
                    // Actualizar el texto del trigger
                    const trigger = select.querySelector('.select-trigger .select-text');
                    if (trigger) {
                        const label = trigger.textContent.split(' ')[0]; // Obtener la primera palabra
                        trigger.textContent = `Seleccionar ${label.toLowerCase()}`;
                    }
                }
            });
            
            // Mostrar todas las filas
            const tableRows = document.querySelectorAll('#new-overview-panel .results-table tbody tr');
            tableRows.forEach(row => {
                row.style.display = '';
            });
            
            console.log(`✅ Filtros limpiados. ${tableRows.length} filas visibles`);
        }

        // Función para obtener valores de checkboxes seleccionados
        function getSelectedCheckboxValues(filterType) {
            const selectId = `new-${filterType}-select`;
            const select = document.getElementById(selectId);
            console.log(`🔍 Buscando select: ${selectId}`, !!select);
            
            if (!select) {
                console.log(`❌ Select no encontrado: ${selectId}`);
                return [];
            }
            
            const checkboxes = select.querySelectorAll('input[type="checkbox"]:checked');
            console.log(`🔍 Checkboxes seleccionados en ${selectId}:`, checkboxes.length);
            
            // Verificar si "todos" está seleccionado
            const todosCheckbox = select.querySelector('input[id$="-todos"]:checked');
            if (todosCheckbox) {
                console.log(`🔍 "Todos" seleccionado para ${filterType}, devolviendo array vacío`);
                return [];
            }
            
            const values = Array.from(checkboxes).map(checkbox => {
                const option = checkbox.closest('.select-option');
                const value = option ? option.getAttribute('data-value') : null;
                console.log(`🔍 Checkbox: ${checkbox.id}, Value: ${value}`);
                return value;
            }).filter(value => value && value !== 'todos');
            
            console.log(`🔍 Valores finales para ${filterType}:`, values);
            return values;
        }

        // FUNCIÓN PARA INICIALIZAR CONTROLES DEL TAB DIMENSIONES
        function initializeDimensionsTableControls() {
            console.log('🚀 ===== INICIANDO CONTROLES DE TABLA DIMENSIONES =====');
            
            // Botón de búsqueda
            const searchBtn = document.getElementById('dimensions-table-search-btn');
            const searchContainer = document.getElementById('dimensions-table-search-container');
            const searchInput = document.getElementById('dimensions-table-search');
            const closeSearchBtn = document.getElementById('dimensions-close-table-search');
            
            if (searchBtn && searchContainer) {
                searchBtn.addEventListener('click', function() {
                    console.log('🔍 Click en botón de búsqueda (dimensiones)');
                    
                    if (searchContainer.style.display === 'none' || searchContainer.style.display === '') {
                        // Mostrar buscador
                        searchContainer.style.display = 'block';
                        searchBtn.style.background = '#e5e7eb';
                        searchBtn.style.color = '#374151';
                        setTimeout(() => {
                            searchInput.focus();
                        }, 100);
                    } else {
                        // Ocultar buscador
                        searchContainer.style.display = 'none';
                        searchBtn.style.background = '#f3f4f6';
                        searchBtn.style.color = '#6b7280';
                        if (searchInput) {
                            searchInput.value = '';
                        }
                    }
                });
            }
            
            if (closeSearchBtn && searchContainer) {
                closeSearchBtn.addEventListener('click', function() {
                    console.log('❌ Cerrando búsqueda (dimensiones)');
                    searchContainer.style.display = 'none';
                    searchBtn.style.background = '#f3f4f6';
                    searchBtn.style.color = '#6b7280';
                    if (searchInput) {
                        searchInput.value = '';
                    }
                });
            }
            
            // Función para buscar dimensiones y dominios
            function searchDimensions() {
                const searchTerm = searchInput.value.toLowerCase().trim();
                console.log('🔍 Buscando término en dimensiones:', searchTerm);
                
                if (searchTerm === '') {
                    // Mostrar todas las filas
                    const allRows = document.querySelectorAll('#new-dimensions-panel .results-table tbody tr');
                    console.log('🔍 Mostrando todas las filas de dimensiones:', allRows.length);
                    allRows.forEach(row => {
                        row.style.display = '';
                    });
                } else {
                    // Filtrar filas
                    const allRows = document.querySelectorAll('#new-dimensions-panel .results-table tbody tr');
                    console.log('🔍 Total de filas de dimensiones encontradas:', allRows.length);
                    
                    allRows.forEach((row, index) => {
                        // Buscar en el span dentro de dimension-header-row (nombre de dimensión)
                        const dimensionSpan = row.querySelector('.dimension-header-row span');
                        // Buscar en dimension-domain-info (nombre de dominio)
                        const domainCell = row.querySelector('.dimension-domain-info');
                        
                        console.log(`🔍 Fila ${index + 1}:`, {
                            hasDimensionSpan: !!dimensionSpan,
                            hasDomainCell: !!domainCell,
                            dimensionText: dimensionSpan ? dimensionSpan.textContent : 'No encontrado',
                            domainText: domainCell ? domainCell.textContent : 'No encontrado'
                        });
                        
                        let matches = false;
                        
                        // Buscar en nombre de dimensión
                        if (dimensionSpan) {
                            const dimensionText = dimensionSpan.textContent.toLowerCase();
                            if (dimensionText.includes(searchTerm)) {
                                matches = true;
                                console.log('✅ Coincidencia en dimensión:', dimensionText);
                            }
                        }
                        
                        // Buscar en nombre de dominio
                        if (domainCell) {
                            const domainText = domainCell.textContent.toLowerCase();
                            if (domainText.includes(searchTerm)) {
                                matches = true;
                                console.log('✅ Coincidencia en dominio:', domainText);
                            }
                        }
                        
                        if (matches) {
                            console.log('✅ Coincidencia encontrada, mostrando fila');
                            row.style.display = '';
                        } else {
                            console.log('❌ No coincide, ocultando fila');
                            row.style.display = 'none';
                        }
                    });
                }
            }
            
            // Función para limpiar búsqueda
            function clearDimensionsSearch() {
                searchInput.value = '';
                searchDimensions();
            }
            
            // Event listeners para búsqueda
            if (searchInput) {
                searchInput.addEventListener('input', searchDimensions);
                searchInput.addEventListener('keyup', function(e) {
                    if (e.key === 'Escape') {
                        searchContainer.style.display = 'none';
                        searchBtn.style.background = '#f3f4f6';
                        searchBtn.style.color = '#6b7280';
                        clearDimensionsSearch();
                    }
                });
            }
            
            // Cerrar buscador al hacer clic fuera
            document.addEventListener('click', function(e) {
                if (searchContainer && searchBtn && 
                    !searchContainer.contains(e.target) && 
                    !searchBtn.contains(e.target) && 
                    searchContainer.style.display === 'block') {
                    searchContainer.style.display = 'none';
                    searchBtn.style.background = '#f3f4f6';
                    searchBtn.style.color = '#6b7280';
                    clearDimensionsSearch();
                }
            });
            
            // Botón de filtros
            const filtersBtn = document.getElementById('dimensions-table-filters-btn');
            const filtersPanel = document.getElementById('dimensions-table-filters-side-panel');
            const filtersBackdrop = document.getElementById('dimensions-filters-backdrop');
            const closeFiltersBtn = document.getElementById('dimensions-close-filters-btn');
            
            if (filtersBtn && filtersPanel) {
                filtersBtn.addEventListener('click', function() {
                    console.log('🔍 Click en botón de filtros (dimensiones)');
                    console.log('🔍 Panel encontrado:', filtersPanel ? 'SÍ' : 'NO');
                    console.log('🔍 Backdrop encontrado:', filtersBackdrop ? 'SÍ' : 'NO');
                    
                    filtersPanel.classList.toggle('show');
                    if (filtersBackdrop) {
                        filtersBackdrop.classList.toggle('show');
                    }
                });
            }
            
            if (closeFiltersBtn && filtersPanel) {
                closeFiltersBtn.addEventListener('click', function() {
                    console.log('❌ Cerrando filtros (dimensiones)');
                    filtersPanel.classList.remove('show');
                    if (filtersBackdrop) {
                        filtersBackdrop.classList.remove('show');
                    }
                });
            }
            
            // Cerrar panel al hacer click en el backdrop
            if (filtersBackdrop) {
                filtersBackdrop.addEventListener('click', function() {
                    console.log('❌ Cerrando filtros desde backdrop (dimensiones)');
                    filtersPanel.classList.remove('show');
                    filtersBackdrop.classList.remove('show');
                });
            }
            
            // Botones de filtros
            const applyFiltersBtn = document.getElementById('dimensions-apply-filters-btn');
            const clearFiltersBtn = document.getElementById('dimensions-clear-filters-btn');
            
            if (applyFiltersBtn) {
                applyFiltersBtn.addEventListener('click', function() {
                    console.log('✅ Aplicando filtros (dimensiones)');
                    applyDimensionsFilters();
                });
            }
            
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', function() {
                    console.log('🧹 Limpiando filtros (dimensiones)');
                    clearDimensionsFilters();
                });
            }
            
            // Configurar selects personalizados para los filtros de dimensiones
            setupDimensionsCustomSelects();
            
            console.log('✅ ===== CONTROLES DE TABLA DIMENSIONES INICIALIZADOS =====');
        }

        // Datos de participantes de ejemplo - EXACTOS DE LA SECCIÓN EMOCIONAL (15 PARTICIPANTES)
        const individualParticipantsData = [
            {
                id: 1,
                name: "María González",
                role: "Gerente de Ventas",
                riskLevel: "muy-alto",
                avatar: "MG",
                avatarColor: "#dc2626",
                details: {
                    age: 35,
                    department: "Ventas",
                    position: "Gerente",
                    gender: "Femenino",
                    maritalStatus: "Casada",
                    country: "Colombia",
                    city: "Bogotá",
                    experience: "8 años",
                    email: "maria.gonzalez@empresa.com",
                    leader: "Ana Martínez"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "Sí" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "Sí" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "Sí" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "Sí" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "Sí" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "Sí" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "Sí" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "Sí" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "Sí" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 85,
                        percentage: 85,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 78,
                        percentage: 78,
                        riskLevel: "Alto",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 65,
                        percentage: 65,
                        riskLevel: "Medio",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 72,
                        percentage: 72,
                        riskLevel: "Alto",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 88,
                        percentage: 88,
                        riskLevel: "Alto",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 92,
                        percentage: 92,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 68,
                        percentage: 68,
                        riskLevel: "Medio",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 95,
                        percentage: 95,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 90,
                        percentage: 90,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 2,
                name: "Carlos Rodríguez",
                role: "Desarrollador Senior",
                riskLevel: "alto",
                avatar: "CR",
                avatarColor: "#c2410c",
                details: {
                    age: 28,
                    department: "Tecnología",
                    position: "Desarrollador",
                    gender: "Masculino",
                    maritalStatus: "Soltero",
                    country: "México",
                    city: "Ciudad de México",
                    experience: "5 años",
                    email: "carlos.rodriguez@empresa.com",
                    leader: "Luis Fernández"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "Sí" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 68,
                        percentage: 68,
                        riskLevel: "Medio",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 55,
                        percentage: 55,
                        riskLevel: "Medio",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 72,
                        percentage: 72,
                        riskLevel: "Alto",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 60,
                        percentage: 60,
                        riskLevel: "Medio",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 3,
                name: "Ana Martínez",
                role: "Analista de Recursos Humanos",
                riskLevel: "medio",
                avatar: "AM",
                avatarColor: "#92400e",
                details: {
                    age: 32,
                    department: "Recursos Humanos",
                    position: "Analista",
                    gender: "Femenino",
                    maritalStatus: "Divorciada",
                    country: "Argentina",
                    city: "Buenos Aires",
                    experience: "6 años",
                    email: "ana.martinez@empresa.com",
                    leader: "María González"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "Sí" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 10,
                        percentage: 10,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 4,
                name: "Luis Fernández",
                role: "Contador",
                riskLevel: "bajo",
                avatar: "LF",
                avatarColor: "#166534",
                details: {
                    age: 45,
                    department: "Finanzas",
                    position: "Contador",
                    gender: "Masculino",
                    maritalStatus: "Casado",
                    country: "Chile",
                    city: "Santiago",
                    experience: "12 años",
                    email: "luis.fernandez@empresa.com",
                    leader: "Carlos Rodríguez"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 10,
                        percentage: 10,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 5,
                        percentage: 5,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 5,
                name: "Sofia Herrera",
                role: "Asistente Administrativa",
                riskLevel: "nulo",
                avatar: "SH",
                avatarColor: "#6b7280",
                details: {
                    age: 26,
                    department: "Administración",
                    position: "Asistente",
                    gender: "Femenino",
                    maritalStatus: "Soltera",
                    country: "Perú",
                    city: "Lima",
                    experience: "3 años",
                    email: "sofia.herrera@empresa.com",
                    leader: "Ana Martínez"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 10,
                        percentage: 10,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 5,
                        percentage: 5,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 5,
                        percentage: 5,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 6,
                name: "Roberto Silva",
                role: "Director de Marketing",
                riskLevel: "bajo",
                avatar: "RS",
                avatarColor: "#166534",
                details: {
                    age: 42,
                    department: "Marketing",
                    position: "Director",
                    gender: "Masculino",
                    maritalStatus: "Casado",
                    country: "España",
                    city: "Madrid",
                    experience: "12 años",
                    email: "roberto.silva@empresa.com",
                    leader: "Luis Fernández"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 10,
                        percentage: 10,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 7,
                name: "Carmen López",
                role: "Diseñadora UX",
                riskLevel: "medio",
                avatar: "CL",
                avatarColor: "#92400e",
                details: {
                    age: 29,
                    department: "Tecnología",
                    position: "Diseñadora",
                    gender: "Femenino",
                    maritalStatus: "Soltera",
                    country: "Uruguay",
                    city: "Montevideo",
                    experience: "4 años",
                    email: "carmen.lopez@empresa.com",
                    leader: "María González"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 55,
                        percentage: 55,
                        riskLevel: "Medio",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 60,
                        percentage: 60,
                        riskLevel: "Medio",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 50,
                        percentage: 50,
                        riskLevel: "Medio",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 65,
                        percentage: 65,
                        riskLevel: "Medio",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 50,
                        percentage: 50,
                        riskLevel: "Medio",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 70,
                        percentage: 70,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 8,
                name: "Diego Morales",
                role: "Analista Financiero",
                riskLevel: "nulo",
                avatar: "DM",
                avatarColor: "#6b7280",
                details: {
                    age: 31,
                    department: "Finanzas",
                    position: "Analista",
                    gender: "Masculino",
                    maritalStatus: "Casado",
                    country: "Ecuador",
                    city: "Quito",
                    experience: "7 años",
                    email: "diego.morales@empresa.com",
                    leader: "Ana Martínez"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 10,
                        percentage: 10,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 5,
                        percentage: 5,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 9,
                name: "Patricia Vega",
                role: "Coordinadora de Proyectos",
                riskLevel: "alto",
                avatar: "PV",
                avatarColor: "#c2410c",
                details: {
                    age: 38,
                    department: "Administración",
                    position: "Coordinadora",
                    gender: "Femenino",
                    maritalStatus: "Divorciada",
                    country: "Venezuela",
                    city: "Caracas",
                    experience: "10 años",
                    email: "patricia.vega@empresa.com",
                    leader: "Luis Fernández"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "Sí" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "Sí" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "Sí" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "Sí" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "Sí" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "Sí" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "Sí" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "Sí" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "Sí" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "Sí" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 75,
                        percentage: 75,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 80,
                        percentage: 80,
                        riskLevel: "Alto",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 70,
                        percentage: 70,
                        riskLevel: "Alto",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 85,
                        percentage: 85,
                        riskLevel: "Alto",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 75,
                        percentage: 75,
                        riskLevel: "Alto",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 60,
                        percentage: 60,
                        riskLevel: "Medio",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 50,
                        percentage: 50,
                        riskLevel: "Medio",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 65,
                        percentage: 65,
                        riskLevel: "Medio",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 85,
                        percentage: 85,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 70,
                        percentage: 70,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 10,
                name: "Fernando Ruiz",
                role: "Especialista en Seguridad",
                riskLevel: "muy-alto",
                avatar: "FR",
                avatarColor: "#dc2626",
                details: {
                    age: 45,
                    department: "Seguridad",
                    position: "Especialista",
                    gender: "Masculino",
                    maritalStatus: "Casado",
                    experience: "15 años",
                    email: "fernando.ruiz@empresa.com",
                    leader: "María González"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "Sí" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "Sí" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "Sí" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "Sí" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "Sí" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "Sí" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "Sí" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "Sí" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "Sí" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "Sí" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "Sí" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "Sí" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "Sí" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "Sí" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 95,
                        percentage: 95,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 90,
                        percentage: 90,
                        riskLevel: "Muy Alto",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 85,
                        percentage: 85,
                        riskLevel: "Alto",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 95,
                        percentage: 95,
                        riskLevel: "Muy Alto",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 98,
                        percentage: 98,
                        riskLevel: "Muy Alto",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 100,
                        percentage: 100,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 60,
                        percentage: 60,
                        riskLevel: "Medio",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 80,
                        percentage: 80,
                        riskLevel: "Alto",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 100,
                        percentage: 100,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 95,
                        percentage: 95,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 11,
                name: "Isabel Torres",
                role: "Supervisora de Producción",
                riskLevel: "medio",
                avatar: "IT",
                avatarColor: "#92400e",
                details: {
                    age: 33,
                    department: "Producción",
                    position: "Supervisora",
                    gender: "Femenino",
                    maritalStatus: "Casada",
                    experience: "9 años",
                    email: "isabel.torres@empresa.com",
                    leader: "Ana Martínez"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "Sí" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 50,
                        percentage: 50,
                        riskLevel: "Medio",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 55,
                        percentage: 55,
                        riskLevel: "Medio",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 60,
                        percentage: 60,
                        riskLevel: "Medio",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 65,
                        percentage: 65,
                        riskLevel: "Medio",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 12,
                name: "Miguel Castro",
                role: "Técnico de Mantenimiento",
                riskLevel: "bajo",
                avatar: "MC",
                avatarColor: "#166534",
                details: {
                    age: 41,
                    department: "Mantenimiento",
                    position: "Técnico",
                    gender: "Masculino",
                    maritalStatus: "Casado",
                    experience: "11 años",
                    email: "miguel.castro@empresa.com",
                    leader: "Luis Fernández"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 50,
                        percentage: 50,
                        riskLevel: "Medio",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 45,
                        percentage: 45,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 55,
                        percentage: 55,
                        riskLevel: "Medio",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 40,
                        percentage: 40,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 13,
                name: "Laura Jiménez",
                role: "Psicóloga Organizacional",
                riskLevel: "nulo",
                avatar: "LJ",
                avatarColor: "#6b7280",
                details: {
                    age: 36,
                    department: "Recursos Humanos",
                    position: "Psicóloga",
                    gender: "Femenino",
                    maritalStatus: "Soltera",
                    experience: "8 años",
                    email: "laura.jimenez@empresa.com",
                    leader: "María González"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 10,
                        percentage: 10,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 5,
                        percentage: 5,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 5,
                        percentage: 5,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 14,
                name: "Andrés Mendoza",
                role: "Gerente de Ventas",
                riskLevel: "alto",
                avatar: "AM",
                avatarColor: "#c2410c",
                details: {
                    age: 44,
                    department: "Ventas",
                    position: "Gerente",
                    gender: "Masculino",
                    maritalStatus: "Casado",
                    experience: "13 años",
                    email: "andres.mendoza@empresa.com",
                    leader: "Ana Martínez"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "Sí" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "Sí" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "Sí" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "Sí" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "Sí" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "Sí" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "Sí" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "Sí" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "Sí" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "Sí" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 80,
                        percentage: 80,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 85,
                        percentage: 85,
                        riskLevel: "Alto",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 75,
                        percentage: 75,
                        riskLevel: "Alto",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 90,
                        percentage: 90,
                        riskLevel: "Alto",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 80,
                        percentage: 80,
                        riskLevel: "Alto",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 70,
                        percentage: 70,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 60,
                        percentage: 60,
                        riskLevel: "Medio",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 75,
                        percentage: 75,
                        riskLevel: "Alto",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 95,
                        percentage: 95,
                        riskLevel: "Muy Alto",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 85,
                        percentage: 85,
                        riskLevel: "Alto",
                        domain: "Ambiente de trabajo"
                    }
                }
            },
            {
                id: 15,
                name: "Valentina Herrera",
                role: "Desarrolladora Frontend",
                riskLevel: "bajo",
                avatar: "VH",
                avatarColor: "#166534",
                details: {
                    age: 27,
                    department: "Tecnología",
                    position: "Desarrolladora",
                    gender: "Femenino",
                    maritalStatus: "Soltera",
                    experience: "3 años",
                    email: "valentina.herrera@empresa.com",
                    leader: "Luis Fernández"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                },
                dimensionsResults: {
                    "Condiciones en el ambiente de trabajo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Carga de trabajo": {
                        score: 30,
                        percentage: 30,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Falta de control sobre el trabajo": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Autonomía"
                    },
                    "Jornadas de trabajo excesivas": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Organización del tiempo"
                    },
                    "Trabajo que exige alto nivel de atención": {
                        score: 35,
                        percentage: 35,
                        riskLevel: "Bajo",
                        domain: "Carga mental"
                    },
                    "Actividades laborales que implican riesgo": {
                        score: 15,
                        percentage: 15,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Falta de capacitación e información sobre el trabajo": {
                        score: 20,
                        percentage: 20,
                        riskLevel: "Bajo",
                        domain: "Desarrollo"
                    },
                    "Supervisión inadecuada": {
                        score: 25,
                        percentage: 25,
                        riskLevel: "Bajo",
                        domain: "Liderazgo"
                    },
                    "Violencia laboral": {
                        score: 10,
                        percentage: 10,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    },
                    "Acoso laboral": {
                        score: 5,
                        percentage: 5,
                        riskLevel: "Bajo",
                        domain: "Ambiente de trabajo"
                    }
                }
            }
        ];

        // Función para inicializar el Segment Control
        function initializeSegmentControl() {
            console.log('🎛️ ===== INICIALIZANDO SEGMENT CONTROL =====');
            
            const segmentOptions = document.querySelectorAll('.segment-option');
            const dimensionsContent = document.getElementById('dimensions-content');
            const individualContent = document.getElementById('individual-content');
            
            console.log('🔍 Segment options encontrados:', segmentOptions.length);
            console.log('🔍 Dimensions content encontrado:', dimensionsContent ? 'SÍ' : 'NO');
            console.log('🔍 Individual content encontrado:', individualContent ? 'SÍ' : 'NO');
            
            // Asegurar que el contenido de dimensiones esté visible por defecto
            if (dimensionsContent) {
                dimensionsContent.style.display = 'block';
                console.log('✅ Contenido de dimensiones mostrado por defecto');
            }
            if (individualContent) {
                individualContent.style.display = 'none';
                console.log('✅ Contenido individual oculto por defecto');
            }
            
            segmentOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const segment = this.getAttribute('data-segment');
                    console.log('🔄 Cambiando a segmento:', segment);
                    
                    // Remover clase active de todos los botones
                    segmentOptions.forEach(btn => {
                        btn.classList.remove('active');
                        btn.style.background = 'transparent';
                        btn.style.color = 'var(--ubits-fg-1-medium)';
                        btn.style.boxShadow = 'none';
                    });
                    
                    // Activar el botón seleccionado
                    this.classList.add('active');
                    this.style.background = 'var(--ubits-bg-1)';
                    this.style.color = 'var(--ubits-fg-1-high)';
                    this.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
                    
                    // Mostrar/ocultar contenido según el segmento
                    if (segment === 'dimensions') {
                        if (dimensionsContent) {
                            dimensionsContent.style.display = 'block';
                        }
                        if (individualContent) {
                            individualContent.style.display = 'none';
                        }
                        console.log('✅ Mostrando contenido de dimensiones');
                    } else if (segment === 'individual') {
                        if (dimensionsContent) {
                            dimensionsContent.style.display = 'none';
                        }
                        if (individualContent) {
                            individualContent.style.display = 'block';
                        }
                        console.log('✅ Mostrando contenido individual');
                    }
                });
            });
            
            console.log('✅ ===== SEGMENT CONTROL INICIALIZADO =====');
        }

        // Función para inicializar el Panel Individual
        function initializeIndividualUsersPanel() {
            console.log('👥 ===== INICIALIZANDO PANEL INDIVIDUAL =====');
            
            // Renderizar lista de participantes
            renderIndividualParticipantsList();
            
            // Configurar búsqueda
            setupIndividualSearch();
            
            // Configurar filtros
            setupIndividualFilters();
            
            // Seleccionar automáticamente el primer participante
            if (individualParticipantsData.length > 0) {
                selectIndividualParticipant(individualParticipantsData[0].id);
            }
            
            console.log('✅ ===== PANEL INDIVIDUAL INICIALIZADO =====');
        }

        // Renderizar lista de participantes
        function renderIndividualParticipantsList(participants = individualParticipantsData) {
            console.log('🔍 ===== INICIANDO RENDERIZADO INDIVIDUAL =====');
            console.log('🔍 Participantes recibidos:', participants.length);
            console.log('🔍 Nombres de participantes:', participants.map(p => p.name));
            
            const participantsList = document.getElementById('individual-participants-list');
            if (!participantsList) {
                console.error('❌ No se encontró el elemento individual-participants-list');
                return;
            }
            
            participantsList.innerHTML = '';
            
            participants.forEach(participant => {
                const participantItem = document.createElement('div');
                participantItem.className = 'participant-item';
                participantItem.dataset.participantId = participant.id;
                
                const riskBadgeClass = getRiskBadgeClass(participant.riskLevel);
                const riskBadgeText = getRiskBadgeText(participant.riskLevel);
                
                participantItem.innerHTML = `
                    <div class="participant-avatar" style="background-color: ${participant.avatarColor}">
                        ${participant.avatar}
                    </div>
                    <div class="participant-info-content">
                        <div class="participant-name">${participant.name}</div>
                        <div class="participant-role">${participant.role}</div>
                    </div>
                    <div class="risk-level">
                        <span class="risk-badge ${participant.riskLevel}">${participant.riskLevel.replace('-', ' ').toUpperCase()}</span>
                    </div>
                `;
                
                participantItem.addEventListener('click', () => {
                    selectIndividualParticipant(participant.id);
                });
                
                participantsList.appendChild(participantItem);
            });
            
            console.log('✅ ===== RENDERIZADO INDIVIDUAL COMPLETADO =====');
        }

        // Seleccionar participante
        function selectIndividualParticipant(participantId) {
            console.log('👆 ===== SELECCIONANDO PARTICIPANTE INDIVIDUAL =====');
            console.log('🔍 ID del participante:', participantId);
            
            // Remover selección anterior
            document.querySelectorAll('#individual-participants-list .participant-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Agregar selección al nuevo participante
            const selectedItem = document.querySelector(`#individual-participants-list .participant-item[data-participant-id="${participantId}"]`);
            if (selectedItem) {
                selectedItem.classList.add('selected');
            }
            
            // Mostrar detalles del participante
            showIndividualParticipantDetails(participantId);
        }

        // Mostrar detalles del participante
        function showIndividualParticipantDetails(participantId) {
            console.log('👤 ===== MOSTRANDO DETALLES INDIVIDUAL =====');
            console.log('🔍 ID del participante:', participantId);
            
            const participant = individualParticipantsData.find(p => p.id === participantId);
            if (!participant) {
                console.error('❌ Participante no encontrado:', participantId);
                return;
            }
            
            const participantDetails = document.getElementById('individual-participant-details');
            if (!participantDetails) {
                console.error('❌ No se encontró el elemento individual-participant-details');
                return;
            }
            
            // Mostrar información del participante con estructura corregida
            participantDetails.innerHTML = `
                <div class="participant-details show">
                    <div class="participant-header">
                        <div class="participant-avatar-large" style="background-color: ${participant.avatarColor}">
                            ${participant.avatar}
                        </div>
                        <div class="participant-details-content">
                            <div class="participant-info-line">
                                <span class="participant-name">${participant.name}</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-role">${participant.role}</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-department">${participant.details.department}</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-age">${participant.details.age} años</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-gender">${participant.details.gender}</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-status">${participant.details.maritalStatus}</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-country">${participant.details.country}</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-city">${participant.details.city}</span>
                                <span class="participant-separator">•</span>
                                <span class="participant-experience">${participant.details.experience} de experiencia</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <div class="dimensions-table-container">
                            <table class="dimensions-table">
                                <thead>
                                    <tr>
                                        <th>Dimensión</th>
                                        <th>Dominio</th>
                                        <th>Puntuación</th>
                                        <th>Porcentaje</th>
                                        <th>Nivel de Riesgo</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${Object.entries(participant.dimensionsResults || {}).map(([dimension, data]) => `
                                        <tr>
                                            <td class="dimension-name">${dimension}</td>
                                            <td class="dimension-domain">${data.domain}</td>
                                            <td class="dimension-score">${data.score}</td>
                                            <td class="dimension-percentage">${data.percentage}%</td>
                                            <td class="dimension-risk">
                                                <span class="risk-badge ${data.riskLevel.toLowerCase()}">${data.riskLevel}</span>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
        }

        // Configurar búsqueda
        function setupIndividualSearch() {
            const searchInput = document.getElementById('individual-participant-search');
            if (!searchInput) return;
            
            searchInput.addEventListener('input', function(e) {
                const searchValue = e.target.value.toLowerCase();
                console.log('🔍 Búsqueda individual:', searchValue);
                
                const filteredParticipants = individualParticipantsData.filter(participant => 
                    participant.name.toLowerCase().includes(searchValue) ||
                    participant.role.toLowerCase().includes(searchValue) ||
                    participant.details.department.toLowerCase().includes(searchValue)
                );
                
                renderIndividualParticipantsList(filteredParticipants);
            });
        }

        // Configurar filtros para sección Individual en Dimensiones
        function setupIndividualFilters() {
            console.log('🔧 ===== CONFIGURANDO FILTROS INDIVIDUALES EN DIMENSIONES =====');
            
            const filtersBtn = document.getElementById('individual-filters-btn');
            const filtersPanel = document.getElementById('individual-filters-side-panel');
            const closeBtn = document.getElementById('individual-close-filters-btn');
            const backdrop = document.getElementById('individual-filters-backdrop');
            const applyBtn = document.getElementById('individual-apply-filters-btn');
            const clearBtn = document.getElementById('individual-clear-filters-btn');
            
            console.log('🔧 Elementos encontrados:');
            console.log('🔧 Botón filtros:', !!filtersBtn, filtersBtn);
            console.log('🔧 Panel filtros:', !!filtersPanel, filtersPanel);
            console.log('🔧 Botón cerrar:', !!closeBtn, closeBtn);
            console.log('🔧 Backdrop:', !!backdrop, backdrop);
            console.log('🔧 Botón aplicar:', !!applyBtn, applyBtn);
            console.log('🔧 Botón limpiar:', !!clearBtn, clearBtn);
            
            // Verificar si los elementos existen
            if (!filtersBtn) {
                console.error('❌ ERROR: No se encontró el botón de filtros individual-filters-btn');
                return;
            }
            if (!filtersPanel) {
                console.error('❌ ERROR: No se encontró el panel de filtros individual-filters-side-panel');
                return;
            }
            
            // Configurar botón de filtros
            if (filtersBtn && filtersPanel) {
                console.log('🔧 Configurando botón de filtros individuales');
                console.log('🔧 Botón antes del evento:', filtersBtn);
                console.log('🔧 Panel antes del evento:', filtersPanel);
                console.log('🔧 Clases del panel antes:', filtersPanel.classList.toString());
                
                filtersBtn.addEventListener('click', function(e) {
                    console.log('🔧 ===== CLICK EN BOTÓN DE FILTROS INDIVIDUALES DETECTADO =====');
                    console.log('🔧 Evento:', e);
                    console.log('🔧 Target:', e.target);
                    console.log('🔧 CurrentTarget:', e.currentTarget);
                    
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('🔧 Panel antes de agregar show:', filtersPanel);
                    console.log('🔧 Clases del panel antes:', filtersPanel.classList.toString());
                    console.log('🔧 Estilo del panel antes:', filtersPanel.style.display);
                    
                    filtersPanel.classList.add('show');
                    
                    console.log('🔧 Panel después de agregar show:', filtersPanel);
                    console.log('🔧 Clases del panel después:', filtersPanel.classList.toString());
                    console.log('🔧 Estilo del panel después:', filtersPanel.style.display);
                    
                    if (backdrop) {
                        console.log('🔧 Backdrop antes:', backdrop);
                        console.log('🔧 Clases del backdrop antes:', backdrop.classList.toString());
                        backdrop.classList.add('show');
                        console.log('🔧 Backdrop después:', backdrop);
                        console.log('🔧 Clases del backdrop después:', backdrop.classList.toString());
                    }
                    
                    document.body.style.overflow = 'hidden';
                    console.log('🔧 Body overflow configurado a hidden');
                    
                    console.log('🔧 ===== FIN DEL CLICK EN BOTÓN DE FILTROS INDIVIDUALES =====');
                });
                
                console.log('🔧 Event listener agregado al botón de filtros individuales');
            } else {
                console.error('❌ ERROR: No se pudo configurar el botón de filtros individuales');
                console.error('❌ filtersBtn:', filtersBtn);
                console.error('❌ filtersPanel:', filtersPanel);
            }
            
            if (closeBtn && filtersPanel) {
                console.log('🔧 Configurando botón de cerrar filtros individuales');
                closeBtn.addEventListener('click', function() {
                    console.log('🔧 Click en botón de cerrar filtros individuales');
                    console.log('🔧 Panel antes:', filtersPanel.classList.toString());
                    console.log('🔧 Backdrop antes:', backdrop ? backdrop.classList.toString() : 'No encontrado');
                    
                    filtersPanel.classList.remove('show');
                    if (backdrop) backdrop.classList.remove('show');
                    
                    console.log('🔧 Panel después:', filtersPanel.classList.toString());
                    console.log('🔧 Backdrop después:', backdrop ? backdrop.classList.toString() : 'No encontrado');
                });
            }
            
            if (backdrop) {
                console.log('🔧 Configurando backdrop de filtros individuales');
                backdrop.addEventListener('click', function() {
                    console.log('🔧 Click en backdrop de filtros individuales');
                    console.log('🔧 Panel antes:', filtersPanel.classList.toString());
                    console.log('🔧 Backdrop antes:', backdrop.classList.toString());
                    
                    filtersPanel.classList.remove('show');
                    backdrop.classList.remove('show');
                    
                    console.log('🔧 Panel después:', filtersPanel.classList.toString());
                    console.log('🔧 Backdrop después:', backdrop.classList.toString());
                });
            }
            
            if (applyBtn) {
                console.log('🔧 Configurando botón de aplicar filtros individuales');
                applyBtn.addEventListener('click', function() {
                    console.log('🔧 Click en botón de aplicar filtros individuales');
                    applyIndividualFilters();
                    console.log('🔧 Aplicando filtros individuales...');
                    filtersPanel.classList.remove('show');
                    if (backdrop) backdrop.classList.remove('show');
                    console.log('🔧 Panel y backdrop cerrados después de aplicar');
                });
            }
            
            if (clearBtn) {
                console.log('🔧 Configurando botón de limpiar filtros individuales');
                clearBtn.addEventListener('click', function() {
                    console.log('🔧 Click en botón de limpiar filtros individuales');
                    clearIndividualFilters();
                    console.log('🔧 Limpiando filtros individuales...');
                });
            }
            
            console.log('✅ ===== FILTROS INDIVIDUALES EN DIMENSIONES CONFIGURADOS =====');
        }

        function setupIndividualCustomSelects() {
            console.log('🔧 ===== INICIANDO SETUP DE CUSTOM SELECTS INDIVIDUALES =====');
            const customSelects = document.querySelectorAll('#individual-filters-side-panel .custom-select');
            console.log('🔧 Selects individuales encontrados:', customSelects.length);
            
            customSelects.forEach((select, index) => {
                console.log(`🔧 Configurando select individual ${index + 1}:`, select.id);
                const trigger = select.querySelector('.select-trigger');
                const dropdown = select.querySelector('.select-dropdown');
                const options = select.querySelectorAll('.select-option');
                
                console.log(`🔧 Select individual ${index + 1} elementos:`, {
                    trigger: !!trigger,
                    dropdown: !!dropdown,
                    options: options.length
                });
                
                if (trigger && dropdown) {
                    // Toggle dropdown
                    trigger.addEventListener('click', (e) => {
                        e.stopPropagation();
                        console.log(`🔧 Click en trigger del select individual ${select.id}`);
                        
                        // Cerrar otros selects
                        customSelects.forEach(otherSelect => {
                            if (otherSelect !== select) {
                                const otherTrigger = otherSelect.querySelector('.select-trigger');
                                const otherDropdown = otherSelect.querySelector('.select-dropdown');
                                otherTrigger.classList.remove('active');
                                otherDropdown.classList.remove('show');
                                console.log(`🔧 Cerrando select individual: ${otherSelect.id}`);
                            }
                        });
                        
                        // Toggle current dropdown
                        const wasActive = trigger.classList.contains('active');
                        const wasShow = dropdown.classList.contains('show');
                        trigger.classList.toggle('active');
                        dropdown.classList.toggle('show');
                        console.log(`🔧 Select individual ${select.id} toggle:`, {
                            wasActive: wasActive,
                            isActive: trigger.classList.contains('active'),
                            wasShow: wasShow,
                            isShow: dropdown.classList.contains('show')
                        });
                    });
                    
                    // Manejar clics en opciones
                    options.forEach(option => {
                        const checkbox = option.querySelector('input[type="checkbox"]');
                        
                        option.addEventListener('click', (e) => {
                            e.stopPropagation();
                            if (checkbox) {
                                checkbox.checked = !checkbox.checked;
                                updateIndividualSelectTexts();
                            }
                        });
                    });
                }
            });
        }

        function updateIndividualSelectTexts() {
            const customSelects = document.querySelectorAll('#individual-filters-side-panel .custom-select');
            
            customSelects.forEach(select => {
                const selectText = select.querySelector('.select-text');
                const checkboxes = select.querySelectorAll('input[type="checkbox"]:checked');
                
                if (checkboxes.length === 0) {
                    selectText.textContent = selectText.dataset.placeholder || 'Seleccionar...';
                } else if (checkboxes.length === 1) {
                    const option = checkboxes[0].closest('.select-option');
                    selectText.textContent = option.querySelector('span').textContent;
                } else {
                    selectText.textContent = `${checkboxes.length} seleccionados`;
                }
            });
        }

        function applyIndividualFilters() {
            console.log('🔍 ===== APLICANDO FILTROS INDIVIDUALES =====');
            
            // Obtener valores de los selects simples
            const riskFilter = document.getElementById('individual-risk-select');
            const areaFilter = document.getElementById('individual-area-select');
            const positionFilter = document.getElementById('individual-position-select');
            const genderFilter = document.getElementById('individual-gender-select');
            const maritalFilter = document.getElementById('individual-marital-select');
            const ageFilter = document.getElementById('individual-age-select');
            const countryFilter = document.getElementById('individual-country-select');
            const cityFilter = document.getElementById('individual-city-select');
            const leaderFilter = document.getElementById('individual-leader-select');
            
            const searchInput = document.getElementById('individual-participant-search');
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            
            // Obtener todos los participantes de la tabla
            const allRows = document.querySelectorAll('#new-individual-panel tbody tr');
            let visibleCount = 0;
            
            allRows.forEach(row => {
                const participantName = row.querySelector('.participant-name');
                const participantRole = row.querySelector('.participant-role');
                const riskBadge = row.querySelector('.risk-badge');
                
                if (!participantName || !participantRole || !riskBadge) return;
                
                let shouldShow = true;
                
                // Filtro por búsqueda
                if (searchTerm) {
                    const name = participantName.textContent.toLowerCase();
                    const role = participantRole.textContent.toLowerCase();
                    if (!name.includes(searchTerm) && !role.includes(searchTerm)) {
                        shouldShow = false;
                    }
                }
                
                // Filtro por nivel de riesgo
                if (riskFilter && riskFilter.value !== 'todos') {
                    const riskLevel = riskBadge.textContent.toLowerCase().replace(' ', '-');
                    if (riskLevel !== riskFilter.value) {
                        shouldShow = false;
                    }
                }
                
                // Filtros demográficos (simulados)
                if (shouldShow && (areaFilter || positionFilter || genderFilter || maritalFilter || ageFilter || countryFilter || cityFilter || leaderFilter)) {
                    // Simular datos demográficos para el participante
                    const participantIndex = Array.from(allRows).indexOf(row);
                    const simulatedData = getSimulatedDemographicDataForIndividual(participantName.textContent, participantIndex);
                    
                    if (areaFilter && areaFilter.value !== 'todos' && simulatedData.area !== areaFilter.value) {
                        shouldShow = false;
                    }
                    if (positionFilter && positionFilter.value !== 'todos' && simulatedData.position !== positionFilter.value) {
                        shouldShow = false;
                    }
                    if (genderFilter && genderFilter.value !== 'todos' && simulatedData.gender !== genderFilter.value) {
                        shouldShow = false;
                    }
                    if (maritalFilter && maritalFilter.value !== 'todos' && simulatedData.maritalStatus !== maritalFilter.value) {
                        shouldShow = false;
                    }
                    if (ageFilter && ageFilter.value !== 'todos' && simulatedData.ageRange !== ageFilter.value) {
                        shouldShow = false;
                    }
                    if (countryFilter && countryFilter.value !== 'todos' && simulatedData.country !== countryFilter.value) {
                        shouldShow = false;
                    }
                    if (cityFilter && cityFilter.value !== 'todos' && simulatedData.city !== cityFilter.value) {
                        shouldShow = false;
                    }
                    if (leaderFilter && leaderFilter.value !== 'todos' && simulatedData.leader !== leaderFilter.value) {
                        shouldShow = false;
                    }
                }
                
                if (shouldShow) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            console.log('🔍 Participantes visibles:', visibleCount);
            updateIndividualFilterBadge();
        }

        // Función para simular datos demográficos para filtros individuales
        function getSimulatedDemographicDataForIndividual(participantName, index) {
            const areas = ['Tecnología', 'Recursos Humanos', 'Ventas', 'Marketing', 'Finanzas', 'Operaciones'];
            const positions = ['Gerente', 'Desarrollador', 'Analista', 'Contador', 'Asistente', 'Director', 'Diseñador', 'Coordinador', 'Especialista', 'Supervisor', 'Técnico', 'Psicólogo'];
            const genders = ['Masculino', 'Femenino'];
            const maritalStatuses = ['Soltero', 'Casado', 'Divorciado', 'Viudo'];
            const countries = ['Colombia', 'México', 'Argentina', 'Chile', 'Perú', 'España', 'Estados Unidos'];
            const cities = ['Bogotá', 'Medellín', 'Cali', 'Barranquilla', 'Cartagena', 'Ciudad de México', 'Buenos Aires', 'Santiago', 'Lima', 'Madrid', 'Nueva York'];
            const leaders = ['Ana García', 'Carlos López', 'María Rodríguez', 'Juan Pérez', 'Laura Martínez', 'Pedro González', 'Sofia Hernández', 'Diego Torres', 'Carmen Silva', 'Roberto Díaz'];
            const ageRanges = ['18-25', '26-35', '36-45', '46-55', '56-65', '65+'];
            
            // Usar el nombre y el índice para generar datos consistentes
            const seed = participantName.length + index;
            const random = (seed * 9301 + 49297) % 233280;
            
            return {
                area: areas[random % areas.length],
                position: positions[random % positions.length],
                gender: genders[random % genders.length],
                maritalStatus: maritalStatuses[random % maritalStatuses.length],
                ageRange: ageRanges[random % ageRanges.length],
                country: countries[random % countries.length],
                city: cities[random % cities.length],
                leader: leaders[random % leaders.length]
            };
        }

        function clearIndividualFilters() {
            console.log('🔍 ===== LIMPIANDO FILTROS INDIVIDUALES =====');
            
            // Limpiar búsqueda
            const searchInput = document.getElementById('individual-participant-search');
            if (searchInput) {
                searchInput.value = '';
            }
            
            // Limpiar todos los selects
            const selectIds = [
                'individual-risk-select',
                'individual-area-select',
                'individual-position-select',
                'individual-gender-select',
                'individual-marital-select',
                'individual-age-select',
                'individual-country-select',
                'individual-city-select',
                'individual-leader-select'
            ];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.value = 'todos';
                }
            });
            
            // Actualizar textos de los selects
            updateIndividualSelectTexts();
            
            // Renderizar lista completa
            renderIndividualParticipantsList(individualParticipantsData);
            updateIndividualFilterBadge();
        }

        function updateIndividualSelectTexts() {
            const selectIds = [
                'individual-risk-select',
                'individual-area-select',
                'individual-position-select',
                'individual-gender-select',
                'individual-marital-select',
                'individual-age-select',
                'individual-country-select',
                'individual-city-select',
                'individual-leader-select'
            ];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    // Para selects simples, no necesitamos actualizar texto
                    // El texto se actualiza automáticamente con el valor seleccionado
                }
            });
        }

        function updateIndividualFilterBadge() {
            const badge = document.getElementById('individual-filter-badge');
            if (!badge) return;
            
            let activeFilters = 0;
            
            // Contar filtros activos
            const selectIds = [
                'individual-risk-select',
                'individual-area-select',
                'individual-position-select',
                'individual-gender-select',
                'individual-marital-select',
                'individual-age-select',
                'individual-country-select',
                'individual-city-select',
                'individual-leader-select'
            ];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select && select.value !== 'todos') {
                    activeFilters++;
                }
            });
            
            // Verificar búsqueda
            const searchInput = document.getElementById('individual-participant-search');
            if (searchInput && searchInput.value.trim() !== '') {
                activeFilters++;
            }
            
            if (activeFilters > 0) {
                badge.textContent = activeFilters;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        // Funciones auxiliares
        function getRiskBadgeClass(riskLevel) {
            const riskClasses = {
                'nulo': 'bajo',
                'bajo': 'bajo',
                'medio': 'medio',
                'alto': 'alto',
                'muy-alto': 'muy-alto'
            };
            return riskClasses[riskLevel] || 'bajo';
        }

        function getRiskBadgeText(riskLevel) {
            const riskTexts = {
                'nulo': 'NULO',
                'bajo': 'BAJO',
                'medio': 'MEDIO',
                'alto': 'ALTO',
                'muy-alto': 'MUY ALTO'
            };
            return riskTexts[riskLevel] || 'BAJO';
        }

        function getIndividualSectionRiskLevel(score) {
            if (score >= 90) return 'nulo';
            if (score >= 70) return 'bajo';
            if (score >= 50) return 'medio';
            if (score >= 30) return 'alto';
            return 'muy-alto';
        }

        function toggleIndividualSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (!section) return;
            
            const isExpanded = section.classList.contains('expanded');
            if (isExpanded) {
                section.classList.remove('expanded');
                section.style.maxHeight = '60px';
            } else {
                section.classList.add('expanded');
                section.style.maxHeight = 'none';
            }
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 ===== INICIANDO CARGA DE PÁGINA =====');
            console.log('📅 DOM cargado completamente');
            console.log('🔍 Verificando elementos críticos...');
            
            // Inicializar Segment Control
            initializeSegmentControl();
            
            // Inicializar Panel Individual
            initializeIndividualUsersPanel();
            
            // Verificar que el panel de dimensiones existe desde el inicio
            const dimensionPanel = document.getElementById('dimension-panel');
            console.log('🔍 Panel dimension-panel encontrado:', dimensionPanel ? 'SÍ' : 'NO');
            if (dimensionPanel) {
                console.log('🔍 Panel dimension-panel visible:', dimensionPanel.style.display !== 'none');
                console.log('🔍 Panel dimension-panel clases:', dimensionPanel.className);
            }
            
            // Verificar que el contenido simple existe desde el inicio
            const simpleContent = document.querySelector('#dimension-panel div[style*="padding: 40px"]');
            console.log('🔍 Contenido simple encontrado desde inicio:', simpleContent ? 'SÍ' : 'NO');
            if (simpleContent) {
                console.log('🔍 Contenido simple visible:', simpleContent.offsetParent !== null);
            }
            
            // Cargar componentes
            setTimeout(() => {
                console.log('🔍 Cargando sidebar...');
                loadSidebar('encuestas');
                console.log('🔍 Sidebar cargado, verificando...');
                const sidebar = document.getElementById('sidebar-container');
                console.log('🔍 Sidebar encontrado:', sidebar ? 'SÍ' : 'NO');
                if (sidebar) {
                    console.log('🔍 Contenido del sidebar:', sidebar.innerHTML.length > 0 ? 'SÍ tiene contenido' : 'NO tiene contenido');
                    console.log('🔍 Clases del sidebar:', sidebar.className);
                }
                loadProfileMenu('profile-menu-container');
                loadFloatingMenu('floating-menu-container');
                console.log('🔍 Inicializando tabs...');
                initializeTabs();
                
                // Inicializar los nuevos tabs
                console.log('🔍 Inicializando nuevos tabs...');
                initializeNewTabs();
                
                // Inicializar filtros con delay para asegurar que las funciones estén definidas
                setTimeout(() => {
                    if (typeof initializeTableFilters === 'function') {
                initializeTableFilters();
                    }
                    // Inicializar filtros de dimensiones
                    if (typeof initializeDimensionsFilters === 'function') {
                        initializeDimensionsFilters();
                    }
                }, 100);
                
                // Event listener directo para cargar dimensiones
                const loadDimensionBtn = document.getElementById('load-dimension-btn');
                if (loadDimensionBtn) {
                    loadDimensionBtn.addEventListener('click', function() {
                        console.log('Botón de cargar dimensiones clickeado');
                        loadDimensionResults();
                    });
                }
                
                
                // Prueba inmediata de tabs
                console.log('=== PRUEBA DE TABS ===');
                const allTabs = ['general', 'dimension', 'individual'];
                allTabs.forEach(tab => {
                    const button = document.querySelector(`[data-tab="${tab}"]`);
                    const panel = document.getElementById(`${tab}-panel`);
                    console.log(`Tab ${tab}:`, {
                        button: button ? 'encontrado' : 'NO ENCONTRADO',
                        panel: panel ? 'encontrado' : 'NO ENCONTRADO',
                        buttonActive: button ? button.classList.contains('active') : false,
                        panelActive: panel ? panel.classList.contains('active') : false
                    });
                });
                console.log('=== FIN PRUEBA ===');
                console.log('🔍 toggleCategoryRow después de initializeTabs:', typeof toggleCategoryRow);
                
                // Verificar si toggleCategoryRow está disponible al final
                console.log('🔍 toggleCategoryRow disponible al final:', typeof toggleCategoryRow);
                
                // Verificar estado final del tab de dimensiones
                console.log('🔍 ===== VERIFICACIÓN FINAL DEL TAB DE DIMENSIONES =====');
                const finalDimensionPanel = document.getElementById('dimension-panel');
                console.log('🔍 Panel dimension-panel al final:', finalDimensionPanel ? 'SÍ' : 'NO');
                if (finalDimensionPanel) {
                    console.log('🔍 Panel dimension-panel visible al final:', finalDimensionPanel.style.display !== 'none');
                    const finalSimpleContent = finalDimensionPanel.querySelector('div[style*="padding: 40px"]');
                    console.log('🔍 Contenido simple al final:', finalSimpleContent ? 'SÍ' : 'NO');
                    if (finalSimpleContent) {
                        const finalTitle = finalSimpleContent.querySelector('h2');
                        console.log('🔍 Título al final:', finalTitle ? finalTitle.textContent : 'NO ENCONTRADO');
                    }
                }
                console.log('🔍 ===== FIN VERIFICACIÓN FINAL =====');
                
                // Abrir la primera categoría por defecto
                const firstCategoryRow = document.querySelector('.category-summary');
                if (firstCategoryRow) {
                    // toggleCategoryRow(firstCategoryRow); // Comentado temporalmente para debug
                }
            }, 200);
        });
    </script>

    <!-- Panel de Filtros -->
    <div class="filters-panel" id="filters-panel">
        <div class="filters-header">
            <h3>Filtros</h3>
            <button class="close-filters-btn" id="close-filters-btn">
                <i class="far fa-times"></i>
            </button>
        </div>
        <div class="filters-content">
            <!-- Filtro por Nivel de Riesgo -->
            <div class="filter-group">
                <label class="filter-label">Nivel de Riesgo</label>
                <select class="filter-select" id="risk-filter">
                    <option value="">Todos</option>
                    <option value="Alto">Alto</option>
                    <option value="Medio">Medio</option>
                    <option value="Bajo">Bajo</option>
                </select>
            </div>

            <!-- Filtro por Categoría -->
            <div class="filter-group">
                <label class="filter-label">Categoría</label>
                <select class="filter-select" id="category-filter">
                    <option value="">Todas</option>
                    <option value="Ambiente de trabajo">Ambiente de trabajo</option>
                    <option value="Factores propios de la actividad">Factores propios de la actividad</option>
                    <option value="Organización del tiempo de trabajo">Organización del tiempo de trabajo</option>
                    <option value="Liderazgo y relaciones en el trabajo">Liderazgo y relaciones en el trabajo</option>
                    <option value="Violencia laboral">Violencia laboral</option>
                </select>
            </div>

            <!-- Filtro por Dominio -->
            <div class="filter-group">
                <label class="filter-label">Dominio</label>
                <select class="filter-select" id="domain-filter">
                    <option value="">Todos</option>
                    <option value="Condiciones en el ambiente de trabajo">Condiciones en el ambiente de trabajo</option>
                    <option value="Carga de trabajo">Carga de trabajo</option>
                    <option value="Falta de control sobre el trabajo">Falta de control sobre el trabajo</option>
                    <option value="Jornada de trabajo">Jornada de trabajo</option>
                    <option value="Liderazgo">Liderazgo</option>
                    <option value="Relaciones en el trabajo">Relaciones en el trabajo</option>
                    <option value="Violencia laboral">Violencia laboral</option>
                </select>
            </div>

            <!-- Filtros Demográficos -->
            <div class="filter-group">
                <label class="filter-label">Área</label>
                <select class="filter-select" id="area-filter">
                    <option value="">Todas</option>
                    <option value="Tecnología">Tecnología</option>
                    <option value="Recursos Humanos">Recursos Humanos</option>
                    <option value="Ventas">Ventas</option>
                    <option value="Marketing">Marketing</option>
                    <option value="Finanzas">Finanzas</option>
                    <option value="Operaciones">Operaciones</option>
                </select>
            </div>

            <div class="filter-group">
                <label class="filter-label">Cargo</label>
                <select class="filter-select" id="position-filter">
                    <option value="">Todos</option>
                    <option value="Gerente">Gerente</option>
                    <option value="Desarrollador">Desarrollador</option>
                    <option value="Analista">Analista</option>
                    <option value="Contador">Contador</option>
                    <option value="Asistente">Asistente</option>
                    <option value="Director">Director</option>
                    <option value="Diseñador">Diseñador</option>
                    <option value="Coordinador">Coordinador</option>
                    <option value="Especialista">Especialista</option>
                    <option value="Supervisor">Supervisor</option>
                    <option value="Técnico">Técnico</option>
                    <option value="Psicólogo">Psicólogo</option>
                </select>
            </div>

            <div class="filter-group">
                <label class="filter-label">Sexo</label>
                <select class="filter-select" id="gender-filter">
                    <option value="">Todos</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Femenino">Femenino</option>
                </select>
            </div>

            <div class="filter-group">
                <label class="filter-label">Estado Civil</label>
                <select class="filter-select" id="marital-filter">
                    <option value="">Todos</option>
                    <option value="Soltero">Soltero</option>
                    <option value="Soltera">Soltera</option>
                    <option value="Casado">Casado</option>
                    <option value="Casada">Casada</option>
                    <option value="Divorciado">Divorciado</option>
                    <option value="Divorciada">Divorciada</option>
                </select>
            </div>

            <div class="filter-group">
                <label class="filter-label">Edad</label>
                <select class="filter-select" id="age-filter">
                    <option value="">Todas</option>
                    <option value="18-25">18-25 años</option>
                    <option value="26-35">26-35 años</option>
                    <option value="36-45">36-45 años</option>
                    <option value="46-55">46-55 años</option>
                    <option value="56+">56+ años</option>
                </select>
            </div>

            <div class="filter-group">
                <label class="filter-label">País</label>
                <select class="filter-select" id="country-filter">
                    <option value="">Todos</option>
                    <option value="Colombia">Colombia</option>
                    <option value="México">México</option>
                    <option value="Argentina">Argentina</option>
                    <option value="Chile">Chile</option>
                    <option value="Perú">Perú</option>
                    <option value="España">España</option>
                    <option value="Uruguay">Uruguay</option>
                    <option value="Ecuador">Ecuador</option>
                    <option value="Venezuela">Venezuela</option>
                </select>
            </div>

            <div class="filter-group">
                <label class="filter-label">Ciudad</label>
                <select class="filter-select" id="city-filter">
                    <option value="">Todas</option>
                    <option value="Bogotá">Bogotá</option>
                    <option value="Ciudad de México">Ciudad de México</option>
                    <option value="Buenos Aires">Buenos Aires</option>
                    <option value="Santiago">Santiago</option>
                    <option value="Lima">Lima</option>
                    <option value="Madrid">Madrid</option>
                    <option value="Montevideo">Montevideo</option>
                    <option value="Quito">Quito</option>
                    <option value="Caracas">Caracas</option>
                </select>
            </div>

            <div class="filter-group">
                <label class="filter-label">Líder</label>
                <select class="filter-select" id="leader-filter">
                    <option value="">Todos</option>
                    <option value="Ana Martínez">Ana Martínez</option>
                    <option value="Luis Fernández">Luis Fernández</option>
                    <option value="María González">María González</option>
                    <option value="Carlos Rodríguez">Carlos Rodríguez</option>
                </select>
            </div>
        </div>
        <div class="filters-actions">
            <button id="apply-filters-btn" class="ubits-button ubits-button--primary ubits-button--md" style="flex: 1;">
                <i class="far fa-check"></i>
                <span>Aplicar</span>
            </button>
            <button id="clear-filters-btn" class="ubits-button ubits-button--secondary ubits-button--md" style="flex: 1;">
                <i class="far fa-times"></i>
                <span>Limpiar</span>
            </button>
        </div>
    </div>

    <!-- Backdrop para el panel de filtros -->
    <div class="filters-backdrop" id="filters-backdrop"></div>

    <!-- JavaScript para funcionalidad de acordeón de la nueva tabla -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ===== SISTEMA DE FILTROS COMPLETAMENTE NUEVO =====
            
            // Elementos del panel de filtros
            const filtersBtn = document.getElementById('table-filters-btn');
            const filtersPanel = document.getElementById('filters-panel');
            const filtersBackdrop = document.getElementById('filters-backdrop');
            const closeFiltersBtn = document.getElementById('close-filters-btn');
            const applyFiltersBtn = document.getElementById('apply-filters-btn');
            const clearFiltersBtn = document.getElementById('clear-filters-btn');
            
            // Filtros básicos
            const riskFilter = document.getElementById('risk-filter');
            const categoryFilter = document.getElementById('category-filter');
            const domainFilter = document.getElementById('domain-filter');
            
            // Filtros demográficos
            const areaFilter = document.getElementById('area-filter');
            const positionFilter = document.getElementById('position-filter');
            const genderFilter = document.getElementById('gender-filter');
            const maritalFilter = document.getElementById('marital-filter');
            const ageFilter = document.getElementById('age-filter');
            const countryFilter = document.getElementById('country-filter');
            const cityFilter = document.getElementById('city-filter');
            const leaderFilter = document.getElementById('leader-filter');
            
            // Abrir panel de filtros
            if (filtersBtn && filtersPanel && filtersBackdrop) {
                filtersBtn.addEventListener('click', function() {
                    filtersPanel.classList.add('show');
                    filtersBackdrop.classList.add('show');
                });
            }
            
            // Cerrar panel de filtros
            function closeFiltersPanel() {
                filtersPanel.classList.remove('show');
                filtersBackdrop.classList.remove('show');
            }
            
            if (closeFiltersBtn) {
                closeFiltersBtn.addEventListener('click', closeFiltersPanel);
            }
            
            if (filtersBackdrop) {
                filtersBackdrop.addEventListener('click', closeFiltersPanel);
            }
            
            // Aplicar filtros
            if (applyFiltersBtn) {
                applyFiltersBtn.addEventListener('click', function() {
                    applyFilters();
                    closeFiltersPanel();
                });
            }
            
            // Limpiar filtros
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', function() {
                    clearFilters();
                    applyFilters();
                });
            }
            
            // Función para aplicar filtros
            function applyFilters() {
                console.log('🔧 Aplicando filtros...');
                
                // Filtros básicos
                const selectedRisk = riskFilter ? riskFilter.value : '';
                const selectedCategory = categoryFilter ? categoryFilter.value : '';
                const selectedDomain = domainFilter ? domainFilter.value : '';
                
                // Filtros demográficos
                const selectedArea = areaFilter ? areaFilter.value : '';
                const selectedPosition = positionFilter ? positionFilter.value : '';
                const selectedGender = genderFilter ? genderFilter.value : '';
                const selectedMarital = maritalFilter ? maritalFilter.value : '';
                const selectedAge = ageFilter ? ageFilter.value : '';
                const selectedCountry = countryFilter ? countryFilter.value : '';
                const selectedCity = cityFilter ? cityFilter.value : '';
                const selectedLeader = leaderFilter ? leaderFilter.value : '';
                
                console.log('🔧 Filtros seleccionados:', {
                    risk: selectedRisk,
                    category: selectedCategory,
                    domain: selectedDomain,
                    area: selectedArea,
                    position: selectedPosition,
                    gender: selectedGender,
                    marital: selectedMarital,
                    age: selectedAge,
                    country: selectedCountry,
                    city: selectedCity,
                    leader: selectedLeader
                });
                
                // Obtener todas las filas de categoría
                const categoryRows = document.querySelectorAll('.results-table tbody tr.category-summary');
                console.log('🔧 Filas de categoría encontradas:', categoryRows.length);
                
                let visibleCount = 0;
                
                categoryRows.forEach((row, index) => {
                    const categoryText = row.querySelector('.category-cell')?.textContent || '';
                    const domainText = row.querySelector('.category-domain-info')?.textContent || '';
                    const riskBadge = row.querySelector('.risk-badge');
                    const riskLevel = riskBadge ? riskBadge.textContent.trim() : '';
                    
                    // Simular datos demográficos para esta categoría
                    const simulatedData = getSimulatedDemographicData(categoryText, index);
                    
                    console.log(`🔧 Fila ${index}:`, {
                        category: categoryText,
                        domain: domainText,
                        risk: riskLevel,
                        demographic: simulatedData
                    });
                    
                    // Aplicar filtros básicos
                    let shouldShow = true;
                    
                    if (selectedRisk && riskLevel !== selectedRisk) {
                        shouldShow = false;
                    }
                    
                    if (selectedCategory && !categoryText.includes(selectedCategory)) {
                        shouldShow = false;
                    }
                    
                    if (selectedDomain && !domainText.includes(selectedDomain)) {
                        shouldShow = false;
                    }
                    
                    // Los filtros demográficos NO ocultan categorías, solo afectan los datos mostrados
                    // Se aplicarán después para actualizar los números y datos
                    
                    console.log(`🔧 Fila ${index} - Mostrar:`, shouldShow);
                    
                    if (shouldShow) {
                        row.style.display = '';
                        visibleCount++;
                        
                        // Si la categoría está abierta, también mostrar sus filas de detalle
                        const isOpen = row.classList.contains('open');
                        if (isOpen) {
                            let nextRow = row.nextElementSibling;
                            while (nextRow && nextRow.classList.contains('category-detail')) {
                                nextRow.style.display = '';
                                nextRow = nextRow.nextElementSibling;
                            }
                        }
                    } else {
                        row.style.display = 'none';
                        
                        // Ocultar todas las filas de detalle de esta categoría
                        let nextRow = row.nextElementSibling;
                        while (nextRow && nextRow.classList.contains('category-detail')) {
                            nextRow.style.display = 'none';
                            nextRow = nextRow.nextElementSibling;
                        }
                    }
                });
                
                console.log('🔧 Resultado:', `${visibleCount} de ${categoryRows.length} filas visibles`);
                
                // Actualizar datos demográficos en las categorías visibles
                updateDemographicData(selectedArea, selectedPosition, selectedGender, selectedMarital, selectedAge, selectedCountry, selectedCity, selectedLeader);
                
                // Actualizar badge de filtros
                updateFilterBadge();
            }
            
            // Función para limpiar filtros
            function clearFilters() {
                console.log('🧹 Limpiando filtros...');
                
                // Limpiar filtros básicos
                if (riskFilter) riskFilter.value = '';
                if (categoryFilter) categoryFilter.value = '';
                if (domainFilter) domainFilter.value = '';
                
                // Limpiar filtros demográficos
                if (areaFilter) areaFilter.value = '';
                if (positionFilter) positionFilter.value = '';
                if (genderFilter) genderFilter.value = '';
                if (maritalFilter) maritalFilter.value = '';
                if (ageFilter) ageFilter.value = '';
                if (countryFilter) countryFilter.value = '';
                if (cityFilter) cityFilter.value = '';
                if (leaderFilter) leaderFilter.value = '';
                
                console.log('✅ Filtros limpiados');
                
                // Ocultar badge de filtros
                hideFilterBadge();
            }
            
            // Función para actualizar badge de filtros
            function updateFilterBadge() {
                const badge = document.getElementById('filter-badge');
                if (!badge) return;
                
                let activeFiltersCount = 0;
                
                // Contar filtros básicos activos
                if (riskFilter && riskFilter.value) activeFiltersCount++;
                if (categoryFilter && categoryFilter.value) activeFiltersCount++;
                if (domainFilter && domainFilter.value) activeFiltersCount++;
                
                // Contar filtros demográficos activos
                if (areaFilter && areaFilter.value) activeFiltersCount++;
                if (positionFilter && positionFilter.value) activeFiltersCount++;
                if (genderFilter && genderFilter.value) activeFiltersCount++;
                if (maritalFilter && maritalFilter.value) activeFiltersCount++;
                if (ageFilter && ageFilter.value) activeFiltersCount++;
                if (countryFilter && countryFilter.value) activeFiltersCount++;
                if (cityFilter && cityFilter.value) activeFiltersCount++;
                if (leaderFilter && leaderFilter.value) activeFiltersCount++;
                
                console.log('🔢 Filtros activos:', activeFiltersCount);
                
                if (activeFiltersCount > 0) {
                    badge.textContent = activeFiltersCount.toString();
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
            
            // Función para ocultar badge de filtros
            function hideFilterBadge() {
                const badge = document.getElementById('filter-badge');
                if (badge) {
                    badge.style.display = 'none';
                }
            }
            
            // Función para simular datos demográficos
            function getSimulatedDemographicData(categoryText, index) {
                const areas = ['Tecnología', 'Recursos Humanos', 'Ventas', 'Marketing', 'Finanzas', 'Operaciones'];
                const positions = ['Gerente', 'Desarrollador', 'Analista', 'Contador', 'Asistente', 'Director', 'Diseñador', 'Coordinador', 'Especialista', 'Supervisor', 'Técnico', 'Psicólogo'];
                const genders = ['Masculino', 'Femenino'];
                const maritalStatuses = ['Soltero', 'Soltera', 'Casado', 'Casada', 'Divorciado', 'Divorciada'];
                const countries = ['Colombia', 'México', 'Argentina', 'Chile', 'Perú', 'España', 'Uruguay', 'Ecuador', 'Venezuela'];
                const cities = ['Bogotá', 'Ciudad de México', 'Buenos Aires', 'Santiago', 'Lima', 'Madrid', 'Montevideo', 'Quito', 'Caracas'];
                const leaders = ['Ana Martínez', 'Luis Fernández', 'María González', 'Carlos Rodríguez'];
                const ages = [25, 30, 35, 40, 45, 50, 55, 60];
                
                // Usar el índice para generar datos consistentes
                const seed = index * 7 + categoryText.length;
                
                return {
                    area: areas[seed % areas.length],
                    position: positions[seed % positions.length],
                    gender: genders[seed % genders.length],
                    maritalStatus: maritalStatuses[seed % maritalStatuses.length],
                    age: ages[seed % ages.length],
                    country: countries[seed % countries.length],
                    city: cities[seed % cities.length],
                    leader: leaders[seed % leaders.length]
                };
            }
            
            // Función para verificar rango de edad
            function matchesAgeRange(age, ageRange) {
                switch (ageRange) {
                    case '18-25': return age >= 18 && age <= 25;
                    case '26-35': return age >= 26 && age <= 35;
                    case '36-45': return age >= 36 && age <= 45;
                    case '46-55': return age >= 46 && age <= 55;
                    case '56+': return age >= 56;
                    default: return true;
                }
            }
            
            // Función para actualizar datos demográficos en las categorías
            function updateDemographicData(area, position, gender, marital, age, country, city, leader) {
                console.log('📊 Actualizando datos demográficos...');
                
                const categoryRows = document.querySelectorAll('.results-table tbody tr.category-summary');
                
                categoryRows.forEach((row, index) => {
                    if (row.style.display !== 'none') {
                        const categoryText = row.querySelector('.category-cell')?.textContent || '';
                        const simulatedData = getSimulatedDemographicData(categoryText, index);
                        
                        // Verificar si esta categoría coincide con los filtros demográficos
                        let matchesDemographics = true;
                        
                        if (area && simulatedData.area !== area) matchesDemographics = false;
                        if (position && simulatedData.position !== position) matchesDemographics = false;
                        if (gender && simulatedData.gender !== gender) matchesDemographics = false;
                        if (marital && simulatedData.maritalStatus !== marital) matchesDemographics = false;
                        if (age && !matchesAgeRange(simulatedData.age, age)) matchesDemographics = false;
                        if (country && simulatedData.country !== country) matchesDemographics = false;
                        if (city && simulatedData.city !== city) matchesDemographics = false;
                        if (leader && simulatedData.leader !== leader) matchesDemographics = false;
                        
                        // Actualizar números basándose en filtros demográficos
                        const riskCountCell = row.querySelector('.risk-count');
                        const percentageCell = row.querySelector('.percentage');
                        
                        if (riskCountCell && percentageCell) {
                            if (matchesDemographics) {
                                // Si coincide con filtros demográficos, mostrar números normales
                                riskCountCell.textContent = '12';
                                percentageCell.textContent = '80%';
                                riskCountCell.style.color = '';
                                percentageCell.style.color = '';
                            } else {
                                // Si no coincide, mostrar números filtrados (menores)
                                const filteredCount = Math.floor(Math.random() * 5) + 1; // 1-5 usuarios
                                const filteredPercentage = Math.floor(Math.random() * 30) + 20; // 20-50%
                                
                                riskCountCell.textContent = filteredCount.toString();
                                percentageCell.textContent = filteredPercentage + '%';
                                riskCountCell.style.color = '#6b7280'; // Gris para indicar datos filtrados
                                percentageCell.style.color = '#6b7280';
                            }
                        }
                        
                        console.log(`📊 Categoría ${index}:`, {
                            category: categoryText,
                            matches: matchesDemographics,
                            data: simulatedData
                        });
                    }
                });
                
                console.log('✅ Datos demográficos actualizados');
            }
            
            // ===== FIN SISTEMA DE FILTROS =====
            // Función para alternar la visibilidad de las filas de detalle
            function toggleCategoryDetails(categoryRow) {
                const categoryName = categoryRow.querySelector('td:first-child').textContent.trim();
                const nextRows = [];
                let currentRow = categoryRow.nextElementSibling;
                
                // Recopilar todas las filas de detalle que pertenecen a esta categoría
                while (currentRow && currentRow.classList.contains('category-detail')) {
                    nextRows.push(currentRow);
                    currentRow = currentRow.nextElementSibling;
                }
                
                // Alternar visibilidad
                const isVisible = nextRows[0] && nextRows[0].style.display !== 'none';
                nextRows.forEach(row => {
                    row.style.display = isVisible ? 'none' : 'table-row';
                });
                
                // Cambiar el icono del acordeón
                const accordionIcon = categoryRow.querySelector('.accordion-icon');
                if (accordionIcon) {
                    accordionIcon.style.transform = isVisible ? 'rotate(0deg)' : 'rotate(90deg)';
                }
                
                // Agregar o quitar clase active
                if (isVisible) {
                    categoryRow.classList.remove('active');
                } else {
                    categoryRow.classList.add('active');
                }
            }
            
            // Agregar iconos de acordeón a las filas de categoría
            const categoryRows = document.querySelectorAll('.category-summary');
            categoryRows.forEach(row => {
                const lastCell = row.querySelector('td:last-child');
                if (lastCell && !lastCell.querySelector('.accordion-icon')) {
                    const accordionIcon = document.createElement('i');
                    accordionIcon.className = 'far fa-chevron-right accordion-icon';
                    accordionIcon.style.cssText = 'margin-left: 20px; transition: transform 0.2s ease; cursor: pointer;';
                    lastCell.appendChild(accordionIcon);
                    
                    // Hacer la fila clickeable
                    row.style.cursor = 'pointer';
                    row.addEventListener('click', function() {
                        toggleCategoryDetails(this);
                    });
                }
            });
            
            // Inicializar con todas las categorías cerradas excepto la primera
            const detailRows = document.querySelectorAll('.category-detail');
            detailRows.forEach((row, index) => {
                // Abrir solo las filas de detalle de la primera categoría
                const isFirstCategory = index < 2; // Las primeras 2 filas de detalle pertenecen a la primera categoría
                row.style.display = isFirstCategory ? 'table-row' : 'none';
            });
            
            // Marcar la primera categoría como activa
            const firstCategoryRow = document.querySelector('.category-summary');
            if (firstCategoryRow) {
                firstCategoryRow.classList.add('active');
                const accordionIcon = firstCategoryRow.querySelector('.accordion-icon');
                if (accordionIcon) {
                    accordionIcon.style.transform = 'rotate(90deg)';
                }
            }
        });
    </script>

    <!-- Script para generar respuestas automáticas para las 72 preguntas -->
    <script>
        // Función para generar respuestas aleatorias
        function generateRandomResponse() {
            const responses = [
                { text: 'Siempre', class: 'siempre' },
                { text: 'Casi siempre', class: 'casi-siempre' },
                { text: 'Algunas veces', class: 'algunas-veces' },
                { text: 'Casi nunca', class: 'casi-nunca' },
                { text: 'Nunca', class: 'nunca' }
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Función para generar respuestas para un participante
        function generateParticipantResponses() {
            let html = '';
            for (let i = 0; i < 72; i++) {
                const response = generateRandomResponse();
                html += `
                    <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                        <div class="response-with-dot">
                            <div class="response-dot ${response.class}"></div>
                            <span>${response.text}</span>
                        </div>
                    </td>
                `;
            }
            return html;
        }

        // Función para actualizar todas las filas de participantes
        function updateAllParticipantRows() {
            const participantRows = document.querySelectorAll('#new-individual-panel tbody tr');
            participantRows.forEach((row, index) => {
                // Mantener las primeras 3 celdas (Participante, Nivel de Riesgo, Porcentaje)
                const firstThreeCells = row.querySelectorAll('td').slice(0, 3);
                
                // Generar nuevas respuestas para las 72 preguntas
                const newResponses = generateParticipantResponses();
                
                // Limpiar la fila y agregar las celdas
                row.innerHTML = '';
                firstThreeCells.forEach(cell => row.appendChild(cell));
                
                // Agregar las nuevas respuestas
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = newResponses;
                while (tempDiv.firstChild) {
                    row.appendChild(tempDiv.firstChild);
                }
            });
        }

        // Datos de todos los participantes (copiados del archivo emocional)
        const allParticipants = [
            {
                id: 1,
                name: "María González",
                role: "Gerente de Ventas",
                riskLevel: "muy-alto",
                avatar: "MG",
                avatarColor: "#dc2626"
            },
            {
                id: 2,
                name: "Carlos Rodríguez",
                role: "Desarrollador Senior",
                riskLevel: "alto",
                avatar: "CR",
                avatarColor: "#c2410c"
            },
            {
                id: 3,
                name: "Ana Martínez",
                role: "Analista de Recursos Humanos",
                riskLevel: "medio",
                avatar: "AM",
                avatarColor: "#92400e"
            },
            {
                id: 4,
                name: "Luis Fernández",
                role: "Contador",
                riskLevel: "bajo",
                avatar: "LF",
                avatarColor: "#166534"
            },
            {
                id: 5,
                name: "Sofia Herrera",
                role: "Asistente Administrativa",
                riskLevel: "nulo",
                avatar: "SH",
                avatarColor: "#6b7280"
            },
            {
                id: 6,
                name: "Roberto Silva",
                role: "Director de Marketing",
                riskLevel: "bajo",
                avatar: "RS",
                avatarColor: "#166534"
            },
            {
                id: 7,
                name: "Carmen López",
                role: "Diseñadora UX",
                riskLevel: "medio",
                avatar: "CL",
                avatarColor: "#92400e"
            },
            {
                id: 8,
                name: "Diego Morales",
                role: "Analista Financiero",
                riskLevel: "nulo",
                avatar: "DM",
                avatarColor: "#6b7280"
            },
            {
                id: 9,
                name: "Patricia Vega",
                role: "Coordinadora de Proyectos",
                riskLevel: "alto",
                avatar: "PV",
                avatarColor: "#c2410c"
            },
            {
                id: 10,
                name: "Fernando Ruiz",
                role: "Especialista en Seguridad",
                riskLevel: "muy-alto",
                avatar: "FR",
                avatarColor: "#dc2626"
            },
            {
                id: 11,
                name: "Isabel Torres",
                role: "Supervisora de Producción",
                riskLevel: "medio",
                avatar: "IT",
                avatarColor: "#92400e"
            },
            {
                id: 12,
                name: "Miguel Castro",
                role: "Técnico de Mantenimiento",
                riskLevel: "bajo",
                avatar: "MC",
                avatarColor: "#166534"
            },
            {
                id: 13,
                name: "Laura Jiménez",
                role: "Psicóloga Organizacional",
                riskLevel: "nulo",
                avatar: "LJ",
                avatarColor: "#6b7280"
            },
            {
                id: 14,
                name: "Andrés Mendoza",
                role: "Gerente de Ventas",
                riskLevel: "alto",
                avatar: "AM",
                avatarColor: "#c2410c"
            },
            {
                id: 15,
                name: "Valentina Herrera",
                role: "Desarrolladora Frontend",
                riskLevel: "bajo",
                avatar: "VH",
                avatarColor: "#166534"
            }
        ];

        // Función para generar el HTML de una fila de participante
        function generateParticipantRow(participant) {
            const riskLevelText = participant.riskLevel.replace('-', ' ').toUpperCase();
            const percentage = Math.floor(Math.random() * 100) + 1; // Porcentaje aleatorio
            
            return `
                <tr style="background: white;">
                    <td style="position: sticky; left: 0; background: white; border-bottom: 1px solid #e5e7eb; padding: 12px; font-weight: 600; color: #374151; z-index: 1;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div class="participant-avatar" style="background: ${participant.avatarColor};">
                                ${participant.avatar}
                            </div>
                            <div class="participant-info-content">
                                <div class="participant-name">${participant.name}</div>
                                <div class="participant-role">${participant.role}</div>
                            </div>
                        </div>
                    </td>
                    <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center;">
                        <span class="risk-badge ${participant.riskLevel}">${riskLevelText}</span>
                    </td>
                    <td style="border-bottom: 1px solid #e5e7eb; padding: 12px; text-align: center; font-weight: 600; color: #374151;">${percentage}%</td>
                    ${generateParticipantResponses()}
                </tr>
            `;
        }

        // Función para actualizar la tabla con todos los participantes
        function updateTableWithAllParticipants() {
            const tbody = document.querySelector('#new-individual-panel tbody');
            if (!tbody) {
                console.log('No se encontró el tbody de la tabla individual');
                return;
            }

            // Limpiar el tbody
            tbody.innerHTML = '';

            // Agregar todas las filas de participantes
            allParticipants.forEach(participant => {
                const rowHTML = generateParticipantRow(participant);
                tbody.insertAdjacentHTML('beforeend', rowHTML);
            });

            console.log(`✅ Tabla actualizada con ${allParticipants.length} participantes`);
        }

        // Función para buscar participantes
        function searchParticipants() {
            const searchInput = document.getElementById('individual-search');
            const clearButton = document.getElementById('clear-individual-search');
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                // Mostrar todos los participantes
                const allRows = document.querySelectorAll('#new-individual-panel tbody tr');
                allRows.forEach(row => {
                    row.style.display = '';
                });
                clearButton.style.display = 'none';
            } else {
                // Filtrar participantes
                const allRows = document.querySelectorAll('#new-individual-panel tbody tr');
                let visibleCount = 0;
                
                allRows.forEach(row => {
                    const participantName = row.querySelector('.participant-name');
                    const participantRole = row.querySelector('.participant-role');
                    
                    if (participantName && participantRole) {
                        const name = participantName.textContent.toLowerCase();
                        const role = participantRole.textContent.toLowerCase();
                        
                        if (name.includes(searchTerm) || role.includes(searchTerm)) {
                            row.style.display = '';
                            visibleCount++;
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
                
                // Mostrar/ocultar botón de limpiar
                clearButton.style.display = searchTerm ? 'flex' : 'none';
            }
        }

        // Función para limpiar búsqueda
        function clearIndividualSearch() {
            const searchInput = document.getElementById('individual-search');
            const clearButton = document.getElementById('clear-individual-search');
            
            searchInput.value = '';
            clearButton.style.display = 'none';
            searchParticipants();
        }

        // Función para mostrar/ocultar buscador
        function toggleIndividualSearch() {
            const searchBtn = document.getElementById('individual-search-btn');
            const searchContainer = document.getElementById('individual-search-container');
            const searchInput = document.getElementById('individual-search');
            
            if (searchContainer.style.display === 'none' || searchContainer.style.display === '') {
                // Mostrar buscador
                searchContainer.style.display = 'block';
                searchBtn.style.background = '#e5e7eb';
                searchBtn.style.color = '#374151';
                setTimeout(() => {
                    searchInput.focus();
                }, 100);
            } else {
                // Ocultar buscador
                searchContainer.style.display = 'none';
                searchBtn.style.background = '#f3f4f6';
                searchBtn.style.color = '#6b7280';
                clearIndividualSearch();
            }
        }

        // Configurar filtros para la tabla principal individual
        function setupMainIndividualFilters() {
            console.log('🔧 ===== CONFIGURANDO FILTROS PRINCIPALES INDIVIDUALES =====');
            
            const filtersBtn = document.getElementById('main-individual-filters-btn');
            const filtersPanel = document.getElementById('individual-filters-side-panel');
            const closeBtn = document.getElementById('individual-close-filters-btn');
            const backdrop = document.getElementById('individual-filters-backdrop');
            const applyBtn = document.getElementById('individual-apply-filters-btn');
            const clearBtn = document.getElementById('individual-clear-filters-btn');
            
            console.log('🔧 Elementos encontrados:');
            console.log('🔧 Botón filtros:', !!filtersBtn, filtersBtn);
            console.log('🔧 Panel filtros:', !!filtersPanel, filtersPanel);
            console.log('🔧 Botón cerrar:', !!closeBtn, closeBtn);
            console.log('🔧 Backdrop:', !!backdrop, backdrop);
            console.log('🔧 Botón aplicar:', !!applyBtn, applyBtn);
            console.log('🔧 Botón limpiar:', !!clearBtn, clearBtn);
            
            // Verificar si los elementos existen
            if (!filtersBtn) {
                console.error('❌ ERROR: No se encontró el botón de filtros individual-filters-btn');
                return;
            }
            if (!filtersPanel) {
                console.error('❌ ERROR: No se encontró el panel de filtros individual-filters-side-panel');
                return;
            }
            
            // Configurar botón de filtros
            if (filtersBtn && filtersPanel) {
                console.log('🔧 Configurando botón de filtros principales');
                console.log('🔧 Botón antes del evento:', filtersBtn);
                console.log('🔧 Panel antes del evento:', filtersPanel);
                console.log('🔧 Clases del panel antes:', filtersPanel.classList.toString());
                
                filtersBtn.addEventListener('click', function(e) {
                    console.log('🔧 ===== CLICK EN BOTÓN DE FILTROS DETECTADO =====');
                    console.log('🔧 Evento:', e);
                    console.log('🔧 Target:', e.target);
                    console.log('🔧 CurrentTarget:', e.currentTarget);
                    
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('🔧 Panel antes de agregar show:', filtersPanel);
                    console.log('🔧 Clases del panel antes:', filtersPanel.classList.toString());
                    console.log('🔧 Estilo del panel antes:', filtersPanel.style.display);
                    
                    filtersPanel.classList.add('show');
                    
                    console.log('🔧 Panel después de agregar show:', filtersPanel);
                    console.log('🔧 Clases del panel después:', filtersPanel.classList.toString());
                    console.log('🔧 Estilo del panel después:', filtersPanel.style.display);
                    
                    if (backdrop) {
                        console.log('🔧 Backdrop antes:', backdrop);
                        console.log('🔧 Clases del backdrop antes:', backdrop.classList.toString());
                        backdrop.classList.add('show');
                        console.log('🔧 Backdrop después:', backdrop);
                        console.log('🔧 Clases del backdrop después:', backdrop.classList.toString());
                    }
                    
                    document.body.style.overflow = 'hidden';
                    console.log('🔧 Body overflow configurado a hidden');
                    
                    console.log('🔧 ===== FIN DEL CLICK EN BOTÓN DE FILTROS =====');
                });
                
                console.log('🔧 Event listener agregado al botón de filtros');
            } else {
                console.error('❌ ERROR: No se pudo configurar el botón de filtros');
                console.error('❌ filtersBtn:', filtersBtn);
                console.error('❌ filtersPanel:', filtersPanel);
            }
            
            // Configurar botón de cerrar
            if (closeBtn && filtersPanel) {
                console.log('🔧 Configurando botón de cerrar filtros principales');
                closeBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🔧 Click en botón de cerrar filtros principales');
                    filtersPanel.classList.remove('show');
                    if (backdrop) backdrop.classList.remove('show');
                    document.body.style.overflow = '';
                });
            }
            
            // Configurar backdrop
            if (backdrop && filtersPanel) {
                console.log('🔧 Configurando backdrop de filtros principales');
                backdrop.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🔧 Click en backdrop de filtros principales');
                    filtersPanel.classList.remove('show');
                    backdrop.classList.remove('show');
                    document.body.style.overflow = '';
                });
            }
            
            // Configurar botón aplicar
            if (applyBtn) {
                console.log('🔧 Configurando botón aplicar filtros principales');
                applyBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🔧 Click en botón aplicar filtros principales');
                    applyIndividualFilters();
                });
            }
            
            // Configurar botón limpiar
            if (clearBtn) {
                console.log('🔧 Configurando botón limpiar filtros principales');
                clearBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🔧 Click en botón limpiar filtros principales');
                    clearIndividualFilters();
                });
            }
            
            console.log('✅ ===== FILTROS PRINCIPALES INDIVIDUALES CONFIGURADOS =====');
        }

        // Configurar filtros para participantes
        function setupParticipantsFilters() {
            const filtersBtn = document.getElementById('individual-filters-btn');
            const filtersPanel = document.getElementById('participants-filters-panel');
            const closeBtn = document.getElementById('participants-close-filters-btn');
            const backdrop = document.getElementById('participants-filters-backdrop');
            const applyBtn = document.getElementById('participants-apply-filters-btn');
            const clearBtn = document.getElementById('participants-clear-filters-btn');
            const filterBadge = document.getElementById('individual-filter-badge');
            
            if (!filtersBtn || !filtersPanel) return;
            
            // Abrir panel
            filtersBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                filtersPanel.classList.add('show');
                if (backdrop) backdrop.classList.add('show');
                document.body.style.overflow = 'hidden';
            });
            
            // Cerrar panel
            function closePanel() {
                filtersPanel.classList.remove('show');
                if (backdrop) backdrop.classList.remove('show');
                document.body.style.overflow = '';
            }
            
            if (closeBtn) closeBtn.addEventListener('click', closePanel);
            if (backdrop) backdrop.addEventListener('click', closePanel);
            
            // Aplicar filtros
            if (applyBtn) {
                applyBtn.addEventListener('click', function() {
                    applyParticipantsFilters();
                    closePanel();
                });
            }
            
            // Limpiar filtros
            if (clearBtn) {
                clearBtn.addEventListener('click', function() {
                    clearParticipantsFilters();
                });
            }
        }
        
        // Aplicar filtros de participantes
        function applyParticipantsFilters() {
            const riskFilter = document.getElementById('participants-risk-filter').value;
            const areaFilter = document.getElementById('participants-area-filter').value;
            const positionFilter = document.getElementById('participants-position-filter').value;
            const genderFilter = document.getElementById('participants-gender-filter').value;
            const maritalFilter = document.getElementById('participants-marital-filter').value;
            const ageFilter = document.getElementById('participants-age-filter').value;
            const countryFilter = document.getElementById('participants-country-filter').value;
            const cityFilter = document.getElementById('participants-city-filter').value;
            const leaderFilter = document.getElementById('participants-leader-filter').value;
            
            const allRows = document.querySelectorAll('#individual-content .participants-list .participant-item');
            const filterBadge = document.getElementById('individual-filter-badge');
            
            let activeFilters = 0;
            if (riskFilter) activeFilters++;
            if (areaFilter) activeFilters++;
            if (positionFilter) activeFilters++;
            if (genderFilter) activeFilters++;
            if (maritalFilter) activeFilters++;
            if (ageFilter) activeFilters++;
            if (countryFilter) activeFilters++;
            if (cityFilter) activeFilters++;
            if (leaderFilter) activeFilters++;
            
            if (activeFilters > 0) {
                filterBadge.textContent = activeFilters;
                filterBadge.style.display = 'flex';
            } else {
                filterBadge.style.display = 'none';
            }
            
            allRows.forEach(row => {
                let showRow = true;
                
                // Filtro por nivel de riesgo
                if (riskFilter) {
                    const riskBadge = row.querySelector('.risk-badge');
                    if (riskBadge) {
                        const riskLevel = riskBadge.classList.contains('bajo') ? 'bajo' :
                                        riskBadge.classList.contains('medio') ? 'medio' :
                                        riskBadge.classList.contains('alto') ? 'alto' :
                                        riskBadge.classList.contains('muy-alto') ? 'muy-alto' : '';
                        
                        if (riskLevel !== riskFilter) {
                            showRow = false;
                        }
                    }
                }
                
                // Aquí se pueden agregar más filtros demográficos
                // Por ahora solo implementamos el filtro de nivel de riesgo
                
                row.style.display = showRow ? '' : 'none';
            });
        }
        
        // Limpiar filtros de participantes
        function clearParticipantsFilters() {
            const riskFilter = document.getElementById('participants-risk-filter');
            const areaFilter = document.getElementById('participants-area-filter');
            const positionFilter = document.getElementById('participants-position-filter');
            const genderFilter = document.getElementById('participants-gender-filter');
            const maritalFilter = document.getElementById('participants-marital-filter');
            const ageFilter = document.getElementById('participants-age-filter');
            const countryFilter = document.getElementById('participants-country-filter');
            const cityFilter = document.getElementById('participants-city-filter');
            const leaderFilter = document.getElementById('participants-leader-filter');
            
            const allRows = document.querySelectorAll('#individual-content .participants-list .participant-item');
            const filterBadge = document.getElementById('individual-filter-badge');
            
            riskFilter.value = '';
            areaFilter.value = '';
            positionFilter.value = '';
            genderFilter.value = '';
            maritalFilter.value = '';
            ageFilter.value = '';
            countryFilter.value = '';
            cityFilter.value = '';
            leaderFilter.value = '';
            
            filterBadge.style.display = 'none';
            
            allRows.forEach(row => {
                row.style.display = '';
            });
        }

        // Generar datos del heatmap
        function generateHeatmapData() {
            const participants = [
                { name: 'Ana García', area: 'Ventas', position: 'Gerente' },
                { name: 'Carlos López', area: 'Marketing', position: 'Coordinador' },
                { name: 'María Rodríguez', area: 'RRHH', position: 'Analista' },
                { name: 'Pedro Martínez', area: 'Tecnología', position: 'Gerente' },
                { name: 'Laura Sánchez', area: 'Finanzas', position: 'Coordinador' },
                { name: 'Juan Pérez', area: 'Ventas', position: 'Analista' },
                { name: 'Sofia Castro', area: 'Marketing', position: 'Asistente' },
                { name: 'Diego Herrera', area: 'RRHH', position: 'Gerente' },
                { name: 'Carmen Vega', area: 'Tecnología', position: 'Coordinador' },
                { name: 'Roberto Silva', area: 'Finanzas', position: 'Analista' },
                { name: 'Elena Morales', area: 'Ventas', position: 'Asistente' },
                { name: 'Andrés Ruiz', area: 'Marketing', position: 'Gerente' },
                { name: 'Patricia Díaz', area: 'RRHH', position: 'Coordinador' },
                { name: 'Fernando Torres', area: 'Tecnología', position: 'Analista' },
                { name: 'Isabel Moreno', area: 'Finanzas', position: 'Asistente' }
            ];

            const questions = [];
            for (let i = 1; i <= 72; i++) {
                questions.push({
                    number: i,
                    text: `Pregunta ${i}`,
                    category: i <= 18 ? 'Ambiente de trabajo' : 
                             i <= 36 ? 'Factores de riesgo' : 
                             i <= 54 ? 'Organización del tiempo' : 'Liderazgo'
                });
            }

            // Generar respuestas aleatorias con distribución realista
            const responses = [];
            participants.forEach((participant, pIndex) => {
                const participantResponses = [];
                questions.forEach((question, qIndex) => {
                    // Simular distribución realista de respuestas
                    let riskLevel;
                    const random = Math.random();
                    
                    if (random < 0.4) {
                        riskLevel = 'bajo';
                    } else if (random < 0.7) {
                        riskLevel = 'medio';
                    } else if (random < 0.9) {
                        riskLevel = 'alto';
                    } else {
                        riskLevel = 'muy-alto';
                    }
                    
                    participantResponses.push({
                        participant: participant,
                        question: question,
                        riskLevel: riskLevel,
                        value: riskLevel === 'bajo' ? Math.floor(Math.random() * 3) + 1 :
                               riskLevel === 'medio' ? Math.floor(Math.random() * 2) + 4 :
                               riskLevel === 'alto' ? Math.floor(Math.random() * 2) + 6 : 8
                    });
                });
                responses.push(participantResponses);
            });

            return { participants, questions, responses };
        }

        // Crear el heatmap robusto
        function createHeatmap() {
            const container = document.getElementById('heatmap-container');
            if (!container) return;

            const { participants, questions, responses } = generateHeatmapData();
            
            // Agrupar preguntas por dimensión
            const dimensions = {
                'ambiente': questions.slice(0, 18),
                'factores': questions.slice(18, 36),
                'organizacion': questions.slice(36, 54),
                'liderazgo': questions.slice(54, 72)
            };
            
            let html = '<div style="overflow-x: auto;">';
            html += '<table class="heatmap-table" style="min-width: 1200px;">';
            
            // Encabezado con dimensiones desplegables
            html += '<thead>';
            html += '<tr>';
            html += '<td class="heatmap-participant-name" style="background: #f1f5f9; font-weight: 700; min-width: 120px;">Participante</td>';
            
            // Crear encabezados por dimensión
            Object.keys(dimensions).forEach(dimKey => {
                const dimQuestions = dimensions[dimKey];
                const dimName = {
                    'ambiente': 'Ambiente de trabajo',
                    'factores': 'Factores de riesgo', 
                    'organizacion': 'Organización del tiempo',
                    'liderazgo': 'Liderazgo'
                }[dimKey];
                
                html += `<td colspan="${dimQuestions.length}" style="background: #e5e7eb; text-align: center; font-weight: 600; padding: 8px; border: 1px solid #d1d5db;">
                    <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <i class="far fa-chevron-down" style="font-size: 12px;"></i>
                        <span>${dimName}</span>
                    </div>
                </td>`;
            });
            html += '</tr>';
            
            // Fila de números de pregunta
            html += '<tr>';
            html += '<td class="heatmap-participant-name" style="background: #f8f9fa; font-weight: 600; color: #6b7280;">Pregunta</td>';
            questions.forEach(question => {
                html += `<td class="heatmap-question-number">${question.number}</td>`;
            });
            html += '</tr>';
            html += '</thead>';
            
            // Filas de participantes
            html += '<tbody>';
            participants.forEach((participant, pIndex) => {
                html += '<tr>';
                html += `<td class="heatmap-participant-name" style="font-weight: 500;">${participant.name}</td>`;
                
                questions.forEach((question, qIndex) => {
                    const response = responses[pIndex][qIndex];
                    html += `<td class="heatmap-cell ${response.riskLevel}" 
                                data-participant="${participant.name}" 
                                data-question="${question.number}" 
                                data-risk="${response.riskLevel}" 
                                data-value="${response.value}"
                                data-dimension="${question.category}"
                                title="${participant.name} - Pregunta ${question.number}: ${response.riskLevel} (${response.value})"></td>`;
                });
                
                html += '</tr>';
            });
            html += '</tbody>';
            html += '</table>';
            html += '</div>';
            
            container.innerHTML = html;
            
            // Agregar tooltips mejorados
            const cells = container.querySelectorAll('.heatmap-cell');
            cells.forEach(cell => {
                cell.addEventListener('mouseenter', function(e) {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'heatmap-tooltip';
                    tooltip.innerHTML = `
                        <div style="font-weight: 600; margin-bottom: 4px;">${this.dataset.participant}</div>
                        <div style="font-size: 11px; color: #9ca3af; margin-bottom: 2px;">Pregunta ${this.dataset.question}</div>
                        <div style="font-size: 11px; color: #9ca3af; margin-bottom: 2px;">Dimensión: ${this.dataset.dimension}</div>
                        <div style="font-weight: 500; color: #fbbf24;">Nivel: ${this.dataset.risk}</div>
                        <div style="font-size: 11px; color: #9ca3af;">Valor: ${this.dataset.value}</div>
                    `;
                    document.body.appendChild(tooltip);
                    
                    const rect = this.getBoundingClientRect();
                    tooltip.style.left = (rect.left + rect.width / 2) + 'px';
                    tooltip.style.top = (rect.top - 10) + 'px';
                    tooltip.style.transform = 'translateX(-50%)';
                    
                    setTimeout(() => tooltip.classList.add('show'), 10);
                });
                
                cell.addEventListener('mouseleave', function() {
                    const tooltip = document.querySelector('.heatmap-tooltip');
                    if (tooltip) {
                        tooltip.remove();
                    }
                });
            });
            
            // Configurar filtros
            setupHeatmapFilters();
        }
        
        // Configurar filtros del heatmap
        function setupHeatmapFilters() {
            const applyBtn = document.getElementById('apply-heatmap-filters');
            if (!applyBtn) return;
            
            applyBtn.addEventListener('click', function() {
                const dimensionFilter = document.getElementById('heatmap-dimension-filter').value;
                const areaFilter = document.getElementById('heatmap-area-filter').value;
                const genderFilter = document.getElementById('heatmap-gender-filter').value;
                const riskFilter = document.getElementById('heatmap-risk-filter').value;
                
                const cells = document.querySelectorAll('.heatmap-cell');
                const rows = document.querySelectorAll('#heatmap-container tbody tr');
                
                rows.forEach(row => {
                    const participantName = row.querySelector('.heatmap-participant-name').textContent;
                    let showRow = true;
                    
                    // Filtro por área (simulado)
                    if (areaFilter) {
                        // Simular filtro por área basado en el nombre
                        const areaMap = {
                            'Ventas': ['Ana García', 'Juan Pérez', 'Elena Morales'],
                            'Marketing': ['Carlos López', 'Sofia Castro', 'Andrés Ruiz'],
                            'RRHH': ['María Rodríguez', 'Diego Herrera', 'Patricia Díaz'],
                            'Tecnología': ['Pedro Martínez', 'Carmen Vega', 'Fernando Torres'],
                            'Finanzas': ['Laura Sánchez', 'Roberto Silva', 'Isabel Moreno']
                        };
                        
                        if (!areaMap[areaFilter]?.includes(participantName)) {
                            showRow = false;
                        }
                    }
                    
                    // Filtro por género (simulado)
                    if (genderFilter) {
                        const genderMap = {
                            'Femenino': ['Ana García', 'María Rodríguez', 'Laura Sánchez', 'Sofia Castro', 'Carmen Vega', 'Elena Morales', 'Patricia Díaz', 'Isabel Moreno'],
                            'Masculino': ['Carlos López', 'Pedro Martínez', 'Juan Pérez', 'Diego Herrera', 'Roberto Silva', 'Andrés Ruiz', 'Fernando Torres']
                        };
                        
                        if (!genderMap[genderFilter]?.includes(participantName)) {
                            showRow = false;
                        }
                    }
                    
                    row.style.display = showRow ? '' : 'none';
                    
                    if (showRow) {
                        const cells = row.querySelectorAll('.heatmap-cell');
                        cells.forEach(cell => {
                            let showCell = true;
                            
                            // Filtro por dimensión
                            if (dimensionFilter) {
                                const dimensionMap = {
                                    'ambiente': 'Ambiente de trabajo',
                                    'factores': 'Factores de riesgo',
                                    'organizacion': 'Organización del tiempo',
                                    'liderazgo': 'Liderazgo'
                                };
                                
                                if (cell.dataset.dimension !== dimensionMap[dimensionFilter]) {
                                    showCell = false;
                                }
                            }
                            
                            // Filtro por nivel de riesgo
                            if (riskFilter && cell.dataset.risk !== riskFilter) {
                                showCell = false;
                            }
                            
                            cell.style.display = showCell ? '' : 'none';
                            cell.style.opacity = showCell ? '1' : '0.3';
                        });
                    }
                });
            });
        }

        // Ejecutar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            // Esperar un poco para asegurar que la tabla esté cargada
            setTimeout(() => {
                updateTableWithAllParticipants();
                
                // Configurar filtros para la tabla principal
                console.log('🔧 ===== LLAMANDO setupMainIndividualFilters =====');
                setupMainIndividualFilters();
                console.log('🔧 ===== FIN DE setupMainIndividualFilters =====');
                
                // Configurar filtros para participantes
                setupParticipantsFilters();
                
                // Crear heatmap cuando se active el tab
                const heatmapTab = document.querySelector('[data-new-tab="heatmap"]');
                if (heatmapTab) {
                    heatmapTab.addEventListener('click', function() {
                        setTimeout(() => {
                            createHeatmap();
                        }, 100);
                    });
                }
                
                // Configurar eventos del buscador
                const searchBtn = document.getElementById('individual-search-btn');
                const searchInput = document.getElementById('individual-search');
                const clearButton = document.getElementById('clear-individual-search');
                
                if (searchBtn) {
                    searchBtn.addEventListener('click', toggleIndividualSearch);
                }
                
                // Verificar si el botón de filtros existe después de la configuración
                setTimeout(() => {
                    const testBtn = document.getElementById('main-individual-filters-btn');
                    console.log('🔧 ===== VERIFICACIÓN POST-CONFIGURACIÓN =====');
                    console.log('🔧 Botón de filtros encontrado:', !!testBtn);
                    console.log('🔧 Botón de filtros:', testBtn);
                    if (testBtn) {
                        console.log('🔧 Clases del botón:', testBtn.classList.toString());
                        console.log('🔧 Estilo del botón:', testBtn.style.display);
                        console.log('🔧 Botón visible:', testBtn.offsetWidth > 0 && testBtn.offsetHeight > 0);
                    }
                    console.log('🔧 ===== FIN VERIFICACIÓN POST-CONFIGURACIÓN =====');
                }, 2000);
                
                if (searchInput) {
                    searchInput.addEventListener('input', searchParticipants);
                    searchInput.addEventListener('keyup', function(e) {
                        if (e.key === 'Escape') {
                            toggleIndividualSearch();
                        }
                    });
                }
                
                if (clearButton) {
                    clearButton.addEventListener('click', clearIndividualSearch);
                }
                
                // Cerrar buscador al hacer clic fuera
                document.addEventListener('click', function(e) {
                    const searchContainer = document.getElementById('individual-search-container');
                    const searchBtn = document.getElementById('individual-search-btn');
                    
                    if (searchContainer && searchBtn && 
                        !searchContainer.contains(e.target) && 
                        !searchBtn.contains(e.target) && 
                        searchContainer.style.display === 'block') {
                        toggleIndividualSearch();
                    }
                });
            }, 1000);
        });
    </script>

    <!-- Panel de Filtros para Participantes -->
    <div id="participants-filters-panel" class="filters-panel">
        <div class="filters-header">
            <h3>Filtros</h3>
            <button class="close-filters-btn" id="participants-close-filters-btn">
                <i class="far fa-times"></i>
            </button>
        </div>
        <div class="filters-content">
            <!-- Filtro por Nivel de Riesgo -->
            <div class="filter-group">
                <label class="filter-label">Nivel de Riesgo</label>
                <select class="filter-select" id="participants-risk-filter">
                    <option value="">Todos</option>
                    <option value="bajo">Bajo</option>
                    <option value="medio">Medio</option>
                    <option value="alto">Alto</option>
                    <option value="muy-alto">Muy Alto</option>
                </select>
            </div>
            
            <!-- Filtros Demográficos -->
            <div class="filter-group">
                <label class="filter-label">Área</label>
                <select class="filter-select" id="participants-area-filter">
                    <option value="">Todas</option>
                    <option value="Ventas">Ventas</option>
                    <option value="Marketing">Marketing</option>
                    <option value="Recursos Humanos">Recursos Humanos</option>
                    <option value="Tecnología">Tecnología</option>
                    <option value="Finanzas">Finanzas</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">Posición</label>
                <select class="filter-select" id="participants-position-filter">
                    <option value="">Todas</option>
                    <option value="Gerente">Gerente</option>
                    <option value="Coordinador">Coordinador</option>
                    <option value="Analista">Analista</option>
                    <option value="Asistente">Asistente</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">Género</label>
                <select class="filter-select" id="participants-gender-filter">
                    <option value="">Todos</option>
                    <option value="Femenino">Femenino</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">Estado Civil</label>
                <select class="filter-select" id="participants-marital-filter">
                    <option value="">Todos</option>
                    <option value="Soltero">Soltero</option>
                    <option value="Casado">Casado</option>
                    <option value="Divorciado">Divorciado</option>
                    <option value="Viudo">Viudo</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">Edad</label>
                <select class="filter-select" id="participants-age-filter">
                    <option value="">Todas</option>
                    <option value="18-25">18-25 años</option>
                    <option value="26-35">26-35 años</option>
                    <option value="36-45">36-45 años</option>
                    <option value="46-55">46-55 años</option>
                    <option value="56+">56+ años</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">País</label>
                <select class="filter-select" id="participants-country-filter">
                    <option value="">Todos</option>
                    <option value="Colombia">Colombia</option>
                    <option value="México">México</option>
                    <option value="Argentina">Argentina</option>
                    <option value="Chile">Chile</option>
                    <option value="Perú">Perú</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">Ciudad</label>
                <select class="filter-select" id="participants-city-filter">
                    <option value="">Todas</option>
                    <option value="Bogotá">Bogotá</option>
                    <option value="Medellín">Medellín</option>
                    <option value="Cali">Cali</option>
                    <option value="Ciudad de México">Ciudad de México</option>
                    <option value="Buenos Aires">Buenos Aires</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label class="filter-label">Líder</label>
                <select class="filter-select" id="participants-leader-filter">
                    <option value="">Todos</option>
                    <option value="Ana Martínez">Ana Martínez</option>
                    <option value="Carlos Rodríguez">Carlos Rodríguez</option>
                    <option value="Laura García">Laura García</option>
                    <option value="Pedro López">Pedro López</option>
                </select>
            </div>
            
            <!-- Botones de Acción -->
            <div class="filters-actions">
                <button class="apply-filters-btn" id="participants-apply-filters-btn">
                    <i class="far fa-check"></i>
                    <span>Aplicar</span>
                </button>
                <button class="clear-filters-btn" id="participants-clear-filters-btn">
                    <i class="far fa-times"></i>
                    <span>Limpiar</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Backdrop para cerrar filtros -->
    <div id="participants-filters-backdrop" class="filters-backdrop"></div>
</body>
</html>
