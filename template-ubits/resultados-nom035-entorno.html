<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBITS Playground - Resultados NOM 035 Entorno Laboral</title>
    
    <!-- Estilos locales -->
    <link rel="stylesheet" href="ubits-colors.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="fontawesome-icons.css">
    <link rel="stylesheet" href="ubits-typography.css">
    <!-- Font Awesome CDN como respaldo -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="components-sidebar.css">
    <link rel="stylesheet" href="components/tab-bar.css">
    <link rel="stylesheet" href="components/floating-menu.css">
    <link rel="stylesheet" href="components/profile-menu.css">
    <link rel="stylesheet" href="components/button.css">
    <link rel="stylesheet" href="components/input.css">
    <link rel="stylesheet" href="profile.css">
    <style>
        /* Estilos específicos para la página de resultados - FIEL AL DISEÑO */
        .results-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
            flex: 1;
            min-width: 0;
            width: 100%;
            overflow: visible;
            max-height: none;
        }

        /* Header de resultados - EXACTO COMO LA IMAGEN */
        .results-header {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 2px;
        }

        .back-button {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
            color: #1f2937;
        }

        .title-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .title-section h1 {
            margin: 0;
            color: #1f2937;
            font-size: 24px;
            font-weight: 700;
        }

        .title-section .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid;
            width: 100px;
            text-align: center;
            background: #f0fdf4;
            color: #166534;
            border-color: #22c55e;
        }

        .download-button {
            background: var(--ubits-accent-brand);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .download-button:hover {
            background: var(--ubits-accent-brand-hover);
        }

        /* Información de la encuesta - EXACTO COMO LA IMAGEN */
        .survey-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            margin-bottom: 0px;
        }

        .survey-description {
            color: #6b7280;
            margin-bottom: 0px;
            line-height: 1.5;
            font-size: 14px;
        }

        .survey-details {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #374151;
            font-size: 14px;
        }

        .detail-separator {
            width: 1px;
            height: 16px;
            background: #d1d5db;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.completed {
            background: #10b981;
            color: white;
        }

        /* Métricas - COMPACTAS COMO LA IMAGEN */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 2px;
            margin-bottom: 8px;
        }

        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .metric-title-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .metric-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f3f4f6;
            border-radius: 6px;
            color: #6b7280;
            font-size: 12px;
        }

        .metric-title {
            color: #374151;
            font-size: 14px;
            font-weight: 600;
            margin: 0;
        }

        .metric-value-section {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .metric-main-number {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            line-height: 1;
        }

        .metric-unit-text {
            font-size: 14px;
            color: #6b7280;
            font-weight: 500;
        }

        /* Panel emocional container */
        .panel-emocional-container {
            background: transparent;
            border-radius: 8px;
            padding: 0;
            margin-bottom: 2px;
        }

        .tabs-header {
            display: flex;
            gap: 8px;
        }

        .tab-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: transparent;
            border: none;
            border-radius: 6px;
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-direction: row;
        }

        .tab-button:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .tab-button.active {
            background: white;
            color: var(--ubits-accent-brand);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tab-icon {
            font-size: 16px;
        }

        .tab-content {
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            padding: 16px 0 0 0;
            margin-top: 8px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* Panel Container - Layout de dos columnas */
        .panel-container {
            display: flex;
            height: 600px;
            gap: 0;
        }

        .participants-panel {
            flex: 1;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
        }

        .participant-details-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Panel Header - Rediseñado desde cero */
        .panel-header {
            padding: 12px 24px;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
            border-radius: 8px 8px 0 0;
        }

        .panel-header h3 {
            margin: 0 0 8px 0;
            color: #1f2937;
            font-size: 18px;
            font-weight: 600;
        }

        /* Search and Filters Container - Solo layout básico */
        .search-filters-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Buscador simple */
        .simple-search-container {
            position: relative;
            width: 100%;
        }

        .simple-search-input {
            width: 100%;
            height: 40px;
            padding: 8px 12px 8px 40px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            color: #374151;
            outline: none;
            box-sizing: border-box;
            transition: border-color 0.2s ease;
        }

        .simple-search-input:focus {
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .simple-search-input::placeholder {
            color: #9ca3af;
        }

        .simple-search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            color: #6b7280;
            pointer-events: none;
            z-index: 1;
        }

        .filters-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .filters-button:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .filter-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: #ef4444;
            color: white !important;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }


        .filter-group {
            margin-bottom: 24px;
        }

        .filter-label {
            display: block;
            color: #374151;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 12px;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .filter-option:hover {
            background: #f3f4f6;
        }

        .filter-option input[type="checkbox"] {
            margin: 0;
        }

        .risk-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .risk-indicator.nulo { background: #9ca3af; }
        .risk-indicator.bajo { background: #10b981; }
        .risk-indicator.medio { background: #f59e0b; }
        .risk-indicator.alto { background: #ef4444; }
        .risk-indicator.muy-alto { background: #7c3aed; }

        .filter-actions {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            gap: 12px;
            padding: 20px;
            background: #fff;
            border-top: 1px solid #e5e7eb;
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
        }

        .apply-filters-btn, .clear-filters-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .apply-filters-btn {
            background: var(--ubits-accent-brand);
            color: white;
        }

        .apply-filters-btn:hover {
            background: var(--ubits-accent-brand-hover);
        }

        .clear-filters-btn {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .clear-filters-btn:hover {
            background: #e5e7eb;
        }

        /* Participants List */
        .participants-list {
            flex: 1;
            overflow-y: auto;
        }

        .participant-item {
            display: flex;
            align-items: center;
            padding: 8px 24px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 2px;
            border-left: 4px solid transparent;
        }

        .participant-item:hover {
            background: #f3f4f6;
        }

        .participant-item.selected {
            background: #eff6ff;
            border-left-color: var(--ubits-accent-brand);
        }

        .participant-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .participant-info-content {
            flex: 1;
            min-width: 0;
        }

        .participant-name {
            color: #1f2937;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .participant-role {
            color: #6b7280;
            font-size: 12px;
        }

        .risk-level {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .risk-level.nulo { background: #f3f4f6; color: #6b7280; }
        .risk-level.bajo { background: #dcfce7; color: #166534; }
        .risk-level.medio { background: #fef3c7; color: #92400e; }
        .risk-level.alto { background: #fee2e2; color: #991b1b; }
        .risk-level.muy-alto { background: #f3e8ff; color: #6b21a8; }

        /* Participant Details */
        .no-selection {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #9ca3af;
            text-align: center;
            padding: 40px;
        }

        .no-selection i {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .participant-details {
            padding: 16px;
            border-bottom: 1px solid #e5e7eb;
        }

        .participant-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .participant-avatar-large {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .participant-details-content h4 {
            margin: 0 0 2px 0;
            color: #1f2937;
            font-size: 16px;
            font-weight: 600;
        }

        .participant-details-content p {
            margin: 0;
            color: #6b7280;
            font-size: 12px;
        }

        .participant-info {
            padding: 12px 16px;
        }

        .participant-info-line {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .participant-name {
            font-weight: 600;
            color: #1f2937;
        }

        .participant-separator {
            color: #d1d5db;
        }

        .participant-age, .participant-area, .participant-position, .participant-gender, .participant-marital {
            color: #6b7280;
            font-size: 14px;
        }

        /* Survey Results */
        .survey-results {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .survey-section {
            margin-bottom: 8px;
        }

        .section-header {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            background: #f9fafb;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 4px solid #e5e7eb;
        }

        .section-header:hover {
            background: #f3f4f6;
        }

        .section-header.open {
            background: #eff6ff;
            border-left-color: var(--ubits-accent-brand);
        }

        .section-risk-info {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }

        .section-risk-level {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .section-risk-level.nulo { background: #f3f4f6; color: #6b7280; }
        .section-risk-level.bajo { background: #dcfce7; color: #166534; }
        .section-risk-level.medio { background: #fef3c7; color: #92400e; }
        .section-risk-level.alto { background: #fee2e2; color: #991b1b; }
        .section-risk-level.muy-alto { background: #f3e8ff; color: #6b21a8; }

        .section-percentage {
            color: #6b7280;
            font-size: 12px;
            font-weight: 500;
            min-width: 35px;
            text-align: right;
        }

        .section-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: transparent;
            color: #374151;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .section-title {
            flex: 1;
            font-weight: 600;
            color: #1f2937;
            font-size: 14px;
        }

        .section-chevron {
            color: #6b7280;
            font-size: 12px;
            transition: transform 0.2s ease;
        }

        .section-header.open .section-chevron {
            transform: rotate(180deg);
        }

        .section-content {
            display: none;
            padding: 16px;
            background: white;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 6px 6px;
        }

        .section-content.open {
            display: block;
        }

        .question-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .question-item:last-child {
            border-bottom: none;
        }

        .question-text {
            flex: 1;
            color: #374151;
            font-size: 14px;
            line-height: 1.4;
        }

        .question-answer {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .answer-yes {
            background: #fee2e2;
            color: #991b1b;
        }

        .answer-no {
            background: #dcfce7;
            color: #166534;
        }

        /* Custom Select Component */
        .custom-select {
            position: relative;
            width: 100%;
        }

        .select-trigger {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: #fff;
            color: #374151;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: border-color 0.2s ease;
        }

        .select-trigger:hover {
            border-color: #9ca3af;
        }

        .select-trigger.active {
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .select-trigger .select-text {
            flex: 1;
            text-align: left;
        }

        .select-trigger .select-arrow {
            transition: transform 0.2s ease;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #fff;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .select-dropdown.show {
            display: block;
        }

        .select-option {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s ease;
        }

        .select-option:hover {
            background: #f3f4f6;
        }

        .select-option.selected {
            background: #eff6ff;
            color: var(--ubits-accent-brand);
        }

        .select-option input[type="checkbox"] {
            margin: 0;
        }

        .select-option .option-text {
            flex: 1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .panel-container {
                flex-direction: column;
                height: auto;
            }

            .participants-panel {
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .survey-details {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .detail-separator {
                display: none;
            }
        }

        /* Download Dropdown Styles */
        .download-dropdown {
            position: relative;
            display: inline-block;
        }

        .download-dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            z-index: 1000;
            top: 100%;
            margin-top: 4px;
        }

        .download-dropdown-content.show {
            display: block;
        }

        .download-dropdown-content a {
            color: #374151;
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid #f3f4f6;
        }

        .download-dropdown-content a:last-child {
            border-bottom: none;
        }

        .download-dropdown-content a:hover {
            background-color: #f9fafb;
        }

        .download-dropdown-content a i {
            width: 16px;
            text-align: center;
        }

        /* Tabs Styles */
        .tabs-container {
            margin-top: 16px;
        }

        .tabs-header {
            display: flex;
            gap: 0;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 16px;
        }

        .tab-button {
            background: transparent;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.2s ease;
            border-bottom: 2px solid transparent;
            position: relative;
        }

        .tab-button:hover {
            color: #374151;
            background-color: #f9fafb;
        }

        .tab-button.active {
            background: white;
            color: #3b82f6;
            font-weight: 700;
            border-bottom-color: transparent;
        }

        .tab-button i {
            font-size: 16px;
        }

        .tab-content {
            min-height: 200px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .panel-content {
            padding: 24px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .panel-content h3 {
            margin: 0 0 16px 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
        }

        .panel-content p {
            margin: 0;
            color: #6b7280;
            line-height: 1.6;
        }

        /* Results Table Styles */
        .results-table-container {
            overflow-x: auto;
            margin-top: 16px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }

        .results-table thead {
            background: #f8fafc;
        }

        .results-table th {
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
            border-right: none;
            white-space: nowrap;
        }

        .results-table th:first-child {
            border-right: none;
        }

        .results-table td {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
            border-right: none;
            font-size: 14px;
            color: #374151;
            vertical-align: top;
        }

        .results-table td:first-child {
            border-right: none;
        }

        .results-table tbody tr:hover:not(.category-summary) {
            background-color: #fafbfc;
        }

        /* Asegurar que las celdas de dominio y dimensión no se vean afectadas por otros estilos */
        .results-table .category-summary td.category-domain-info,
        .results-table .category-summary td.category-dimension-info {
            background: inherit !important;
        }

        .category-cell {
            font-weight: 600;
            background: inherit !important;
            border-right: 1px solid #e5e7eb;
            min-width: 200px;
        }


        .summary-text {
            font-weight: 600;
            color: #6b7280;
            font-style: italic;
        }

        .risk-count {
            font-weight: 600;
            text-align: center;
            color: #374151;
        }

        .percentage {
            font-weight: 600;
            text-align: center;
            color: #6b7280;
        }

        .risk-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            min-width: 60px;
        }

        .risk-badge.nulo {
            background-color: #f3f4f6;
            color: #6b7280;
        }

        .risk-badge.bajo {
            background-color: #dcfce7;
            color: #166534;
        }

        .risk-badge.medio {
            background-color: #fef3c7;
            color: #92400e;
        }

        .risk-badge.alto {
            background-color: #fed7d7;
            color: #c53030;
        }

        .risk-badge.muy-alto {
            background-color: #fecaca;
            color: #991b1b;
        }

        /* Estilos para las filas de categoría con dropdown - Estilo emocional */
        .category-summary {
            cursor: pointer;
            background: #f9fafb;
            border-radius: 6px;
            transition: all 0.2s ease;
            border-left: 4px solid #e5e7eb;
            margin-bottom: 8px;
        }

        .category-summary:hover {
            background: #e5e7eb !important;
        }

        .category-summary.open {
            background: #dbeafe !important;
            border-left-color: var(--ubits-accent-brand);
        }

        /* Asegurar que todas las celdas de la fila tengan el mismo comportamiento */
        .category-summary td {
            background: inherit !important;
            border-radius: 0;
        }

        .category-summary:hover td {
            background: #e5e7eb !important;
        }

        .category-summary.open td {
            background: #dbeafe !important;
        }

        .category-header-row {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            gap: 12px;
        }

        .category-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: transparent;
            color: #374151;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .category-domain-info {
            font-size: 13px;
            color: #374151;
            font-weight: 500;
            padding: 8px 16px;
            min-width: 200px;
            width: 200px;
            max-width: 200px;
            transition: color 0.3s ease;
            background: inherit !important;
        }

        .category-dimension-info {
            font-size: 12px;
            color: #6b7280;
            font-weight: 400;
            padding: 8px 16px;
            min-width: 250px;
            width: 250px;
            max-width: 250px;
            transition: color 0.3s ease;
            background: inherit !important;
        }

        /* Asegurar que las celdas mantengan el fondo correcto en todos los estados */
        .category-summary.open .category-domain-info,
        .category-summary.open .category-dimension-info {
            background: #dbeafe !important;
        }

        .category-summary:hover .category-domain-info,
        .category-summary:hover .category-dimension-info {
            background: #e5e7eb !important;
        }

        /* Eliminar borde inferior de las filas de categoría cuando están expandidas */
        .category-summary.open td {
            border-bottom: none !important;
        }

        .category-cell {
            font-weight: 600;
            background: transparent;
            padding: 0;
        }

        .category-cell span {
            font-size: 14px;
            color: #374151;
        }

        .category-risk-info {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: space-between;
            width: 100%;
        }

        .category-percentage {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            min-width: 35px;
            text-align: right;
        }

        .category-chevron {
            color: #6b7280;
            transition: transform 0.2s ease;
            font-size: 12px;
        }

        .category-summary.open .category-chevron {
            transform: rotate(180deg);
        }

        .category-detail {
            background: #fafbfc;
            border-radius: 4px;
            margin: 4px 0;
        }

        /* Estilos para las celdas de estadísticas en filas de resumen */
        .category-summary td:nth-child(4),
        .category-summary td:nth-child(5) {
            font-weight: 600;
            color: #374151;
            font-size: 12px;
        }

        .category-summary td:last-child {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* Estilos para los badges de riesgo */
        .risk-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .risk-badge.nulo {
            background: #f3f4f6;
            color: #6b7280;
        }

        .risk-badge.bajo {
            background: #dcfce7;
            color: #166534;
        }

        .risk-badge.medio {
            background: #fef3c7;
            color: #92400e;
        }

        .risk-badge.alto {
            background: #fed7aa;
            color: #c2410c;
        }

        .risk-badge.muy-alto {
            background: #fecaca;
            color: #dc2626;
        }

        /* Table Header and Controls */
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .table-header h3 {
            margin: 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
        }

        .table-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }


        .filter-badge {
            background-color: #3b82f6;
            color: white !important;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            margin-left: 4px;
        }

        /* Forzar color blanco en el badge */
        .filter-badge,
        .filter-badge *,
        .filter-badge span,
        .filter-badge::before,
        .filter-badge::after {
            color: white !important;
        }

        /* Específico para el badge de la tabla */
        #table-filter-badge {
            color: white !important;
        }

        #table-filter-badge * {
            color: white !important;
        }

        /* Forzar color blanco en el badge dentro del botón */
        #table-filters-btn .filter-badge {
            color: white !important;
        }

        #table-filters-btn .filter-badge * {
            color: white !important;
        }

        /* Asegurar que el botón no herede color al badge */
        .ubits-button .filter-badge {
            color: white !important;
        }

        .ubits-button .filter-badge * {
            color: white !important;
        }

        /* Filters Side Panel Styles */
        .filters-side-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .filters-side-panel.show {
            right: 0;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
        }

        .filters-header h3 {
            margin: 0;
            color: #374151;
            font-size: 18px;
            font-weight: 600;
        }

        .close-filters-btn {
            background: none;
            border: none;
            color: #6b7280;
            font-size: 18px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }

        .close-filters-btn:hover {
            background-color: #f3f4f6;
        }

        .filters-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            padding-bottom: 100px; /* Espacio para los botones fijos */
        }

        .filter-group {
            margin-bottom: 20px;
        }

        .filter-label {
            display: block;
            margin-bottom: 8px;
            color: #374151;
            font-size: 14px;
            font-weight: 600;
        }

        .custom-select {
            position: relative;
            width: 100%;
        }

        .select-trigger {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s ease;
        }

        .select-trigger:hover {
            border-color: #9ca3af;
        }

        .select-trigger.active {
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .select-text {
            color: #374151;
            font-size: 14px;
        }

        .select-arrow {
            color: #6b7280;
            font-size: 12px;
            transition: transform 0.2s ease;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .select-dropdown.show {
            display: block;
        }

        .select-option {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            gap: 8px;
        }

        .select-option:hover {
            background-color: #f9fafb;
        }

        .select-option input[type="checkbox"] {
            margin: 0;
        }

        .risk-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .risk-indicator.nulo {
            background-color: #f3f4f6;
        }

        .risk-indicator.bajo {
            background-color: #dcfce7;
        }

        .risk-indicator.medio {
            background-color: #fef3c7;
        }

        .risk-indicator.alto {
            background-color: #fed7d7;
        }

        .risk-indicator.muy-alto {
            background-color: #fecaca;
        }


        .apply-filters-btn,
        .clear-filters-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s ease;
        }

        .apply-filters-btn {
            background: var(--ubits-accent-brand);
            color: white;
        }

        .apply-filters-btn:hover {
            background: #2563eb;
        }

        .clear-filters-btn {
            background: #f3f4f6;
            color: #374151;
        }

        .clear-filters-btn:hover {
            background: #e5e7eb;
        }

        .filters-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .filters-overlay.show {
            display: block;
        }

        /* Estilos para la tabla de dimensiones */
        .dimension-row {
            border-bottom: 1px solid var(--ubits-border-1);
        }

        .dimension-row:hover {
            background: var(--ubits-bg-2);
        }

        .dimension-cell {
            padding: 12px 16px;
            font-weight: 600;
            color: var(--ubits-fg-1-high);
            background: inherit !important;
        }

        .dimension-header-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dimension-number {
            background: var(--ubits-fg-1-medium);
            color: var(--ubits-bg-1);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .dimension-domain-info {
            font-size: 13px;
            color: var(--ubits-fg-1-medium);
            font-weight: 500;
            padding: 12px 16px;
            background: inherit !important;
        }

        .dimension-risk-info {
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Navigation -->
            <div id="top-nav-container"></div>

            <!-- Content Area -->
            <div class="content-area">
                <div class="results-container">
                    <!-- Header de resultados -->
                    <div class="results-header">
                        <button class="back-button" onclick="window.history.back()">
                            <i class="far fa-arrow-left"></i>
                            <span>Regresar</span>
                        </button>
                        <div class="title-section">
                            <h1>NOM 035 Entorno Laboral</h1>
                            <span class="status-badge">Completado</span>
                        </div>
                        <div style="margin-left: auto;">
                            <div class="download-dropdown">
                                <button class="ubits-button ubits-button--primary ubits-button--md" type="button" id="download-btn" onclick="toggleDownloadDropdown()">
                                    <i class="far fa-download"></i>
                                    <span>Descargar</span>
                                    <i class="far fa-chevron-down"></i>
                                </button>
                                <div class="download-dropdown-content" id="download-dropdown-content">
                                    <a href="#" onclick="downloadCSV()">
                                        <i class="far fa-file-csv"></i>
                                        Descargar CSV
                                    </a>
                                    <a href="#" onclick="downloadPDF()">
                                        <i class="far fa-file-pdf"></i>
                                        Descargar PDF
                                    </a>
                                    <a href="#" onclick="downloadExcel()">
                                        <i class="far fa-file-excel"></i>
                                        Descargar Excel
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Información de la encuesta -->
                    <div class="survey-info">
                        <div class="survey-details">
                            <div class="detail-item">
                                <i class="far fa-users"></i>
                                <span>Enviado a <strong>150 colaboradores</strong></span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-calendar"></i>
                                <span>Inicio <strong>15 octubre 2024</strong></span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-calendar"></i>
                                <span>Hasta <strong>15 noviembre 2024</strong></span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-globe"></i>
                                <span>Respuestas: <strong>Pública</strong></span>
                            </div>
                        </div>
                    </div>

                    <!-- Métricas -->
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-title-section">
                                <div class="metric-icon">
                                    <i class="far fa-chart-bar"></i>
                                </div>
                                <h3 class="metric-title">Total de casos en riesgo alto y muy alto</h3>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">8</div>
                                <div class="metric-unit-text">Casos</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title-section">
                                <div class="metric-icon">
                                    <i class="far fa-users"></i>
                                </div>
                                <h3 class="metric-title">Total de casos canalizados</h3>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">5</div>
                                <div class="metric-unit-text">Casos</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-title-section">
                                <div class="metric-icon">
                                    <i class="far fa-check-circle"></i>
                                </div>
                                <h3 class="metric-title">% de participación</h3>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">140 / 150</div>
                                <div class="metric-unit-text">Colaboradores</div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabs Container -->
                    <div class="tabs-container">
                        <div class="tabs-header">
                            <button class="tab-button active" data-tab="general">
                                <i class="far fa-chart-bar"></i>
                                <span>General</span>
                            </button>
                            <button class="tab-button" data-tab="dimension">
                                <i class="far fa-layer-group"></i>
                                <span>Dimensión</span>
                            </button>
                            <button class="tab-button" data-tab="individual">
                                <i class="far fa-user"></i>
                                <span>Individual</span>
                            </button>
                        </div>
                        
                        <!-- Tab Content -->
                        <div class="tab-panel active" id="general-panel">
                                <div class="panel-content">
                                    <div class="table-header">
                                        <h3>Vista General de Resultados NOM-035</h3>
                                        <div class="table-controls">
                                            <!-- Campo de búsqueda desplegable -->
                                            <div id="table-search-container" style="display: none; position: relative;">
                                                <input type="text" id="table-search" placeholder="Buscar en resultados..." 
                                                       style="padding: 8px 12px; border: 1px solid var(--ubits-border-1); border-radius: 6px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); width: 250px; font-size: 14px;">
                                                <button id="close-table-search" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--ubits-fg-1-medium); cursor: pointer;">
                                                    <i class="far fa-times"></i>
                                                </button>
                                            </div>
                                            <button id="table-search-btn" class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" style="width: 32px; height: 32px;">
                                                <i class="far fa-search"></i>
                                            </button>
                                            <button id="table-filters-btn" class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" style="width: 32px; height: 32px;">
                                                <i class="far fa-filter"></i>
                                                <span class="filter-badge" id="table-filter-badge" style="display: none;">0</span>
                                            </button>
                                        </div>
                                    </div>
                                    <table class="results-table">
                                            <thead>
                                                <tr>
                                                    <th>Categoría</th>
                                                    <th>Dominio</th>
                                                    <th>Dimensión</th>
                                                    <th>Total Usuarios en Riesgo</th>
                                                    <th>% Colaboradores Afectados</th>
                                                    <th>Nivel de Riesgo</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Categoría: Ambiente de trabajo -->
                                                <tr class="category-summary" onclick="toggleCategoryRow(this)">
                                                    <td class="category-cell">
                                                        <div class="category-header-row">
                                                            <div class="category-number">1</div>
                                                            <span>Ambiente de trabajo</span>
                                                        </div>
                                                    </td>
                                                    <td class="category-domain-info">Condiciones en el ambiente de trabajo</td>
                                                    <td class="category-dimension-info">Condiciones físicas, seguridad y comodidad</td>
                                                    <td class="risk-count">12</td>
                                                    <td class="percentage">8.0%</td>
                                                    <td>
                                                        <div class="category-risk-info">
                                                            <span class="risk-badge bajo">Bajo</span>
                                                            <i class="far fa-chevron-down category-chevron"></i>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Condiciones en el ambiente de trabajo</td>
                                                    <td>Condiciones físicas, seguridad y comodidad</td>
                                                    <td class="risk-count">12</td>
                                                    <td class="percentage">8.0%</td>
                                                    <td><span class="risk-badge bajo">Bajo</span></td>
                                                </tr>
                                                
                                                <!-- Categoría: Factores propios de la actividad -->
                                                <tr class="category-summary" onclick="toggleCategoryRow(this)">
                                                    <td class="category-cell">
                                                        <div class="category-header-row">
                                                            <div class="category-number">2</div>
                                                            <span>Factores propios de la actividad</span>
                                                        </div>
                                                    </td>
                                                    <td class="category-domain-info">Carga de trabajo</td>
                                                    <td class="category-dimension-info">Exigencias cuantitativas, mentales y emocionales</td>
                                                    <td class="risk-count">43</td>
                                                    <td class="percentage">28.7%</td>
                                                    <td>
                                                        <div class="category-risk-info">
                                                            <span class="risk-badge medio">Medio</span>
                                                            <i class="far fa-chevron-down category-chevron"></i>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Carga de trabajo</td>
                                                    <td>Exigencias cuantitativas, mentales y emocionales</td>
                                                    <td class="risk-count">28</td>
                                                    <td class="percentage">18.7%</td>
                                                    <td><span class="risk-badge medio">Medio</span></td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Falta de control sobre el trabajo</td>
                                                    <td>Claridad de rol, autonomía, reconocimiento</td>
                                                    <td class="risk-count">15</td>
                                                    <td class="percentage">10.0%</td>
                                                    <td><span class="risk-badge bajo">Bajo</span></td>
                                                </tr>
                                                
                                                <!-- Categoría: Organización del tiempo de trabajo -->
                                                <tr class="category-summary" onclick="toggleCategoryRow(this)">
                                                    <td class="category-cell">
                                                        <div class="category-header-row">
                                                            <div class="category-number">3</div>
                                                            <span>Organización del tiempo de trabajo</span>
                                                        </div>
                                                    </td>
                                                    <td class="category-domain-info">Jornada de trabajo</td>
                                                    <td class="category-dimension-info">Duración, distribución y pausas</td>
                                                    <td class="risk-count">22</td>
                                                    <td class="percentage">14.7%</td>
                                                    <td>
                                                        <div class="category-risk-info">
                                                            <span class="risk-badge medio">Medio</span>
                                                            <i class="far fa-chevron-down category-chevron"></i>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Jornada de trabajo</td>
                                                    <td>Duración, distribución y pausas</td>
                                                    <td class="risk-count">22</td>
                                                    <td class="percentage">14.7%</td>
                                                    <td><span class="risk-badge medio">Medio</span></td>
                                                </tr>
                                                
                                                <!-- Categoría: Liderazgo y relaciones en el trabajo -->
                                                <tr class="category-summary" onclick="toggleCategoryRow(this)">
                                                    <td class="category-cell">
                                                        <div class="category-header-row">
                                                            <div class="category-number">4</div>
                                                            <span>Liderazgo y relaciones en el trabajo</span>
                                                        </div>
                                                    </td>
                                                    <td class="category-domain-info">Liderazgo y Relaciones interpersonales</td>
                                                    <td class="category-dimension-info">Estilo de liderazgo, comunicación, apoyo y relaciones</td>
                                                    <td class="risk-count">26</td>
                                                    <td class="percentage">17.3%</td>
                                                    <td>
                                                        <div class="category-risk-info">
                                                            <span class="risk-badge bajo">Bajo</span>
                                                            <i class="far fa-chevron-down category-chevron"></i>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Liderazgo</td>
                                                    <td>Estilo de liderazgo, comunicación, apoyo</td>
                                                    <td class="risk-count">18</td>
                                                    <td class="percentage">12.0%</td>
                                                    <td><span class="risk-badge bajo">Bajo</span></td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Relaciones en el trabajo</td>
                                                    <td>Comunicación, colaboración, confianza, respeto</td>
                                                    <td class="risk-count">8</td>
                                                    <td class="percentage">5.3%</td>
                                                    <td><span class="risk-badge nulo">Nulo</span></td>
                                                </tr>
                                                
                                                <!-- Categoría: Violencia laboral -->
                                                <tr class="category-summary" onclick="toggleCategoryRow(this)">
                                                    <td class="category-cell">
                                                        <div class="category-header-row">
                                                            <div class="category-number">5</div>
                                                            <span>Violencia laboral</span>
                                                        </div>
                                                    </td>
                                                    <td class="category-domain-info">Violencia laboral</td>
                                                    <td class="category-dimension-info">Acoso, hostigamiento y violencia</td>
                                                    <td class="risk-count">5</td>
                                                    <td class="percentage">3.3%</td>
                                                    <td>
                                                        <div class="category-risk-info">
                                                            <span class="risk-badge nulo">Nulo</span>
                                                            <i class="far fa-chevron-down category-chevron"></i>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Violencia laboral</td>
                                                    <td>Maltrato, acoso, discriminación, hostigamiento</td>
                                                    <td class="risk-count">5</td>
                                                    <td class="percentage">3.3%</td>
                                                    <td><span class="risk-badge nulo">Nulo</span></td>
                                                </tr>
                                                
                                                <!-- Categoría: Entorno organizacional -->
                                                <tr class="category-summary" onclick="toggleCategoryRow(this)">
                                                    <td class="category-cell">
                                                        <div class="category-header-row">
                                                            <div class="category-number">6</div>
                                                            <span>Entorno organizacional</span>
                                                        </div>
                                                    </td>
                                                    <td class="category-domain-info">Entorno organizacional</td>
                                                    <td class="category-dimension-info">Cultura organizacional y políticas</td>
                                                    <td class="risk-count">77</td>
                                                    <td class="percentage">51.3%</td>
                                                    <td>
                                                        <div class="category-risk-info">
                                                            <span class="risk-badge alto">Alto</span>
                                                            <i class="far fa-chevron-down category-chevron"></i>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Reconocimiento del desempeño</td>
                                                    <td>Estímulo, desarrollo y valoración</td>
                                                    <td class="risk-count">25</td>
                                                    <td class="percentage">16.7%</td>
                                                    <td><span class="risk-badge medio">Medio</span></td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Sentido de pertenencia e identidad organizacional</td>
                                                    <td>Orgullo, compromiso y participación</td>
                                                    <td class="risk-count">20</td>
                                                    <td class="percentage">13.3%</td>
                                                    <td><span class="risk-badge bajo">Bajo</span></td>
                                                </tr>
                                                <tr class="category-detail" style="display: none;">
                                                    <td class="category-cell"></td>
                                                    <td>Estabilidad y justicia organizacional</td>
                                                    <td>Equidad, respeto y seguridad laboral</td>
                                                    <td class="risk-count">32</td>
                                                    <td class="percentage">21.3%</td>
                                                    <td><span class="risk-badge alto">Alto</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    
                                    <!-- Filters Side Panel -->
                                    <div class="filters-side-panel" id="table-filters-side-panel">
                                        <div class="filters-header">
                                            <h3>Filtros</h3>
                                            <button class="close-filters-btn" id="close-table-filters-btn">
                                                <i class="far fa-times"></i>
                                            </button>
                                        </div>
                                        <div class="filters-content">
                                            <div class="filter-group">
                                                <label class="filter-label">Nivel de Riesgo</label>
                                                <div class="custom-select" id="table-risk-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar niveles</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="table-risk-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="nulo">
                                                            <input type="checkbox" id="table-risk-nulo">
                                                            <div class="risk-indicator nulo"></div>
                                                            <span class="option-text">Nulo</span>
                                                        </div>
                                                        <div class="select-option" data-value="bajo">
                                                            <input type="checkbox" id="table-risk-bajo">
                                                            <div class="risk-indicator bajo"></div>
                                                            <span class="option-text">Bajo</span>
                                                        </div>
                                                        <div class="select-option" data-value="medio">
                                                            <input type="checkbox" id="table-risk-medio">
                                                            <div class="risk-indicator medio"></div>
                                                            <span class="option-text">Medio</span>
                                                        </div>
                                                        <div class="select-option" data-value="alto">
                                                            <input type="checkbox" id="table-risk-alto">
                                                            <div class="risk-indicator alto"></div>
                                                            <span class="option-text">Alto</span>
                                                        </div>
                                                        <div class="select-option" data-value="muy-alto">
                                                            <input type="checkbox" id="table-risk-muy-alto">
                                                            <div class="risk-indicator muy-alto"></div>
                                                            <span class="option-text">Muy Alto</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="filter-group">
                                                <label class="filter-label">Categoría</label>
                                                <div class="custom-select" id="table-category-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar categorías</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="table-category-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="ambiente">
                                                            <input type="checkbox" id="table-category-ambiente">
                                                            <span class="option-text">Ambiente de trabajo</span>
                                                        </div>
                                                        <div class="select-option" data-value="factores">
                                                            <input type="checkbox" id="table-category-factores">
                                                            <span class="option-text">Factores propios de la actividad</span>
                                                        </div>
                                                        <div class="select-option" data-value="organizacion">
                                                            <input type="checkbox" id="table-category-organizacion">
                                                            <span class="option-text">Organización del tiempo de trabajo</span>
                                                        </div>
                                                        <div class="select-option" data-value="liderazgo">
                                                            <input type="checkbox" id="table-category-liderazgo">
                                                            <span class="option-text">Liderazgo y relaciones en el trabajo</span>
                                                        </div>
                                                        <div class="select-option" data-value="violencia">
                                                            <input type="checkbox" id="table-category-violencia">
                                                            <span class="option-text">Violencia laboral</span>
                                                        </div>
                                                        <div class="select-option" data-value="entorno">
                                                            <input type="checkbox" id="table-category-entorno">
                                                            <span class="option-text">Entorno organizacional</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Área</label>
                                            <div class="custom-select" id="table-area-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar áreas</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-area-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Recursos Humanos">
                                                        <input type="checkbox" id="table-area-rrhh">
                                                        <span class="option-text">Recursos Humanos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Ventas">
                                                        <input type="checkbox" id="table-area-ventas">
                                                        <span class="option-text">Ventas</span>
                                                    </div>
                                                    <div class="select-option" data-value="Marketing">
                                                        <input type="checkbox" id="table-area-marketing">
                                                        <span class="option-text">Marketing</span>
                                                    </div>
                                                    <div class="select-option" data-value="Finanzas">
                                                        <input type="checkbox" id="table-area-finanzas">
                                                        <span class="option-text">Finanzas</span>
                                                    </div>
                                                    <div class="select-option" data-value="Operaciones">
                                                        <input type="checkbox" id="table-area-operaciones">
                                                        <span class="option-text">Operaciones</span>
                                                    </div>
                                                    <div class="select-option" data-value="Tecnología">
                                                        <input type="checkbox" id="table-area-tecnologia">
                                                        <span class="option-text">Tecnología</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Cargo</label>
                                            <div class="custom-select" id="table-position-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar cargos</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-position-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Gerente">
                                                        <input type="checkbox" id="table-position-gerente">
                                                        <span class="option-text">Gerente</span>
                                                    </div>
                                                    <div class="select-option" data-value="Coordinador">
                                                        <input type="checkbox" id="table-position-coordinador">
                                                        <span class="option-text">Coordinador</span>
                                                    </div>
                                                    <div class="select-option" data-value="Analista">
                                                        <input type="checkbox" id="table-position-analista">
                                                        <span class="option-text">Analista</span>
                                                    </div>
                                                    <div class="select-option" data-value="Asistente">
                                                        <input type="checkbox" id="table-position-asistente">
                                                        <span class="option-text">Asistente</span>
                                                    </div>
                                                    <div class="select-option" data-value="Especialista">
                                                        <input type="checkbox" id="table-position-especialista">
                                                        <span class="option-text">Especialista</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Sexo</label>
                                            <div class="custom-select" id="table-gender-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar sexo</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-gender-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Masculino">
                                                        <input type="checkbox" id="table-gender-masculino">
                                                        <span class="option-text">Masculino</span>
                                                    </div>
                                                    <div class="select-option" data-value="Femenino">
                                                        <input type="checkbox" id="table-gender-femenino">
                                                        <span class="option-text">Femenino</span>
                                                    </div>
                                                    <div class="select-option" data-value="Otro">
                                                        <input type="checkbox" id="table-gender-otro">
                                                        <span class="option-text">Otro</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Estado Civil</label>
                                            <div class="custom-select" id="table-marital-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar estado civil</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-marital-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Soltero">
                                                        <input type="checkbox" id="table-marital-soltero">
                                                        <span class="option-text">Soltero</span>
                                                    </div>
                                                    <div class="select-option" data-value="Casado">
                                                        <input type="checkbox" id="table-marital-casado">
                                                        <span class="option-text">Casado</span>
                                                    </div>
                                                    <div class="select-option" data-value="Divorciado">
                                                        <input type="checkbox" id="table-marital-divorciado">
                                                        <span class="option-text">Divorciado</span>
                                                    </div>
                                                    <div class="select-option" data-value="Viudo">
                                                        <input type="checkbox" id="table-marital-viudo">
                                                        <span class="option-text">Viudo</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Edad</label>
                                            <div class="custom-select" id="table-age-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar rango de edad</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-age-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="18-25">
                                                        <input type="checkbox" id="table-age-18-25">
                                                        <span class="option-text">18-25 años</span>
                                                    </div>
                                                    <div class="select-option" data-value="26-35">
                                                        <input type="checkbox" id="table-age-26-35">
                                                        <span class="option-text">26-35 años</span>
                                                    </div>
                                                    <div class="select-option" data-value="36-45">
                                                        <input type="checkbox" id="table-age-36-45">
                                                        <span class="option-text">36-45 años</span>
                                                    </div>
                                                    <div class="select-option" data-value="46-55">
                                                        <input type="checkbox" id="table-age-46-55">
                                                        <span class="option-text">46-55 años</span>
                                                    </div>
                                                    <div class="select-option" data-value="55+">
                                                        <input type="checkbox" id="table-age-55+">
                                                        <span class="option-text">55+ años</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">País</label>
                                            <div class="custom-select" id="table-country-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar países</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-country-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Colombia">
                                                        <input type="checkbox" id="table-country-colombia">
                                                        <span class="option-text">Colombia</span>
                                                    </div>
                                                    <div class="select-option" data-value="México">
                                                        <input type="checkbox" id="table-country-mexico">
                                                        <span class="option-text">México</span>
                                                    </div>
                                                    <div class="select-option" data-value="Argentina">
                                                        <input type="checkbox" id="table-country-argentina">
                                                        <span class="option-text">Argentina</span>
                                                    </div>
                                                    <div class="select-option" data-value="Chile">
                                                        <input type="checkbox" id="table-country-chile">
                                                        <span class="option-text">Chile</span>
                                                    </div>
                                                    <div class="select-option" data-value="Perú">
                                                        <input type="checkbox" id="table-country-peru">
                                                        <span class="option-text">Perú</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Ciudad</label>
                                            <div class="custom-select" id="table-city-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar ciudades</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-city-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Bogotá">
                                                        <input type="checkbox" id="table-city-bogota">
                                                        <span class="option-text">Bogotá</span>
                                                    </div>
                                                    <div class="select-option" data-value="Medellín">
                                                        <input type="checkbox" id="table-city-medellin">
                                                        <span class="option-text">Medellín</span>
                                                    </div>
                                                    <div class="select-option" data-value="Cali">
                                                        <input type="checkbox" id="table-city-cali">
                                                        <span class="option-text">Cali</span>
                                                    </div>
                                                    <div class="select-option" data-value="Ciudad de México">
                                                        <input type="checkbox" id="table-city-mexico">
                                                        <span class="option-text">Ciudad de México</span>
                                                    </div>
                                                    <div class="select-option" data-value="Buenos Aires">
                                                        <input type="checkbox" id="table-city-buenos-aires">
                                                        <span class="option-text">Buenos Aires</span>
                                                    </div>
                                                    <div class="select-option" data-value="Santiago">
                                                        <input type="checkbox" id="table-city-santiago">
                                                        <span class="option-text">Santiago</span>
                                                    </div>
                                                    <div class="select-option" data-value="Lima">
                                                        <input type="checkbox" id="table-city-lima">
                                                        <span class="option-text">Lima</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Dominio</label>
                                            <div class="custom-select" id="table-domain-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar dominios</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-domain-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Condiciones en el ambiente de trabajo">
                                                        <input type="checkbox" id="table-domain-condiciones">
                                                        <span class="option-text">Condiciones en el ambiente de trabajo</span>
                                                    </div>
                                                    <div class="select-option" data-value="Carga de trabajo">
                                                        <input type="checkbox" id="table-domain-carga">
                                                        <span class="option-text">Carga de trabajo</span>
                                                    </div>
                                                    <div class="select-option" data-value="Falta de control sobre el trabajo">
                                                        <input type="checkbox" id="table-domain-control">
                                                        <span class="option-text">Falta de control sobre el trabajo</span>
                                                    </div>
                                                    <div class="select-option" data-value="Jornada de trabajo">
                                                        <input type="checkbox" id="table-domain-jornada">
                                                        <span class="option-text">Jornada de trabajo</span>
                                                    </div>
                                                    <div class="select-option" data-value="Liderazgo">
                                                        <input type="checkbox" id="table-domain-liderazgo">
                                                        <span class="option-text">Liderazgo</span>
                                                    </div>
                                                    <div class="select-option" data-value="Relaciones en el trabajo">
                                                        <input type="checkbox" id="table-domain-relaciones">
                                                        <span class="option-text">Relaciones en el trabajo</span>
                                                    </div>
                                                    <div class="select-option" data-value="Violencia laboral">
                                                        <input type="checkbox" id="table-domain-violencia">
                                                        <span class="option-text">Violencia laboral</span>
                                                    </div>
                                                    <div class="select-option" data-value="Reconocimiento del desempeño">
                                                        <input type="checkbox" id="table-domain-reconocimiento">
                                                        <span class="option-text">Reconocimiento del desempeño</span>
                                                    </div>
                                                    <div class="select-option" data-value="Sentido de pertenencia">
                                                        <input type="checkbox" id="table-domain-pertenencia">
                                                        <span class="option-text">Sentido de pertenencia</span>
                                                    </div>
                                                    <div class="select-option" data-value="Estabilidad y justicia organizacional">
                                                        <input type="checkbox" id="table-domain-estabilidad">
                                                        <span class="option-text">Estabilidad y justicia organizacional</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="filter-group">
                                            <label class="filter-label">Dimensión</label>
                                            <div class="custom-select" id="table-dimension-select">
                                                <div class="select-trigger">
                                                    <span class="select-text">Seleccionar dimensiones</span>
                                                    <i class="fas fa-chevron-down select-arrow"></i>
                                                </div>
                                                <div class="select-dropdown">
                                                    <div class="select-option" data-value="todos">
                                                        <input type="checkbox" id="table-dimension-todos" checked>
                                                        <span class="option-text">Todos</span>
                                                    </div>
                                                    <div class="select-option" data-value="Condiciones físicas, seguridad y comodidad">
                                                        <input type="checkbox" id="table-dimension-condiciones">
                                                        <span class="option-text">Condiciones físicas, seguridad y comodidad</span>
                                                    </div>
                                                    <div class="select-option" data-value="Exigencias cuantitativas, exigencias mentales y emocionales">
                                                        <input type="checkbox" id="table-dimension-exigencias">
                                                        <span class="option-text">Exigencias cuantitativas, exigencias mentales y emocionales</span>
                                                    </div>
                                                    <div class="select-option" data-value="Claridad de rol, autonomía, reconocimiento">
                                                        <input type="checkbox" id="table-dimension-claridad">
                                                        <span class="option-text">Claridad de rol, autonomía, reconocimiento</span>
                                                    </div>
                                                    <div class="select-option" data-value="Duración, distribución y pausas">
                                                        <input type="checkbox" id="table-dimension-duracion">
                                                        <span class="option-text">Duración, distribución y pausas</span>
                                                    </div>
                                                    <div class="select-option" data-value="Estilo de liderazgo, comunicación, apoyo">
                                                        <input type="checkbox" id="table-dimension-liderazgo">
                                                        <span class="option-text">Estilo de liderazgo, comunicación, apoyo</span>
                                                    </div>
                                                    <div class="select-option" data-value="Comunicación, colaboración, confianza, respeto">
                                                        <input type="checkbox" id="table-dimension-comunicacion">
                                                        <span class="option-text">Comunicación, colaboración, confianza, respeto</span>
                                                    </div>
                                                    <div class="select-option" data-value="Maltrato, acoso, discriminación, hostigamiento">
                                                        <input type="checkbox" id="table-dimension-maltrato">
                                                        <span class="option-text">Maltrato, acoso, discriminación, hostigamiento</span>
                                                    </div>
                                                    <div class="select-option" data-value="Estímulo, desarrollo y valoración">
                                                        <input type="checkbox" id="table-dimension-estimulo">
                                                        <span class="option-text">Estímulo, desarrollo y valoración</span>
                                                    </div>
                                                    <div class="select-option" data-value="Orgullo, compromiso y participación">
                                                        <input type="checkbox" id="table-dimension-orgullo">
                                                        <span class="option-text">Orgullo, compromiso y participación</span>
                                                    </div>
                                                    <div class="select-option" data-value="Equidad, respeto y seguridad laboral">
                                                        <input type="checkbox" id="table-dimension-equidad">
                                                        <span class="option-text">Equidad, respeto y seguridad laboral</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>

                                        <div class="filter-actions">
                                            <button class="apply-filters-btn" id="apply-table-filters-btn">
                                                <i class="far fa-check"></i>
                                                Aplicar Filtros
                                            </button>
                                            <button class="clear-filters-btn" id="clear-table-filters-btn">
                                                <i class="far fa-times"></i>
                                                Limpiar
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Filters Overlay -->
                                    <div class="filters-overlay" id="table-filters-overlay"></div>
                                </div>
                            
                            <div class="tab-panel" id="dimension-panel">
                                <div class="panel-content">
                                    <div class="table-header">
                                        <h3>Análisis por Dimensiones NOM-035</h3>
                                        <div class="table-controls">
                                            <!-- Campo de búsqueda desplegable -->
                                            <div id="dimension-search-container" style="display: none; position: relative;">
                                                <input type="text" id="dimension-search" placeholder="Buscar en dimensiones..." 
                                                       style="padding: 8px 12px; border: 1px solid var(--ubits-border-1); border-radius: 6px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); width: 250px; font-size: 14px;">
                                                <button id="close-dimension-search" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--ubits-fg-1-medium); cursor: pointer;">
                                                    <i class="far fa-times"></i>
                                                </button>
                                            </div>
                                            <button id="dimension-search-btn" class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" style="width: 32px; height: 32px;">
                                                <i class="far fa-search"></i>
                                            </button>
                                            <button id="dimension-filters-btn" class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" style="width: 32px; height: 32px;">
                                                <i class="far fa-filter"></i>
                                                <span class="filter-badge" id="dimension-filter-badge" style="display: none;">0</span>
                                            </button>
                                        </div>
                                    </div>
                                    <table class="results-table" id="dimension-results-table">
                                            <thead>
                                                <tr>
                                                    <th>Dimensión</th>
                                                    <th>Dominio</th>
                                                    <th>Total Usuarios en Riesgo</th>
                                                    <th>% Colaboradores Afectados</th>
                                                    <th>Nivel de Riesgo</th>
                                                </tr>
                                            </thead>
                                            <tbody id="dimension-results-tbody">
                                                <!-- Las dimensiones se cargarán dinámicamente -->
                                            </tbody>
                                        </table>
                                    
                                    <!-- Filters Side Panel -->
                                    <div class="filters-side-panel" id="dimension-filters-side-panel">
                                        <div class="filters-header">
                                            <h3>Filtros</h3>
                                            <button class="close-filters-btn" id="close-dimension-filters-btn">
                                                <i class="far fa-times"></i>
                                            </button>
                                        </div>
                                        <div class="filters-content">
                                            <div class="filter-group">
                                                <label class="filter-label">Nivel de Riesgo</label>
                                                <div class="custom-select" id="dimension-risk-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar niveles</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-risk-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="nulo">
                                                            <input type="checkbox" id="dimension-risk-nulo">
                                                            <div class="risk-indicator nulo"></div>
                                                            <span class="option-text">Nulo</span>
                                                        </div>
                                                        <div class="select-option" data-value="bajo">
                                                            <input type="checkbox" id="dimension-risk-bajo">
                                                            <div class="risk-indicator bajo"></div>
                                                            <span class="option-text">Bajo</span>
                                                        </div>
                                                        <div class="select-option" data-value="medio">
                                                            <input type="checkbox" id="dimension-risk-medio">
                                                            <div class="risk-indicator medio"></div>
                                                            <span class="option-text">Medio</span>
                                                        </div>
                                                        <div class="select-option" data-value="alto">
                                                            <input type="checkbox" id="dimension-risk-alto">
                                                            <div class="risk-indicator alto"></div>
                                                            <span class="option-text">Alto</span>
                                                        </div>
                                                        <div class="select-option" data-value="muy-alto">
                                                            <input type="checkbox" id="dimension-risk-muy-alto">
                                                            <div class="risk-indicator muy-alto"></div>
                                                            <span class="option-text">Muy Alto</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Área</label>
                                                <div class="custom-select" id="dimension-area-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar áreas</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-area-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="ventas">
                                                            <input type="checkbox" id="dimension-area-ventas">
                                                            <span class="option-text">Ventas</span>
                                                        </div>
                                                        <div class="select-option" data-value="marketing">
                                                            <input type="checkbox" id="dimension-area-marketing">
                                                            <span class="option-text">Marketing</span>
                                                        </div>
                                                        <div class="select-option" data-value="desarrollo">
                                                            <input type="checkbox" id="dimension-area-desarrollo">
                                                            <span class="option-text">Desarrollo</span>
                                                        </div>
                                                        <div class="select-option" data-value="recursos-humanos">
                                                            <input type="checkbox" id="dimension-area-recursos-humanos">
                                                            <span class="option-text">Recursos Humanos</span>
                                                        </div>
                                                        <div class="select-option" data-value="finanzas">
                                                            <input type="checkbox" id="dimension-area-finanzas">
                                                            <span class="option-text">Finanzas</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Cargo</label>
                                                <div class="custom-select" id="dimension-position-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar cargos</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-position-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="gerente">
                                                            <input type="checkbox" id="dimension-position-gerente">
                                                            <span class="option-text">Gerente</span>
                                                        </div>
                                                        <div class="select-option" data-value="coordinador">
                                                            <input type="checkbox" id="dimension-position-coordinador">
                                                            <span class="option-text">Coordinador</span>
                                                        </div>
                                                        <div class="select-option" data-value="analista">
                                                            <input type="checkbox" id="dimension-position-analista">
                                                            <span class="option-text">Analista</span>
                                                        </div>
                                                        <div class="select-option" data-value="asistente">
                                                            <input type="checkbox" id="dimension-position-asistente">
                                                            <span class="option-text">Asistente</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Género</label>
                                                <div class="custom-select" id="dimension-gender-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar géneros</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-gender-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="masculino">
                                                            <input type="checkbox" id="dimension-gender-masculino">
                                                            <span class="option-text">Masculino</span>
                                                        </div>
                                                        <div class="select-option" data-value="femenino">
                                                            <input type="checkbox" id="dimension-gender-femenino">
                                                            <span class="option-text">Femenino</span>
                                                        </div>
                                                        <div class="select-option" data-value="otro">
                                                            <input type="checkbox" id="dimension-gender-otro">
                                                            <span class="option-text">Otro</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Estado Civil</label>
                                                <div class="custom-select" id="dimension-marital-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar estados</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-marital-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="soltero">
                                                            <input type="checkbox" id="dimension-marital-soltero">
                                                            <span class="option-text">Soltero</span>
                                                        </div>
                                                        <div class="select-option" data-value="casado">
                                                            <input type="checkbox" id="dimension-marital-casado">
                                                            <span class="option-text">Casado</span>
                                                        </div>
                                                        <div class="select-option" data-value="divorciado">
                                                            <input type="checkbox" id="dimension-marital-divorciado">
                                                            <span class="option-text">Divorciado</span>
                                                        </div>
                                                        <div class="select-option" data-value="viudo">
                                                            <input type="checkbox" id="dimension-marital-viudo">
                                                            <span class="option-text">Viudo</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Rango de Edad</label>
                                                <div class="custom-select" id="dimension-age-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar rangos</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-age-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="18-25">
                                                            <input type="checkbox" id="dimension-age-18-25">
                                                            <span class="option-text">18-25 años</span>
                                                        </div>
                                                        <div class="select-option" data-value="26-35">
                                                            <input type="checkbox" id="dimension-age-26-35">
                                                            <span class="option-text">26-35 años</span>
                                                        </div>
                                                        <div class="select-option" data-value="36-45">
                                                            <input type="checkbox" id="dimension-age-36-45">
                                                            <span class="option-text">36-45 años</span>
                                                        </div>
                                                        <div class="select-option" data-value="46-55">
                                                            <input type="checkbox" id="dimension-age-46-55">
                                                            <span class="option-text">46-55 años</span>
                                                        </div>
                                                        <div class="select-option" data-value="56+">
                                                            <input type="checkbox" id="dimension-age-56+">
                                                            <span class="option-text">56+ años</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">País</label>
                                                <div class="custom-select" id="dimension-country-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar países</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-country-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="colombia">
                                                            <input type="checkbox" id="dimension-country-colombia">
                                                            <span class="option-text">Colombia</span>
                                                        </div>
                                                        <div class="select-option" data-value="mexico">
                                                            <input type="checkbox" id="dimension-country-mexico">
                                                            <span class="option-text">México</span>
                                                        </div>
                                                        <div class="select-option" data-value="argentina">
                                                            <input type="checkbox" id="dimension-country-argentina">
                                                            <span class="option-text">Argentina</span>
                                                        </div>
                                                        <div class="select-option" data-value="chile">
                                                            <input type="checkbox" id="dimension-country-chile">
                                                            <span class="option-text">Chile</span>
                                                        </div>
                                                        <div class="select-option" data-value="peru">
                                                            <input type="checkbox" id="dimension-country-peru">
                                                            <span class="option-text">Perú</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Ciudad</label>
                                                <div class="custom-select" id="dimension-city-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar ciudades</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dimension-city-todos" checked>
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="bogota">
                                                            <input type="checkbox" id="dimension-city-bogota">
                                                            <span class="option-text">Bogotá</span>
                                                        </div>
                                                        <div class="select-option" data-value="medellin">
                                                            <input type="checkbox" id="dimension-city-medellin">
                                                            <span class="option-text">Medellín</span>
                                                        </div>
                                                        <div class="select-option" data-value="cali">
                                                            <input type="checkbox" id="dimension-city-cali">
                                                            <span class="option-text">Cali</span>
                                                        </div>
                                                        <div class="select-option" data-value="barranquilla">
                                                            <input type="checkbox" id="dimension-city-barranquilla">
                                                            <span class="option-text">Barranquilla</span>
                                                        </div>
                                                        <div class="select-option" data-value="cartagena">
                                                            <input type="checkbox" id="dimension-city-cartagena">
                                                            <span class="option-text">Cartagena</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-actions">
                                                <button class="ubits-button ubits-button--secondary ubits-button--sm" id="dimension-clear-filters-btn">
                                                    <i class="far fa-times"></i>
                                                    <span>Limpiar Filtros</span>
                                                </button>
                                                <button class="ubits-button ubits-button--primary ubits-button--sm" id="dimension-apply-filters-btn">
                                                    <i class="far fa-check"></i>
                                                    <span>Aplicar Filtros</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Overlay para cerrar filtros -->
                                    <div class="filters-overlay" id="dimension-filters-overlay"></div>
                                </div>
                            </div>
                            
                            <div class="tab-panel" id="individual-panel">
                                <div class="panel-content">
                                    <h3>Contenido Individual</h3>
                                    <p>Aquí va el contenido del tab Individual con análisis individual de participantes.</p>
                                </div>
                            </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script src="components/sidebar.js"></script>
    <script src="components/tab-bar.js"></script>
    <script src="components/floating-menu.js"></script>
    <script src="components/profile-menu.js"></script>
    <script src="components/button.js"></script>
    <script src="components/input.js"></script>
    <script src="profile.js"></script>

    <script>

        // Funciones para el dropdown de descarga
        function toggleDownloadDropdown() {
            const dropdown = document.getElementById('download-dropdown-content');
            dropdown.classList.toggle('show');
        }

        function downloadCSV() {
            alert('Descargando CSV de resultados de entorno laboral...');
            closeDownloadDropdown();
        }

        function downloadPDF() {
            alert('Descargando PDF de resultados de entorno laboral...');
            closeDownloadDropdown();
        }

        function downloadExcel() {
            alert('Descargando Excel de resultados de entorno laboral...');
            closeDownloadDropdown();
        }

        function closeDownloadDropdown() {
            const dropdown = document.getElementById('download-dropdown-content');
            dropdown.classList.remove('show');
        }

        // Cerrar dropdown al hacer clic fuera
        document.addEventListener('click', function(event) {
            const dropdown = document.querySelector('.download-dropdown');
            if (dropdown && !dropdown.contains(event.target)) {
                closeDownloadDropdown();
            }
        });

        // Funciones para los tabs
        function initializeTabs() {
            console.log('Inicializando tabs...');
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanels = document.querySelectorAll('.tab-panel');
            
            console.log('Botones de tab encontrados:', tabButtons.length);
            console.log('Paneles de tab encontrados:', tabPanels.length);

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.getAttribute('data-tab');
                    
                    // Remover clase active de todos los botones
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Remover clase active de todos los paneles
                    tabPanels.forEach(panel => panel.classList.remove('active'));
                    
                    // Agregar clase active al botón clickeado
                    button.classList.add('active');
                    
                    // Mostrar el panel correspondiente
                    const targetPanel = document.getElementById(`${targetTab}-panel`);
                    if (targetPanel) {
                        targetPanel.classList.add('active');
                        
                        // Cargar contenido específico según el tab
                        console.log('Tab activado:', targetTab);
                        if (targetTab === 'dimension') {
                            console.log('Cargando dimensiones desde initializeTabs...');
                            loadDimensionResults();
                        }
                    }
                });
            });
        }

        // Funciones para búsqueda y filtros de la tabla
        function initializeTableFilters() {
            const searchBtn = document.getElementById('table-search-btn');
            const searchContainer = document.getElementById('table-search-container');
            const searchInput = document.getElementById('table-search');
            const closeSearch = document.getElementById('close-table-search');
            const filtersBtn = document.getElementById('table-filters-btn');
            const filtersSidePanel = document.getElementById('table-filters-side-panel');
            const filtersOverlay = document.getElementById('table-filters-overlay');
            const closeFiltersBtn = document.getElementById('close-table-filters-btn');
            const applyFiltersBtn = document.getElementById('apply-table-filters-btn');
            const clearFiltersBtn = document.getElementById('clear-table-filters-btn');

            // Funcionalidad de búsqueda desplegable
            searchBtn.addEventListener('click', () => {
                searchContainer.style.display = 'block';
                searchInput.focus();
            });

            closeSearch.addEventListener('click', () => {
                searchContainer.style.display = 'none';
                searchInput.value = '';
                applyTableFilters();
            });

            // Abrir panel de filtros
            filtersBtn.addEventListener('click', () => {
                filtersSidePanel.classList.add('show');
                filtersOverlay.classList.add('show');
            });

            // Cerrar panel de filtros
            closeFiltersBtn.addEventListener('click', closeTableFiltersPanel);
            filtersOverlay.addEventListener('click', closeTableFiltersPanel);

            // Aplicar filtros
            applyFiltersBtn.addEventListener('click', () => {
                applyTableFilters();
                closeTableFiltersPanel();
            });

            // Limpiar filtros
            clearFiltersBtn.addEventListener('click', clearTableFilters);

            // Búsqueda en tiempo real
            searchInput.addEventListener('input', applyTableFilters);

            // Configurar selects personalizados
            setupTableCustomSelects();
        }

        // Funciones para búsqueda y filtros de la tabla de dimensiones
        function initializeDimensionFilters() {
            const searchBtn = document.getElementById('dimension-search-btn');
            const searchContainer = document.getElementById('dimension-search-container');
            const searchInput = document.getElementById('dimension-search');
            const closeSearch = document.getElementById('close-dimension-search');
            const filtersBtn = document.getElementById('dimension-filters-btn');
            const filtersSidePanel = document.getElementById('dimension-filters-side-panel');
            const filtersOverlay = document.getElementById('dimension-filters-overlay');
            const closeFiltersBtn = document.getElementById('close-dimension-filters-btn');
            const applyFiltersBtn = document.getElementById('dimension-apply-filters-btn');
            const clearFiltersBtn = document.getElementById('dimension-clear-filters-btn');

            // Funcionalidad de búsqueda desplegable
            searchBtn.addEventListener('click', () => {
                searchContainer.style.display = 'block';
                searchInput.focus();
            });

            closeSearch.addEventListener('click', () => {
                searchContainer.style.display = 'none';
                searchInput.value = '';
                applyDimensionFilters();
            });

            // Abrir panel de filtros
            filtersBtn.addEventListener('click', () => {
                filtersSidePanel.classList.add('show');
                filtersOverlay.classList.add('show');
            });

            // Cerrar panel de filtros
            closeFiltersBtn.addEventListener('click', closeDimensionFiltersPanel);
            filtersOverlay.addEventListener('click', closeDimensionFiltersPanel);

            // Aplicar filtros
            applyFiltersBtn.addEventListener('click', () => {
                applyDimensionFilters();
                closeDimensionFiltersPanel();
            });

            // Limpiar filtros
            clearFiltersBtn.addEventListener('click', clearDimensionFilters);

            // Búsqueda en tiempo real
            searchInput.addEventListener('input', applyDimensionFilters);

            // Configurar selects personalizados
            setupDimensionCustomSelects();
        }

        function closeDimensionFiltersPanel() {
            document.getElementById('dimension-filters-side-panel').classList.remove('show');
            document.getElementById('dimension-filters-overlay').classList.remove('show');
        }

        function applyDimensionFilters() {
            const searchTerm = document.getElementById('dimension-search').value.toLowerCase();
            const riskFilters = getDimensionSelectedValues('dimension-risk-select');
            const areaFilters = getDimensionSelectedValues('dimension-area-select');
            const positionFilters = getDimensionSelectedValues('dimension-position-select');
            const genderFilters = getDimensionSelectedValues('dimension-gender-select');
            const maritalFilters = getDimensionSelectedValues('dimension-marital-select');
            const ageFilters = getDimensionSelectedValues('dimension-age-select');
            const countryFilters = getDimensionSelectedValues('dimension-country-select');
            const cityFilters = getDimensionSelectedValues('dimension-city-select');

            const tableRows = document.querySelectorAll('#dimension-results-table tbody tr');
            
            tableRows.forEach(row => {
                const dimensionText = row.querySelector('.dimension-cell')?.textContent.toLowerCase() || '';
                const domainText = row.querySelector('.dimension-domain-info')?.textContent.toLowerCase() || '';
                const riskBadge = row.querySelector('.risk-badge');
                const riskLevel = riskBadge ? riskBadge.textContent.toLowerCase().trim() : '';

                // Filtro de búsqueda
                const matchesSearch = searchTerm === '' || 
                    dimensionText.includes(searchTerm) ||
                    domainText.includes(searchTerm);

                // Filtro de nivel de riesgo
                const matchesRisk = riskFilters.length === 0 || riskFilters.includes('todos') || riskFilters.includes(riskLevel);

                // Mostrar/ocultar fila basado en filtros
                const shouldShow = matchesSearch && matchesRisk;
                row.style.display = shouldShow ? '' : 'none';
            });

            // Actualizar contador de filtros activos
            updateDimensionFilterBadge();
        }

        function clearDimensionFilters() {
            // Limpiar búsqueda
            document.getElementById('dimension-search').value = '';
            document.getElementById('dimension-search-container').style.display = 'none';

            // Resetear todos los selects a "Todos"
            const selects = ['dimension-risk-select', 'dimension-area-select', 'dimension-position-select', 
                           'dimension-gender-select', 'dimension-marital-select', 'dimension-age-select', 
                           'dimension-country-select', 'dimension-city-select'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                const todosOption = select.querySelector('[data-value="todos"] input');
                if (todosOption) {
                    todosOption.checked = true;
                }
                // Desmarcar todas las otras opciones
                select.querySelectorAll('.select-option:not([data-value="todos"]) input').forEach(input => {
                    input.checked = false;
                });
                // Actualizar texto del trigger
                const trigger = select.querySelector('.select-trigger .select-text');
                if (trigger) {
                    trigger.textContent = 'Seleccionar ' + selectId.replace('dimension-', '').replace('-select', 's');
                }
            });

            // Aplicar filtros (que ahora están limpios)
            applyDimensionFilters();
        }

        function getDimensionSelectedValues(selectId) {
            const select = document.getElementById(selectId);
            const checkedInputs = select.querySelectorAll('input:checked');
            return Array.from(checkedInputs).map(input => input.closest('.select-option').dataset.value);
        }

        function updateDimensionFilterBadge() {
            const badge = document.getElementById('dimension-filter-badge');
            let activeFilters = 0;

            // Contar filtros activos (excluyendo "Todos")
            const selects = ['dimension-risk-select', 'dimension-area-select', 'dimension-position-select', 
                           'dimension-gender-select', 'dimension-marital-select', 'dimension-age-select', 
                           'dimension-country-select', 'dimension-city-select'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                const checkedInputs = select.querySelectorAll('input:checked:not([id$="-todos"])');
                if (checkedInputs.length > 0) {
                    activeFilters++;
                }
            });

            // Contar búsqueda activa
            const searchTerm = document.getElementById('dimension-search').value.trim();
            if (searchTerm !== '') {
                activeFilters++;
            }

            if (activeFilters > 0) {
                badge.textContent = activeFilters;
                badge.style.display = 'inline';
            } else {
                badge.style.display = 'none';
            }
        }

        function setupDimensionCustomSelects() {
            const selects = ['dimension-risk-select', 'dimension-area-select', 'dimension-position-select', 
                           'dimension-gender-select', 'dimension-marital-select', 'dimension-age-select', 
                           'dimension-country-select', 'dimension-city-select'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                const trigger = select.querySelector('.select-trigger');
                const dropdown = select.querySelector('.select-dropdown');
                const options = select.querySelectorAll('.select-option');

                trigger.addEventListener('click', () => {
                    select.classList.toggle('open');
                });

                options.forEach(option => {
                    const input = option.querySelector('input');
                    input.addEventListener('change', () => {
                        if (input.checked) {
                            // Si se selecciona "Todos", desmarcar los demás
                            if (option.dataset.value === 'todos') {
                                options.forEach(opt => {
                                    if (opt !== option) {
                                        opt.querySelector('input').checked = false;
                                    }
                                });
                            } else {
                                // Si se selecciona una opción específica, desmarcar "Todos"
                                const todosOption = select.querySelector('[data-value="todos"] input');
                                if (todosOption) {
                                    todosOption.checked = false;
                                }
                            }
                        }
                        
                        // Actualizar texto del trigger
                        updateDimensionSelectTrigger(select);
                        applyDimensionFilters();
                    });
                });

                // Cerrar dropdown al hacer clic fuera
                document.addEventListener('click', (e) => {
                    if (!select.contains(e.target)) {
                        select.classList.remove('open');
                    }
                });
            });
        }

        function updateDimensionSelectTrigger(select) {
            const trigger = select.querySelector('.select-trigger .select-text');
            const checkedInputs = select.querySelectorAll('input:checked:not([id$="-todos"])');
            
            if (checkedInputs.length === 0) {
                const selectId = select.id;
                const label = selectId.replace('dimension-', '').replace('-select', 's');
                trigger.textContent = 'Seleccionar ' + label;
            } else if (checkedInputs.length === 1) {
                trigger.textContent = checkedInputs[0].closest('.select-option').querySelector('.option-text').textContent;
            } else {
                trigger.textContent = `${checkedInputs.length} seleccionados`;
            }
        }

        function closeTableFiltersPanel() {
            document.getElementById('table-filters-side-panel').classList.remove('show');
            document.getElementById('table-filters-overlay').classList.remove('show');
        }

        function applyTableFilters() {
            const searchTerm = document.getElementById('table-search').value.toLowerCase();
            const riskFilters = getTableSelectedValues('table-risk-select');
            const categoryFilters = getTableSelectedValues('table-category-select');
            const areaFilters = getTableSelectedValues('table-area-select');
            const positionFilters = getTableSelectedValues('table-position-select');
            const genderFilters = getTableSelectedValues('table-gender-select');
            const maritalFilters = getTableSelectedValues('table-marital-select');
            const ageFilters = getTableSelectedValues('table-age-select');
            const countryFilters = getTableSelectedValues('table-country-select');
            const cityFilters = getTableSelectedValues('table-city-select');
            const domainFilters = getTableSelectedValues('table-domain-select');
            const dimensionFilters = getTableSelectedValues('table-dimension-select');

            const tableRows = document.querySelectorAll('.results-table tbody tr');
            
            tableRows.forEach(row => {
                const categoryText = row.querySelector('.category-cell')?.textContent.toLowerCase() || '';
                const domainText = row.querySelector('td:nth-child(2)')?.textContent.toLowerCase() || '';
                const dimensionText = row.querySelector('td:nth-child(3)')?.textContent.toLowerCase() || '';
                const riskBadge = row.querySelector('.risk-badge');
                const riskLevel = riskBadge ? riskBadge.textContent.toLowerCase().trim() : '';

                // Filtro de búsqueda
                const matchesSearch = searchTerm === '' || 
                    categoryText.includes(searchTerm) ||
                    domainText.includes(searchTerm) ||
                    dimensionText.includes(searchTerm);

                // Filtro de nivel de riesgo
                const matchesRisk = riskFilters.length === 0 || riskFilters.includes('todos') || riskFilters.includes(riskLevel);

                // Filtro de categoría
                const matchesCategory = categoryFilters.length === 0 || categoryFilters.includes('todos') || 
                    (categoryText.includes('ambiente') && categoryFilters.includes('ambiente')) ||
                    (categoryText.includes('factores') && categoryFilters.includes('factores')) ||
                    (categoryText.includes('organización') && categoryFilters.includes('organizacion')) ||
                    (categoryText.includes('liderazgo') && categoryFilters.includes('liderazgo')) ||
                    (categoryText.includes('violencia') && categoryFilters.includes('violencia')) ||
                    (categoryText.includes('entorno') && categoryFilters.includes('entorno'));

                // Filtro de dominio
                const matchesDomain = domainFilters.length === 0 || domainFilters.includes('todos') || 
                    domainFilters.some(filter => domainText.includes(filter.toLowerCase()));

                // Filtro de dimensión
                const matchesDimension = dimensionFilters.length === 0 || dimensionFilters.includes('todos') || 
                    dimensionFilters.some(filter => dimensionText.includes(filter.toLowerCase()));

                // Para filtros demográficos, no ocultamos filas, sino que actualizamos los números
                const hasDemographicFilters = areaFilters.length > 0 || positionFilters.length > 0 || 
                    genderFilters.length > 0 || maritalFilters.length > 0 || ageFilters.length > 0 || 
                    countryFilters.length > 0 || cityFilters.length > 0;

                if (hasDemographicFilters) {
                    // Actualizar números basados en filtros demográficos
                    updateRowNumbers(row, areaFilters, positionFilters, genderFilters, maritalFilters, 
                        ageFilters, countryFilters, cityFilters);
                } else {
                    // Restaurar números originales si no hay filtros demográficos
                    restoreOriginalNumbers(row);
                }

                // Solo ocultar filas para filtros no demográficos
                if (matchesSearch && matchesRisk && matchesCategory && matchesDomain && matchesDimension) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });

            updateTableFilterBadge();
        }

        // Función auxiliar para verificar filtros demográficos
        function checkDemographicFilter(filters, value) {
            return filters.includes(value);
        }

        // Función para actualizar números de fila basados en filtros demográficos
        function updateRowNumbers(row, areaFilters, positionFilters, genderFilters, maritalFilters, ageFilters, countryFilters, cityFilters) {
            const categoryText = row.querySelector('.category-cell')?.textContent.toLowerCase() || '';
            const domainText = row.querySelector('td:nth-child(2)')?.textContent.toLowerCase() || '';
            
            // Obtener datos demográficos simulados para esta fila
            const simulatedArea = getSimulatedArea(categoryText, domainText);
            const simulatedPosition = getSimulatedPosition(categoryText, domainText);
            const simulatedGender = getSimulatedGender(categoryText, domainText);
            const simulatedMarital = getSimulatedMaritalStatus(categoryText, domainText);
            const simulatedAge = getSimulatedAge(categoryText, domainText);
            const simulatedCountry = getSimulatedCountry(categoryText, domainText);
            const simulatedCity = getSimulatedCity(categoryText, domainText);

            // Verificar si esta fila coincide con los filtros demográficos
            const matchesArea = areaFilters.length === 0 || areaFilters.includes('todos') || areaFilters.includes(simulatedArea);
            const matchesPosition = positionFilters.length === 0 || positionFilters.includes('todos') || positionFilters.includes(simulatedPosition);
            const matchesGender = genderFilters.length === 0 || genderFilters.includes('todos') || genderFilters.includes(simulatedGender);
            const matchesMarital = maritalFilters.length === 0 || maritalFilters.includes('todos') || maritalFilters.includes(simulatedMarital);
            const matchesAge = ageFilters.length === 0 || ageFilters.includes('todos') || ageFilters.includes(simulatedAge);
            const matchesCountry = countryFilters.length === 0 || countryFilters.includes('todos') || countryFilters.includes(simulatedCountry);
            const matchesCity = cityFilters.length === 0 || cityFilters.includes('todos') || cityFilters.includes(simulatedCity);

            const matchesAllDemographic = matchesArea && matchesPosition && matchesGender && matchesMarital && matchesAge && matchesCountry && matchesCity;

            // Actualizar números basados en si coincide con los filtros
            const riskCountCell = row.querySelector('.risk-count');
            const percentageCell = row.querySelector('.percentage');
            
            if (riskCountCell && percentageCell) {
                if (matchesAllDemographic) {
                    // Si coincide con los filtros, mantener números originales
                    if (!riskCountCell.dataset.originalValue) {
                        riskCountCell.dataset.originalValue = riskCountCell.textContent;
                        percentageCell.dataset.originalValue = percentageCell.textContent;
                    }
                } else {
                    // Si no coincide, reducir números (simular que hay menos usuarios en riesgo)
                    if (!riskCountCell.dataset.originalValue) {
                        riskCountCell.dataset.originalValue = riskCountCell.textContent;
                        percentageCell.dataset.originalValue = percentageCell.textContent;
                    }
                    
                    const originalCount = parseInt(riskCountCell.dataset.originalValue);
                    const originalPercentage = parseFloat(percentageCell.dataset.originalValue);
                    
                    // Reducir a aproximadamente 30-70% del original para simular filtrado
                    const reductionFactor = 0.3 + Math.random() * 0.4; // Entre 30% y 70%
                    const newCount = Math.max(0, Math.floor(originalCount * reductionFactor));
                    const newPercentage = Math.max(0, (originalPercentage * reductionFactor).toFixed(1));
                    
                    riskCountCell.textContent = newCount;
                    percentageCell.textContent = newPercentage + '%';
                }
            }
        }


        // Función para toggle de filas de categoría
        function toggleCategoryRow(row) {
            const chevron = row.querySelector('.category-chevron');
            const categoryName = row.querySelector('.category-header-row span').textContent;
            
            // Obtener las celdas de dominio y dimensión del encabezado
            const domainCell = row.querySelector('.category-domain-info');
            const dimensionCell = row.querySelector('.category-dimension-info');
            
            // Encontrar todas las filas de detalle de esta categoría
            const allRows = Array.from(document.querySelectorAll('.results-table tbody tr'));
            const currentIndex = allRows.indexOf(row);
            const detailRows = [];
            
            // Buscar filas de detalle que siguen a esta fila de resumen
            for (let i = currentIndex + 1; i < allRows.length; i++) {
                const nextRow = allRows[i];
                if (nextRow.classList.contains('category-detail')) {
                    detailRows.push(nextRow);
                } else if (nextRow.classList.contains('category-summary')) {
                    // Si encontramos otra fila de resumen, paramos
                    break;
                }
            }
            
            // Toggle de las filas de detalle
            const isOpen = detailRows.length > 0 && detailRows[0].style.display !== 'none';
            
            detailRows.forEach(detailRow => {
                detailRow.style.display = isOpen ? 'none' : '';
            });
            
            // Toggle de la información en el encabezado
            if (isOpen) {
                // Cerrar: mostrar información de dominio y dimensión en el encabezado
                if (domainCell) {
                    domainCell.style.color = '#374151';
                    domainCell.style.textShadow = 'none';
                }
                if (dimensionCell) {
                    dimensionCell.style.color = '#6b7280';
                    dimensionCell.style.textShadow = 'none';
                }
                row.classList.remove('open');
            } else {
                // Abrir: hacer texto transparente pero mantener el espacio
                if (domainCell) {
                    domainCell.style.color = 'transparent';
                    domainCell.style.textShadow = 'none';
                }
                if (dimensionCell) {
                    dimensionCell.style.color = 'transparent';
                    dimensionCell.style.textShadow = 'none';
                }
                row.classList.add('open');
            }
        }

        // Función para cargar dimensiones en la tabla de dimensiones
        function loadDimensionResults() {
            console.log('Cargando dimensiones...');
            const dimensionResultsTbody = document.getElementById('dimension-results-tbody');
            
            if (!dimensionResultsTbody) {
                console.error('No se encontró el elemento dimension-results-tbody');
                return;
            }
            
            console.log('Elemento tbody encontrado:', dimensionResultsTbody);
            
            // Datos de dimensiones simplificados para prueba
            const dimensionsData = [
                {
                    dimension: "Condiciones físicas, seguridad y comodidad",
                    domain: "Condiciones en el ambiente de trabajo",
                    riskCount: 12,
                    percentage: 8.0,
                    riskLevel: "bajo"
                },
                {
                    dimension: "Exigencias cuantitativas, mentales y emocionales",
                    domain: "Carga de trabajo",
                    riskCount: 43,
                    percentage: 28.7,
                    riskLevel: "medio"
                },
                {
                    dimension: "Duración, distribución y pausas",
                    domain: "Jornada de trabajo",
                    riskCount: 22,
                    percentage: 14.7,
                    riskLevel: "medio"
                },
                {
                    dimension: "Estilo de liderazgo, comunicación, apoyo y relaciones",
                    domain: "Liderazgo y Relaciones interpersonales",
                    riskCount: 26,
                    percentage: 17.3,
                    riskLevel: "bajo"
                },
                {
                    dimension: "Acoso, hostigamiento y violencia",
                    domain: "Violencia laboral",
                    riskCount: 5,
                    percentage: 3.3,
                    riskLevel: "nulo"
                },
                {
                    dimension: "Cultura organizacional y políticas",
                    domain: "Entorno organizacional",
                    riskCount: 77,
                    percentage: 51.3,
                    riskLevel: "alto"
                }
            ];
            
            // Crear HTML simplificado para debug
            let htmlContent = '';
            dimensionsData.forEach((dimension, index) => {
                htmlContent += `
                    <tr class="dimension-row">
                        <td class="dimension-cell">
                            <div class="dimension-header-row">
                                <div class="dimension-number">${index + 1}</div>
                                <span>${dimension.dimension}</span>
                            </div>
                        </td>
                        <td class="dimension-domain-info">${dimension.domain}</td>
                        <td class="risk-count">${dimension.riskCount}</td>
                        <td class="percentage">${dimension.percentage}%</td>
                        <td>
                            <div class="dimension-risk-info">
                                <span class="risk-badge ${dimension.riskLevel}">${getRiskLevelText(dimension.riskLevel)}</span>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            console.log('HTML generado:', htmlContent.substring(0, 200) + '...');
            
            dimensionResultsTbody.innerHTML = htmlContent;
            
            console.log('Dimensiones cargadas exitosamente. Filas creadas:', dimensionsData.length);
            console.log('Contenido del tbody después de cargar:', dimensionResultsTbody.innerHTML.substring(0, 200) + '...');
        }

        // Función para obtener el texto del nivel de riesgo
        function getRiskLevelText(riskLevel) {
            const riskLevels = {
                'nulo': 'Nulo',
                'bajo': 'Bajo',
                'medio': 'Medio',
                'alto': 'Alto',
                'muy-alto': 'Muy Alto'
            };
            return riskLevels[riskLevel] || 'Nulo';
        }

        // Función para actualizar números de dominio basados en filtros demográficos
        function updateDomainNumbers(domainItem, areaFilters, positionFilters, genderFilters, maritalFilters, ageFilters, countryFilters, cityFilters) {
            const riskCountCell = domainItem.querySelector('.risk-count');
            const percentageCell = domainItem.querySelector('.percentage');
            
            if (riskCountCell && percentageCell) {
                // Guardar valores originales si no están guardados
                if (!riskCountCell.dataset.originalValue) {
                    riskCountCell.dataset.originalValue = riskCountCell.textContent;
                }
                if (!percentageCell.dataset.originalValue) {
                    percentageCell.dataset.originalValue = percentageCell.textContent;
                }
                
                // Simular datos demográficos para este dominio
                const domainName = domainItem.querySelector('.domain-name')?.textContent || '';
                const simulatedArea = getSimulatedArea('', domainName);
                const simulatedPosition = getSimulatedPosition('', domainName);
                const simulatedGender = getSimulatedGender('', domainName);
                const simulatedMaritalStatus = getSimulatedMaritalStatus('', domainName);
                const simulatedAge = getSimulatedAge('', domainName);
                const simulatedCountry = getSimulatedCountry('', domainName);
                const simulatedCity = getSimulatedCity('', domainName);
                
                // Verificar si coincide con los filtros demográficos
                const matchesFilters = checkDemographicFilter(areaFilters, simulatedArea) &&
                    checkDemographicFilter(positionFilters, simulatedPosition) &&
                    checkDemographicFilter(genderFilters, simulatedGender) &&
                    checkDemographicFilter(maritalFilters, simulatedMaritalStatus) &&
                    checkDemographicFilter(ageFilters, simulatedAge) &&
                    checkDemographicFilter(countryFilters, simulatedCountry) &&
                    checkDemographicFilter(cityFilters, simulatedCity);
                
                if (matchesFilters) {
                    // Si coincide, mantener números originales
                    riskCountCell.textContent = riskCountCell.dataset.originalValue;
                    percentageCell.textContent = percentageCell.dataset.originalValue;
                } else {
                    // Si no coincide, reducir números (simulado)
                    const originalCount = parseInt(riskCountCell.dataset.originalValue) || 0;
                    const originalPercentage = parseFloat(percentageCell.dataset.originalValue) || 0;
                    
                    const newCount = Math.max(0, Math.floor(originalCount * 0.3)); // Reducir a 30%
                    const newPercentage = Math.max(0, Math.floor(originalPercentage * 0.3));
                    
                    riskCountCell.textContent = newCount.toString();
                    percentageCell.textContent = newPercentage + '%';
                }
            }
        }

        // Función para restaurar números originales de dominio
        function restoreDomainNumbers(domainItem) {
            const riskCountCell = domainItem.querySelector('.risk-count');
            const percentageCell = domainItem.querySelector('.percentage');
            
            if (riskCountCell && riskCountCell.dataset.originalValue) {
                riskCountCell.textContent = riskCountCell.dataset.originalValue;
            }
            if (percentageCell && percentageCell.dataset.originalValue) {
                percentageCell.textContent = percentageCell.dataset.originalValue;
            }
        }

        // Función para restaurar números originales
        function restoreOriginalNumbers(row) {
            const riskCountCell = row.querySelector('.risk-count');
            const percentageCell = row.querySelector('.percentage');
            
            if (riskCountCell) {
                if (riskCountCell.dataset.originalValue) {
                    riskCountCell.textContent = riskCountCell.dataset.originalValue;
                } else {
                    // Si no hay valor original guardado, usar el valor actual como original
                    riskCountCell.dataset.originalValue = riskCountCell.textContent;
                }
            }
            if (percentageCell) {
                if (percentageCell.dataset.originalValue) {
                    percentageCell.textContent = percentageCell.dataset.originalValue;
                } else {
                    // Si no hay valor original guardado, usar el valor actual como original
                    percentageCell.dataset.originalValue = percentageCell.textContent;
                }
            }
        }

        // Funciones para simular datos demográficos basados en categoría/dominio
        function getSimulatedArea(categoryText, domainText) {
            const areas = ['Recursos Humanos', 'Ventas', 'Marketing', 'Finanzas', 'Operaciones', 'Tecnología'];
            const hash = (categoryText + domainText).length;
            return areas[hash % areas.length];
        }

        function getSimulatedPosition(categoryText, domainText) {
            const positions = ['Gerente', 'Coordinador', 'Analista', 'Asistente', 'Especialista'];
            const hash = (categoryText + domainText).length + 1;
            return positions[hash % positions.length];
        }

        function getSimulatedGender(categoryText, domainText) {
            const genders = ['Masculino', 'Femenino', 'Masculino', 'Femenino', 'Masculino']; // Más masculino para simular
            const hash = (categoryText + domainText).length + 2;
            return genders[hash % genders.length];
        }

        function getSimulatedMaritalStatus(categoryText, domainText) {
            const statuses = ['Soltero', 'Casado', 'Divorciado', 'Viudo'];
            const hash = (categoryText + domainText).length + 3;
            return statuses[hash % statuses.length];
        }

        function getSimulatedAge(categoryText, domainText) {
            const ages = ['18-25', '26-35', '36-45', '46-55', '55+'];
            const hash = (categoryText + domainText).length + 4;
            return ages[hash % ages.length];
        }

        function getSimulatedCountry(categoryText, domainText) {
            const countries = ['Colombia', 'México', 'Argentina', 'Chile', 'Perú'];
            const hash = (categoryText + domainText).length + 5;
            return countries[hash % countries.length];
        }

        function getSimulatedCity(categoryText, domainText) {
            const cities = ['Bogotá', 'Medellín', 'Cali', 'Ciudad de México', 'Buenos Aires', 'Santiago', 'Lima'];
            const hash = (categoryText + domainText).length + 6;
            return cities[hash % cities.length];
        }

        function clearTableFilters() {
            const selectIds = ['table-risk-select', 'table-category-select', 'table-area-select', 'table-position-select', 'table-gender-select', 'table-marital-select', 'table-age-select', 'table-country-select', 'table-city-select', 'table-domain-select', 'table-dimension-select'];
            
            selectIds.forEach(selectId => {
                const checkboxes = document.querySelectorAll(`#${selectId} input[type="checkbox"]`);
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Marcar "Todos" como seleccionado
                const todosCheckbox = document.querySelector(`#${selectId} input[type="checkbox"][id$="-todos"]`);
                if (todosCheckbox) {
                    todosCheckbox.checked = true;
                }
                
                updateTableSelectText(selectId);
            });

            document.getElementById('table-search').value = '';
            
            // Mostrar todas las filas y restaurar números originales
            const tableRows = document.querySelectorAll('.results-table tbody tr');
            tableRows.forEach(row => {
                row.style.display = '';
                restoreOriginalNumbers(row);
            });
            
            const badge = document.getElementById('table-filter-badge');
            badge.style.display = 'none';
        }

        function updateTableFilterBadge() {
            const badge = document.getElementById('table-filter-badge');
            let activeFilters = 0;

            const selectIds = ['table-risk-select', 'table-category-select', 'table-area-select', 'table-position-select', 'table-gender-select', 'table-marital-select', 'table-age-select', 'table-country-select', 'table-city-select', 'table-domain-select', 'table-dimension-select'];
            
            selectIds.forEach(selectId => {
                const selectedValues = getTableSelectedValues(selectId);
                if (selectedValues.length > 0 && !selectedValues.includes('todos')) {
                    activeFilters++;
                }
            });

            const searchTerm = document.getElementById('table-search').value;
            if (searchTerm.trim() !== '') {
                activeFilters++;
            }

            if (activeFilters > 0) {
                badge.textContent = activeFilters;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        function setupTableCustomSelects() {
            const selectIds = ['table-risk-select', 'table-category-select', 'table-area-select', 'table-position-select', 'table-gender-select', 'table-marital-select', 'table-age-select', 'table-country-select', 'table-city-select', 'table-domain-select', 'table-dimension-select'];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                const trigger = select.querySelector('.select-trigger');
                const dropdown = select.querySelector('.select-dropdown');
                const options = select.querySelectorAll('.select-option');

                // Toggle dropdown
                trigger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = trigger.classList.contains('active');
                    
                    // Cerrar otros selects
                    selectIds.forEach(id => {
                        if (id !== selectId) {
                            document.getElementById(id).querySelector('.select-trigger').classList.remove('active');
                            document.getElementById(id).querySelector('.select-dropdown').classList.remove('show');
                        }
                    });
                    
                    trigger.classList.toggle('active');
                    dropdown.classList.toggle('show');
                });

                // Manejar clics en opciones
                options.forEach(option => {
                    option.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const checkbox = option.querySelector('input[type="checkbox"]');
                        const isTodos = option.dataset.value === 'todos';
                        
                        if (isTodos) {
                            handleTableTodosOption(selectId, checkbox);
                        } else {
                            checkbox.checked = !checkbox.checked;
                            
                            // Si se selecciona cualquier opción que no sea "Todos", desmarcar "Todos"
                            const todosCheckbox = select.querySelector('input[type="checkbox"][id$="-todos"]');
                            if (checkbox.checked && todosCheckbox.checked) {
                                todosCheckbox.checked = false;
                            }
                            
                            // Si no hay ninguna opción seleccionada, marcar "Todos"
                            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]:not([id$="-todos"])');
                            const checkedBoxes = select.querySelectorAll('input[type="checkbox"]:not([id$="-todos"]):checked');
                            if (checkedBoxes.length === 0) {
                                todosCheckbox.checked = true;
                            }
                        }
                        
                        updateTableSelectText(selectId);
                    });
                });
            });

            // Cerrar dropdowns al hacer clic fuera
            document.addEventListener('click', () => {
                selectIds.forEach(selectId => {
                    const select = document.getElementById(selectId);
                    select.querySelector('.select-trigger').classList.remove('active');
                    select.querySelector('.select-dropdown').classList.remove('show');
                });
            });
        }

        function handleTableTodosOption(selectId, todosCheckbox) {
            const select = document.getElementById(selectId);
            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]');
            
            if (todosCheckbox.checked) {
                // Si "Todos" está marcado, desmarcar todo
                allCheckboxes.forEach(cb => cb.checked = false);
            } else {
                // Si "Todos" no está marcado, marcar "Todos" y desmarcar el resto
                allCheckboxes.forEach(cb => cb.checked = false);
                todosCheckbox.checked = true;
            }
        }

        function updateTableSelectText(selectId) {
            const select = document.getElementById(selectId);
            const textElement = select.querySelector('.select-text');
            const selectedValues = getTableSelectedValues(selectId);
            
            if (selectedValues.length === 0 || selectedValues.includes('todos')) {
                textElement.textContent = 'Seleccionar opciones';
            } else if (selectedValues.length === 1) {
                textElement.textContent = selectedValues[0];
            } else {
                textElement.textContent = `${selectedValues.length} seleccionados`;
            }
        }

        function getTableSelectedValues(selectId) {
            const select = document.getElementById(selectId);
            const checkedBoxes = select.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(checkedBoxes).map(cb => cb.id.replace(selectId.replace('-select', '-'), '').replace('-todos', 'todos'));
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar componentes
            setTimeout(() => {
                loadSidebar('encuestas');
                loadProfileMenu('profile-menu-container');
                loadFloatingMenu('floating-menu-container');
                initializeTabs();
                initializeTableFilters();
                initializeDimensionFilters();
                
                // Abrir la primera categoría por defecto
                const firstCategoryRow = document.querySelector('.category-summary');
                if (firstCategoryRow) {
                    toggleCategoryRow(firstCategoryRow);
                }
            }, 200);
        });
    </script>
</body>
</html>
