<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBITS Playground - Resultados NOM 035</title>
    
    <!-- Estilos locales -->
    <link rel="stylesheet" href="ubits-colors.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="fontawesome-icons.css">
    <link rel="stylesheet" href="ubits-typography.css">
    <link rel="stylesheet" href="components-sidebar.css">
    <link rel="stylesheet" href="components/tab-bar.css">
    <link rel="stylesheet" href="components/floating-menu.css">
    <link rel="stylesheet" href="components/profile-menu.css">
    <link rel="stylesheet" href="components/button.css">
    <link rel="stylesheet" href="profile.css">
    <style>
        /* Estilos específicos para la página de resultados - FIEL AL DISEÑO */
        .results-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
            flex: 1;
            min-width: 0;
            width: 100%;
            overflow: visible;
            max-height: none;
        }

        /* Header de resultados - EXACTO COMO LA IMAGEN */
        .results-header {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 4px;
        }

        .back-button {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
            color: #1f2937;
        }

        .title-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .title-section h1 {
            margin: 0;
            color: #1f2937;
            font-size: 24px;
            font-weight: 700;
        }

        .title-section .status-badge {
            background: #10b981;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }


        .download-button {
            background: var(--ubits-accent-brand);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
            text-decoration: none;
            outline: none;
            position: relative;
        }

        .download-button:hover {
            background: var(--ubits-accent-brand-hover);
            color: white;
        }

        .download-button:active {
            background: var(--ubits-accent-brand);
            transform: translateY(1px);
        }

        .download-button:focus {
            outline: 2px solid var(--ubits-accent-brand);
            outline-offset: 2px;
        }

        .download-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            min-width: 160px;
            z-index: 1000;
            display: none;
            margin-top: 4px;
        }

        .download-dropdown.show {
            display: block;
        }

        .download-dropdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            color: #374151;
            text-decoration: none;
            font-size: 14px;
            transition: background-color 0.2s ease;
        }

        .download-dropdown-item:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        .download-dropdown-item:first-child {
            border-radius: 6px 6px 0 0;
        }

        .download-dropdown-item:last-child {
            border-radius: 0 0 6px 6px;
        }

        /* Información de la encuesta - EXACTO COMO LA IMAGEN */
        .survey-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            margin-bottom: 4px;
        }


        .survey-description {
            color: #6b7280;
            margin-bottom: 16px;
            line-height: 1.5;
            font-size: 14px;
        }

        .survey-details {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .detail-separator {
            width: 1px;
            height: 16px;
            background: #d1d5db;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 6px;
            color: #6b7280;
            font-size: 14px;
        }

        .detail-item.bold {
            font-weight: 600;
        }

        .detail-item i {
            color: #9ca3af;
            font-size: 14px;
        }

        .status-badge {
            background: #10b981;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        /* Métricas - COMPACTAS COMO LA IMAGEN */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 4px;
        }

        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .metric-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .metric-title-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metric-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #f3f4f6;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .metric-title {
            font-size: 14px;
            color: #374151;
            margin: 0;
            font-weight: 600;
        }


        .metric-value-section {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .metric-main-number {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            line-height: 1;
        }

        .metric-unit-text {
            font-size: 14px;
            color: #6b7280;
            font-weight: 400;
        }



        /* Tabs - NUEVO ESTILO CON ICONOS A LA DERECHA */
        .tabs-container {
            background: transparent;
            border-radius: 8px;
            padding: 0;
            margin-bottom: 4px;
        }

        .tabs-header {
            display: flex;
            gap: 8px;
        }

        .tab-button {
            padding: 12px 16px;
            border: none;
            background: transparent;
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-direction: row;
        }

        .tab-button:hover {
            color: #374151;
            background: rgba(0, 0, 0, 0.05);
        }

        .tab-button.active {
            color: #1d4ed8;
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .tab-icon {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .tab-content {
            padding: 24px;
            min-height: 400px;
            width: 100%;
            box-sizing: border-box;
        }

        .tab-panel {
            display: none;
            width: 100%;
            box-sizing: border-box;
        }

        .tab-panel.active {
            display: block;
        }

        /* Panel Emocional - Nuevos Estilos */
        .panel-container {
            display: flex;
            gap: 16px;
            height: 600px;
            width: 100%;
            box-sizing: border-box;
        }

        .participants-panel {
            flex: 1;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            width: 100%;
            box-sizing: border-box;
        }

        .participant-details-panel {
            flex: 2;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            padding: 16px;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
            border-radius: 8px 8px 0 0;
            width: 100%;
            box-sizing: border-box;
        }

        .panel-header h3 {
            margin: 0 0 12px 0;
            color: #1f2937;
            font-size: 16px;
            font-weight: 600;
        }

        .search-filters-container {
            display: flex;
            gap: 8px;
            margin-left: 0;
            margin-right: 0;
            align-items: center;
            width: 100%;
            max-width: 100%;
            background: transparent;
            border: none;
            outline: none;
        }

        .search-container {
            position: relative;
            flex: 1;
            width: 100%;
            max-width: calc(100% - 44px);
            min-width: 0;
            background: transparent;
            border: none;
            outline: none;
        }

        .search-input {
            width: 100%;
            padding: 8px 12px 8px 36px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            box-sizing: border-box;
            position: relative;
            z-index: 1;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            font-size: 14px;
            z-index: 2;
            pointer-events: none;
        }

        .filters-button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #6b7280;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            width: 36px;
            height: 36px;
            flex-shrink: 0;
            box-sizing: border-box;
        }

        .filters-button:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .filters-button:active {
            background: #d1d5db;
        }

        /* Side Panel de Filtros */
        .filters-side-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .filters-side-panel.show {
            right: 0;
        }

        .filters-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .filters-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .filters-header h3 {
            margin: 0;
            color: #1f2937;
            font-size: 18px;
            font-weight: 600;
        }

        .close-filters-btn {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .close-filters-btn:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .filters-content {
            flex: 1;
            padding: 20px 20px 0 20px;
            overflow-y: auto;
            padding-bottom: 100px; /* Espacio para los botones fijos */
        }

        .filter-group {
            margin-bottom: 24px;
        }

        .filter-label {
            display: block;
            color: #374151;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 12px;
        }

        .custom-select {
            position: relative;
            width: 100%;
        }

        .select-trigger {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: #fff;
            color: #374151;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: border-color 0.2s ease;
        }

        .select-trigger:hover {
            border-color: #9ca3af;
        }

        .select-trigger.active {
            border-color: var(--ubits-accent-brand);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .select-trigger .select-text {
            flex: 1;
            text-align: left;
        }

        .select-trigger .select-arrow {
            transition: transform 0.2s ease;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #fff;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .select-dropdown.show {
            display: block;
        }

        .select-option {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s ease;
        }

        .select-option:hover {
            background: #f3f4f6;
        }

        .select-option.selected {
            background: #eff6ff;
            color: var(--ubits-accent-brand);
        }

        .select-option input[type="checkbox"] {
            margin: 0;
        }

        .select-option .option-text {
            flex: 1;
        }

        .filter-actions {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            gap: 12px;
            padding: 20px;
            background: #fff;
            border-top: 1px solid #e5e7eb;
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
        }

        .apply-filters-btn {
            flex: 1;
            background: var(--ubits-accent-brand);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s ease;
        }

        .apply-filters-btn:hover {
            background: var(--ubits-accent-brand-hover);
        }

        .clear-filters-btn {
            background: #f3f4f6;
            color: #6b7280;
            border: 1px solid #d1d5db;
            padding: 10px 16px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s ease;
        }

        .clear-filters-btn:hover {
            background: #e5e7eb;
            color: #374151;
        }

        .participants-list {
            flex: 1;
            overflow-y: auto;
        }

        .participant-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 4px;
            border-left: 4px solid transparent;
        }

        .participant-item:hover {
            background: #f3f4f6;
        }

        .participant-item.selected {
            background: #eff6ff;
            border-left-color: var(--ubits-accent-brand);
        }

        .participant-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            margin-right: 12px;
        }

        .participant-info-content {
            flex: 1;
        }

        .participant-name {
            font-weight: 600;
            color: #1f2937;
            font-size: 14px;
            margin-bottom: 2px;
        }

        .participant-role {
            color: #6b7280;
            font-size: 12px;
        }

        .risk-level {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .risk-nulo { background: #f3f4f6; color: #6b7280; }
        .risk-bajo { background: #dcfce7; color: #166534; }
        .risk-medio { background: #fef3c7; color: #92400e; }
        .risk-alto { background: #fed7aa; color: #c2410c; }
        .risk-muy-alto { background: #fecaca; color: #dc2626; }

        .no-selection {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: #9ca3af;
        }

        .no-selection i {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .no-selection p {
            margin: 0;
            font-size: 14px;
        }

        .participant-info {
            padding: 12px 16px;
            border-bottom: 1px solid #e5e7eb;
        }

        .participant-details {
            display: none;
        }

        .participant-details.show {
            display: block;
        }

        .participant-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .participant-avatar-large {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            margin-right: 12px;
        }

        .participant-details-content h4 {
            margin: 0 0 2px 0;
            color: #1f2937;
            font-size: 16px;
            font-weight: 600;
        }

        .participant-details-content p {
            margin: 0;
            color: #6b7280;
            font-size: 12px;
        }

        .survey-results {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .survey-section {
            margin-bottom: 16px;
        }

        .section-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: #f9fafb;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 4px solid #e5e7eb;
        }

        .section-header:hover {
            background: #f3f4f6;
        }

        .section-header.open {
            background: #eff6ff;
            border-left-color: var(--ubits-accent-brand);
        }

        .section-icon {
            margin-right: 12px;
            font-size: 16px;
            color: #6b7280;
        }

        .section-title {
            flex: 1;
            font-weight: 600;
            color: #1f2937;
            font-size: 14px;
        }

        .section-chevron {
            color: #9ca3af;
            font-size: 12px;
            transition: transform 0.2s ease;
        }

        .section-header.open .section-chevron {
            transform: rotate(180deg);
        }

        .section-content {
            display: none;
            padding: 16px;
            background: white;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 6px 6px;
        }

        .section-content.open {
            display: block;
        }

        .question-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .question-item:last-child {
            border-bottom: none;
        }

        .question-text {
            flex: 1;
            color: #374151;
            font-size: 14px;
            line-height: 1.4;
        }

        .question-answer {
            margin-left: 16px;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .answer-yes {
            background: #dcfce7;
            color: #166534;
        }

        .answer-no {
            background: #fecaca;
            color: #dc2626;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .survey-details {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs-header {
                flex-direction: column;
            }

            .panel-container {
                flex-direction: column;
                height: auto;
            }

            .participants-panel,
            .participant-details-panel {
                flex: none;
            }
        }
    </style>
</head>
<body data-theme="light">
    <div class="dashboard-container">
        <div class="tooltip" id="tooltip"></div>
        
        <!-- Sidebar Container -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Content Area -->
            <div class="content-area">
                <div class="results-container">
                    <!-- Header de resultados - EXACTO COMO LA IMAGEN -->
                    <div class="results-header">
                        <button class="back-button" onclick="window.history.back()">
                            <i class="far fa-arrow-left"></i>
                            <span>Regresar</span>
                        </button>
                        <div class="title-section">
                            <h1>NOM 035</h1>
                            <span class="status-badge">Completado</span>
                        </div>
                        <div style="margin-left: auto; position: relative;">
                            <button class="ubits-button ubits-button--primary ubits-button--md download-button" type="button" id="download-btn">
                                <i class="far fa-download"></i>
                                <span>Descargar</span>
                                <i class="far fa-chevron-down" style="margin-left: 4px; font-size: 12px;"></i>
                            </button>
                            <div class="download-dropdown" id="download-dropdown">
                                <a href="#" class="download-dropdown-item">
                                    <i class="far fa-file-pdf"></i>
                                    <span>PDF</span>
                                </a>
                                <a href="#" class="download-dropdown-item">
                                    <i class="far fa-file-excel"></i>
                                    <span>Excel</span>
                                </a>
                                <a href="#" class="download-dropdown-item">
                                    <i class="far fa-file-csv"></i>
                                    <span>CSV</span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Información de la encuesta - EXACTO COMO LA IMAGEN -->
                    <div class="survey-info">
                        <div class="survey-details">
                            <div class="detail-item">
                                <i class="far fa-users"></i>
                                <span>Enviado a 150 colaboradores</span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-calendar"></i>
                                <span>Inicio 15 octubre 2024</span>
                            </div>
                            <div class="detail-item">
                                <span>Hasta 15 noviembre 2024</span>
                            </div>
                            <div class="detail-separator"></div>
                            <div class="detail-item">
                                <i class="far fa-globe"></i>
                                <span>Pública</span>
                            </div>
                        </div>

                    </div>

                    <!-- Métricas clave - FUERA DEL CONTENEDOR SUPERIOR -->
                    <div class="metrics-grid">
                        <!-- Métrica 1: Total de casos de riesgo -->
                        <div class="metric-card">
                            <div class="metric-header">
                                <div class="metric-title-section">
                                    <div class="metric-icon">
                                        <i class="far fa-chart-bar"></i>
                                    </div>
                                    <h3 class="metric-title">Total de casos en riesgo alto y muy alto</h3>
                                </div>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">5 / 45</div>
                                <div class="metric-unit-text">Casos</div>
                            </div>
                        </div>

                        <!-- Métrica 2: Total canalizados -->
                        <div class="metric-card">
                            <div class="metric-header">
                                <div class="metric-title-section">
                                    <div class="metric-icon">
                                        <i class="far fa-users"></i>
                                    </div>
                                    <h3 class="metric-title">Total de casos canalizados</h3>
                                </div>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">15 / 45</div>
                                <div class="metric-unit-text">Casos</div>
                            </div>
                        </div>

                        <!-- Métrica 3: % de participación -->
                        <div class="metric-card">
                            <div class="metric-header">
                                <div class="metric-title-section">
                                    <div class="metric-icon">
                                        <i class="far fa-check-circle"></i>
                                    </div>
                                    <h3 class="metric-title">% de participación</h3>
                                </div>
                            </div>
                            <div class="metric-value-section">
                                <div class="metric-main-number">140 / 150</div>
                                <div class="metric-unit-text">Colaboradores</div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabs de navegación - EXACTO COMO LA IMAGEN -->
                    <div class="tabs-container">
                        <div class="tabs-header">
                            <button class="tab-button active" data-tab="panel-emocional">
                                <div class="tab-icon">
                                    <i class="far fa-heart"></i>
                                </div>
                                Panel emocional ATS
                            </button>
                            <button class="tab-button" data-tab="general">
                                <div class="tab-icon">
                                    <i class="far fa-chart-bar"></i>
                                </div>
                                General
                            </button>
                        </div>
                        <div class="tab-content">
                            <!-- Panel emocional -->
                            <div class="tab-panel active" id="panel-emocional">
                                <div class="panel-container">
                                    <!-- Panel Izquierdo - Lista de Participantes -->
                                    <div class="participants-panel">
                                        <div class="panel-header">
                                            <h3>Participantes</h3>
                                            <div class="search-filters-container">
                                                <div class="search-container">
                                                    <input type="text" id="participant-search" placeholder="Buscar participante..." class="search-input">
                                                    <i class="far fa-search search-icon"></i>
                                                </div>
                                                <button class="filters-button" id="filters-btn" title="Filtros">
                                                    <i class="far fa-filter"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="participants-list" id="participants-list">
                                            <!-- Lista de participantes se generará dinámicamente -->
                                        </div>
                                    </div>

                                    <!-- Side Panel de Filtros -->
                                    <div class="filters-side-panel" id="filters-side-panel">
                                        <div class="filters-header">
                                            <h3>Filtros</h3>
                                            <button class="close-filters-btn" id="close-filters-btn">
                                                <i class="far fa-times"></i>
                                            </button>
                                        </div>
                                        <div class="filters-content">
                                            <div class="filter-group">
                                                <label class="filter-label">Nivel de Riesgo</label>
                                                <div class="custom-select" id="risk-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar niveles</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="risk-todos">
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="nulo">
                                                            <input type="checkbox" id="risk-nulo">
                                                            <span class="option-text">Nulo</span>
                                                        </div>
                                                        <div class="select-option" data-value="bajo">
                                                            <input type="checkbox" id="risk-bajo">
                                                            <span class="option-text">Bajo</span>
                                                        </div>
                                                        <div class="select-option" data-value="medio">
                                                            <input type="checkbox" id="risk-medio">
                                                            <span class="option-text">Medio</span>
                                                        </div>
                                                        <div class="select-option" data-value="alto">
                                                            <input type="checkbox" id="risk-alto">
                                                            <span class="option-text">Alto</span>
                                                        </div>
                                                        <div class="select-option" data-value="muy-alto">
                                                            <input type="checkbox" id="risk-muy-alto">
                                                            <span class="option-text">Muy Alto</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="filter-group">
                                                <label class="filter-label">Área</label>
                                                <div class="custom-select" id="department-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar áreas</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="dept-todos">
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="Ventas">
                                                            <input type="checkbox" id="dept-ventas">
                                                            <span class="option-text">Ventas</span>
                                                        </div>
                                                        <div class="select-option" data-value="Tecnología">
                                                            <input type="checkbox" id="dept-tecnologia">
                                                            <span class="option-text">Tecnología</span>
                                                        </div>
                                                        <div class="select-option" data-value="Recursos Humanos">
                                                            <input type="checkbox" id="dept-rrhh">
                                                            <span class="option-text">Recursos Humanos</span>
                                                        </div>
                                                        <div class="select-option" data-value="Finanzas">
                                                            <input type="checkbox" id="dept-finanzas">
                                                            <span class="option-text">Finanzas</span>
                                                        </div>
                                                        <div class="select-option" data-value="Administración">
                                                            <input type="checkbox" id="dept-administracion">
                                                            <span class="option-text">Administración</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Cargo</label>
                                                <div class="custom-select" id="position-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar cargos</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="pos-todos">
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="Gerente">
                                                            <input type="checkbox" id="pos-gerente">
                                                            <span class="option-text">Gerente</span>
                                                        </div>
                                                        <div class="select-option" data-value="Desarrollador">
                                                            <input type="checkbox" id="pos-desarrollador">
                                                            <span class="option-text">Desarrollador</span>
                                                        </div>
                                                        <div class="select-option" data-value="Analista">
                                                            <input type="checkbox" id="pos-analista">
                                                            <span class="option-text">Analista</span>
                                                        </div>
                                                        <div class="select-option" data-value="Contador">
                                                            <input type="checkbox" id="pos-contador">
                                                            <span class="option-text">Contador</span>
                                                        </div>
                                                        <div class="select-option" data-value="Asistente">
                                                            <input type="checkbox" id="pos-asistente">
                                                            <span class="option-text">Asistente</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Sexo</label>
                                                <div class="custom-select" id="gender-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar sexo</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="gen-todos">
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="Femenino">
                                                            <input type="checkbox" id="gen-femenino">
                                                            <span class="option-text">Femenino</span>
                                                        </div>
                                                        <div class="select-option" data-value="Masculino">
                                                            <input type="checkbox" id="gen-masculino">
                                                            <span class="option-text">Masculino</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Estado Civil</label>
                                                <div class="custom-select" id="marital-status-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar estado civil</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="est-todos">
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="Soltero">
                                                            <input type="checkbox" id="est-soltero">
                                                            <span class="option-text">Soltero</span>
                                                        </div>
                                                        <div class="select-option" data-value="Casado">
                                                            <input type="checkbox" id="est-casado">
                                                            <span class="option-text">Casado</span>
                                                        </div>
                                                        <div class="select-option" data-value="Divorciada">
                                                            <input type="checkbox" id="est-divorciada">
                                                            <span class="option-text">Divorciada</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="filter-group">
                                                <label class="filter-label">Edad</label>
                                                <div class="custom-select" id="age-select">
                                                    <div class="select-trigger">
                                                        <span class="select-text">Seleccionar rango de edad</span>
                                                        <i class="fas fa-chevron-down select-arrow"></i>
                                                    </div>
                                                    <div class="select-dropdown">
                                                        <div class="select-option" data-value="todos">
                                                            <input type="checkbox" id="age-todos">
                                                            <span class="option-text">Todos</span>
                                                        </div>
                                                        <div class="select-option" data-value="20-30">
                                                            <input type="checkbox" id="age-20-30">
                                                            <span class="option-text">20-30 años</span>
                                                        </div>
                                                        <div class="select-option" data-value="31-40">
                                                            <input type="checkbox" id="age-31-40">
                                                            <span class="option-text">31-40 años</span>
                                                        </div>
                                                        <div class="select-option" data-value="41-50">
                                                            <input type="checkbox" id="age-41-50">
                                                            <span class="option-text">41-50 años</span>
                                                        </div>
                                                        <div class="select-option" data-value="51+">
                                                            <input type="checkbox" id="age-51+">
                                                            <span class="option-text">51+ años</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="filter-actions">
                                                <button class="apply-filters-btn" id="apply-filters-btn">
                                                    <i class="far fa-check"></i>
                                                    Aplicar Filtros
                                                </button>
                                                <button class="clear-filters-btn" id="clear-filters-btn">
                                                    <i class="far fa-times"></i>
                                                    Limpiar
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="filters-overlay" id="filters-overlay"></div>

                                    <!-- Panel Derecho - Detalles del Participante -->
                                    <div class="participant-details-panel">
                                        <div class="panel-header">
                                            <h3>Detalles del Participante</h3>
                                        </div>
                                        <div class="participant-info" id="participant-info">
                                            <div class="no-selection">
                                                <i class="far fa-user"></i>
                                                <p>Selecciona un participante para ver sus detalles</p>
                                            </div>
                                        </div>
                                        <div class="survey-results" id="survey-results">
                                            <!-- Resultados de la encuesta se mostrarán aquí -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- General -->
                            <div class="tab-panel" id="general">
                                <h3 style="margin-bottom: 16px; color: #1f2937; font-size: 18px; font-weight: 600;">General</h3>
                                <p style="color: #6b7280; margin-bottom: 24px; line-height: 1.5;">
                                    Vista general de todos los resultados de la encuesta NOM 035, incluyendo métricas consolidadas y tendencias.
                                </p>
                                <!-- Aquí iría el contenido específico del panel general -->
                                <div style="margin-top: 24px; padding: 20px; background: #f9fafb; border-radius: 8px; text-align: center;">
                                    <i class="far fa-chart-bar" style="font-size: 48px; color: #9ca3af; margin-bottom: 16px;"></i>
                                    <p style="color: #6b7280;">
                                        Contenido del panel general se cargará aquí
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Tab Bar Container -->
    <div id="tab-bar-container"></div>

    <!-- Floating Menu Container -->
    <div id="floating-menu-container"></div>
    
    <!-- Profile Menu Container -->
    <div id="profile-menu-container"></div>

    <script src="components/sidebar.js"></script>
    <script src="components/tab-bar.js"></script>
    <script src="components/floating-menu.js"></script>
    <script src="components/profile-menu.js"></script>
    <script src="script.js"></script>
    <script>
        // Cargar componentes dinámicamente
        document.addEventListener('DOMContentLoaded', function() {
            loadSidebar('sidebar-container', 'encuestas');
            loadTabBar('tab-bar-container');
            loadFloatingMenu('floating-menu-container');
            loadProfileMenu('profile-menu-container');
            
            // Activar el tab "Encuestas" específicamente después de cargar el SubNav
            setTimeout(() => {
                // Remover active de todos los tabs (desktop y móvil)
                document.querySelectorAll('.nav-tab, .hamburger-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Activar el tab Encuestas en desktop
                const encuestasTab = document.querySelector('.nav-tab[data-tab="encuestas"]');
                if (encuestasTab) {
                    encuestasTab.classList.add('active');
                }
                
                // Activar el tab Encuestas en móvil (hamburger menu)
                const encuestasHamburger = document.querySelector('.hamburger-item[data-tab="encuestas"]');
                if (encuestasHamburger) {
                    encuestasHamburger.classList.add('active');
                }
                
                // Activar el botón de encuestas en el sidebar
                const encuestasButton = document.querySelector('.nav-button[data-section="encuestas"]');
                if (encuestasButton) {
                    // Remover active de todos los botones del sidebar
                    document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
                    // Activar el botón de encuestas
                    encuestasButton.classList.add('active');
                }
                
                // Activar el botón "Módulos" del Tab-bar móvil
                const modulosTabBarItem = document.querySelector('.tab-bar-item[data-tab="modulos"]');
                if (modulosTabBarItem) {
                    // Remover active de todos los items del tab-bar
                    document.querySelectorAll('.tab-bar-item').forEach(item => item.classList.remove('active'));
                    // Activar el item módulos
                    modulosTabBarItem.classList.add('active');
                }
                
                // Activar la opción "Encuestas" como direct link del floating menu
                if (typeof setActiveDirectLink === 'function') {
                    setActiveDirectLink('encuestas');
                }
            }, 200);
        });

        // Funcionalidad de tabs
        document.addEventListener('DOMContentLoaded', function() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanels = document.querySelectorAll('.tab-panel');

            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');
                    
                    // Remover active de todos los botones y paneles
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabPanels.forEach(panel => panel.classList.remove('active'));
                    
                    // Activar el botón y panel seleccionado
                    this.classList.add('active');
                    document.getElementById(targetTab).classList.add('active');
                });
            });

            // Funcionalidad del desplegable de descarga
            const downloadBtn = document.getElementById('download-btn');
            const downloadDropdown = document.getElementById('download-dropdown');
            
            if (downloadBtn && downloadDropdown) {
                downloadBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    downloadDropdown.classList.toggle('show');
                });
                
                // Cerrar desplegable al hacer clic fuera
                document.addEventListener('click', function(e) {
                    if (!downloadBtn.contains(e.target) && !downloadDropdown.contains(e.target)) {
                        downloadDropdown.classList.remove('show');
                    }
                });
            }

        });

        // Datos de participantes de ejemplo
        const participantsData = [
            {
                id: 1,
                name: "María González",
                role: "Gerente de Ventas",
                riskLevel: "muy-alto",
                avatar: "MG",
                avatarColor: "#dc2626",
                details: {
                    age: 35,
                    department: "Ventas",
                    position: "Gerente",
                    gender: "Femenino",
                    maritalStatus: "Casada",
                    experience: "8 años",
                    email: "maria.gonzalez@empresa.com"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "Sí" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "Sí" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "Sí" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "Sí" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "Sí" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "Sí" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "Sí" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "Sí" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "Sí" }
                    ]
                }
            },
            {
                id: 2,
                name: "Carlos Rodríguez",
                role: "Desarrollador Senior",
                riskLevel: "alto",
                avatar: "CR",
                avatarColor: "#c2410c",
                details: {
                    age: 28,
                    department: "Tecnología",
                    position: "Desarrollador",
                    gender: "Masculino",
                    maritalStatus: "Soltero",
                    experience: "5 años",
                    email: "carlos.rodriguez@empresa.com"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "Sí" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "Sí" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "Sí" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "Sí" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "Sí" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "Sí" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                }
            },
            {
                id: 3,
                name: "Ana Martínez",
                role: "Analista de Recursos Humanos",
                riskLevel: "medio",
                avatar: "AM",
                avatarColor: "#92400e",
                details: {
                    age: 32,
                    department: "Recursos Humanos",
                    position: "Analista",
                    gender: "Femenino",
                    maritalStatus: "Divorciada",
                    experience: "6 años",
                    email: "ana.martinez@empresa.com"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "Sí" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "Sí" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                }
            },
            {
                id: 4,
                name: "Luis Fernández",
                role: "Contador",
                riskLevel: "bajo",
                avatar: "LF",
                avatarColor: "#166534",
                details: {
                    age: 45,
                    department: "Finanzas",
                    position: "Contador",
                    gender: "Masculino",
                    maritalStatus: "Casado",
                    experience: "12 años",
                    email: "luis.fernandez@empresa.com"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                }
            },
            {
                id: 5,
                name: "Sofia Herrera",
                role: "Asistente Administrativa",
                riskLevel: "nulo",
                avatar: "SH",
                avatarColor: "#6b7280",
                details: {
                    age: 26,
                    department: "Administración",
                    position: "Asistente",
                    gender: "Femenino",
                    maritalStatus: "Soltera",
                    experience: "3 años",
                    email: "sofia.herrera@empresa.com"
                },
                surveyResults: {
                    "Sección I. Acontecimiento traumático severo": [
                        { question: "¿Has presenciado o vivido algún accidente grave en tu trabajo?", answer: "No" },
                        { question: "¿Has sufrido lesiones que pusieron en riesgo tu vida en el trabajo?", answer: "No" },
                        { question: "¿Has sido testigo de la muerte o lesiones graves de algún compañero?", answer: "No" },
                        { question: "¿Has sido amenazado de muerte o sufrido algún tipo de agresión en tu trabajo?", answer: "No" },
                        { question: "¿Has vivido algún asalto, secuestro o intento de agresión en tu entorno laboral?", answer: "No" },
                        { question: "¿Has estado en situaciones de incendio, explosión o desastre natural en el trabajo?", answer: "No" }
                    ],
                    "Sección II. Recuerdos persistentes sobre el acontecimiento": [
                        { question: "¿Vuelves a pensar constantemente en lo que ocurrió o en las imágenes del suceso?", answer: "No" },
                        { question: "¿Tienes pesadillas o sueños repetitivos sobre lo que pasó?", answer: "No" }
                    ],
                    "Sección III. Esfuerzo por evitar circunstancias parecidas o asociadas al acontecimiento": [
                        { question: "¿Evitas hablar o pensar en lo que ocurrió porque te hace sentir mal?", answer: "No" },
                        { question: "¿Evitas lugares o personas que te recuerdan lo sucedido?", answer: "No" },
                        { question: "¿Sientes que lo ocurrido sigue afectando tu vida diaria?", answer: "No" },
                        { question: "¿Has notado que te cuesta disfrutar de cosas que antes te gustaban?", answer: "No" },
                        { question: "¿Sientes que te has alejado emocionalmente de otras personas?", answer: "No" },
                        { question: "¿Tienes dificultad para sentir cariño o cercanía con los demás?", answer: "No" },
                        { question: "¿Te cuesta mantener el interés por tu trabajo o por las actividades cotidianas?", answer: "No" }
                    ],
                    "Sección IV. Afectación": [
                        { question: "¿Has notado dificultad para dormir después de lo ocurrido?", answer: "No" },
                        { question: "¿Te irritas con facilidad o te cuesta controlar tu enojo?", answer: "No" },
                        { question: "¿Te cuesta concentrarte en tus tareas diarias?", answer: "No" },
                        { question: "¿Sientes que estás siempre en alerta o en tensión?", answer: "No" },
                        { question: "¿Te sobresaltas fácilmente ante ruidos o movimientos repentinos?", answer: "No" }
                    ]
                }
            }
        ];

        // Inicializar panel emocional
        function initializeEmotionalPanel() {
            renderParticipantsList();
            setupSearch();
        }

        // Renderizar lista de participantes
        function renderParticipantsList(participants = participantsData) {
            const participantsList = document.getElementById('participants-list');
            participantsList.innerHTML = '';

            participants.forEach(participant => {
                const participantItem = document.createElement('div');
                participantItem.className = 'participant-item';
                participantItem.dataset.participantId = participant.id;
                
                participantItem.innerHTML = `
                    <div class="participant-avatar" style="background-color: ${participant.avatarColor}">
                        ${participant.avatar}
                    </div>
                    <div class="participant-info-content">
                        <div class="participant-name">${participant.name}</div>
                        <div class="participant-role">${participant.role}</div>
                    </div>
                    <div class="risk-level risk-${participant.riskLevel}">
                        ${participant.riskLevel.replace('-', ' ')}
                    </div>
                `;

                participantItem.addEventListener('click', () => {
                    selectParticipant(participant.id);
                });

                participantsList.appendChild(participantItem);
            });
        }

        // Seleccionar participante
        function selectParticipant(participantId) {
            // Remover selección anterior
            document.querySelectorAll('.participant-item').forEach(item => {
                item.classList.remove('selected');
            });

            // Agregar selección al item actual
            document.querySelector(`[data-participant-id="${participantId}"]`).classList.add('selected');

            // Mostrar detalles del participante
            showParticipantDetails(participantId);
        }

        // Mostrar detalles del participante
        function showParticipantDetails(participantId) {
            const participant = participantsData.find(p => p.id === participantId);
            if (!participant) return;

            const participantInfo = document.getElementById('participant-info');
            const surveyResults = document.getElementById('survey-results');

            // Mostrar información del participante
            participantInfo.innerHTML = `
                <div class="participant-details show">
                    <div class="participant-header">
                        <div class="participant-avatar-large" style="background-color: ${participant.avatarColor}">
                            ${participant.avatar}
                        </div>
                        <div class="participant-details-content">
                            <h4>${participant.name}</h4>
                            <p>${participant.role} • ${participant.details.department}</p>
                            <p>${participant.details.age} años • ${participant.details.gender} • ${participant.details.maritalStatus}</p>
                            <p>${participant.details.experience} de experiencia</p>
                        </div>
                    </div>
                </div>
            `;

            // Mostrar resultados de la encuesta
            surveyResults.innerHTML = `
                <div class="survey-section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <i class="far fa-comment section-icon"></i>
                        <div class="section-title">💬 Encuesta Emocional — NOM-035 (Guía I: Acontecimientos Traumáticos Severos)</div>
                        <i class="far fa-chevron-down section-chevron"></i>
                    </div>
                    <div class="section-content">
                        ${Object.entries(participant.surveyResults).map(([sectionName, questions]) => `
                            <div class="survey-section">
                                <div class="section-header" onclick="toggleSection(this)">
                                    <i class="far fa-circle section-icon"></i>
                                    <div class="section-title">🔹 ${sectionName}</div>
                                    <i class="far fa-chevron-down section-chevron"></i>
                                </div>
                                <div class="section-content">
                                    ${questions.map(q => `
                                        <div class="question-item">
                                            <div class="question-text">${q.question}</div>
                                            <div class="question-answer ${q.answer === 'Sí' ? 'answer-yes' : 'answer-no'}">
                                                ${q.answer}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Toggle de secciones (acordeones)
        function toggleSection(header) {
            const content = header.nextElementSibling;
            const isOpen = content.classList.contains('open');

            // Cerrar todas las secciones del mismo nivel
            const parent = header.closest('.section-content');
            if (parent) {
                parent.querySelectorAll('.section-content').forEach(section => {
                    section.classList.remove('open');
                    section.previousElementSibling.classList.remove('open');
                });
            }

            // Toggle de la sección actual
            if (!isOpen) {
                content.classList.add('open');
                header.classList.add('open');
            }
        }


        // Inicializar panel emocional cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initializeEmotionalPanel();
                setupFilters();
            }, 500);
        });

        // Función para actualizar el texto del select
        function updateSelectText(selectId) {
            const select = document.getElementById(selectId);
            const selectedValues = getSelectedValues(selectId);
            const selectText = select.querySelector('.select-text');
            
            if (selectedValues.length === 0) {
                selectText.textContent = selectText.textContent.split(':')[0] + ': Seleccionar';
            } else if (selectedValues.includes('todos')) {
                selectText.textContent = selectText.textContent.split(':')[0] + ': Todos';
            } else if (selectedValues.length === 1) {
                selectText.textContent = selectText.textContent.split(':')[0] + ': ' + selectedValues[0];
            } else {
                selectText.textContent = selectText.textContent.split(':')[0] + ': ' + selectedValues.length + ' seleccionados';
            }
        }

        // Función para manejar la opción "Todos"
        function handleTodosOption(selectId, todosCheckbox) {
            const select = document.getElementById(selectId);
            const allCheckboxes = select.querySelectorAll('input[type="checkbox"]');
            
            if (todosCheckbox.checked) {
                // Si se selecciona "Todos", deseleccionar todo lo demás
                allCheckboxes.forEach(cb => {
                    if (cb !== todosCheckbox) {
                        cb.checked = false;
                    }
                });
            } else {
                // Si se deselecciona "Todos", verificar si hay otras opciones seleccionadas
                const otherSelected = Array.from(allCheckboxes).some(cb => cb !== todosCheckbox && cb.checked);
                if (!otherSelected) {
                    // Si no hay otras opciones seleccionadas, seleccionar "Todos"
                    todosCheckbox.checked = true;
                }
            }
        }

        // Configurar componente select personalizado
        function setupCustomSelects() {
            const customSelects = document.querySelectorAll('.custom-select');
            
            customSelects.forEach(select => {
                const trigger = select.querySelector('.select-trigger');
                const dropdown = select.querySelector('.select-dropdown');
                const options = select.querySelectorAll('.select-option');
                
                // Toggle dropdown
                trigger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isActive = trigger.classList.contains('active');
                    
                    // Cerrar otros selects
                    customSelects.forEach(otherSelect => {
                        if (otherSelect !== select) {
                            otherSelect.querySelector('.select-trigger').classList.remove('active');
                            otherSelect.querySelector('.select-dropdown').classList.remove('show');
                        }
                    });
                    
                    // Toggle current select
                    trigger.classList.toggle('active');
                    dropdown.classList.toggle('show');
                });
                
                // Manejar clics en opciones
                options.forEach(option => {
                    const checkbox = option.querySelector('input[type="checkbox"]');
                    
                    option.addEventListener('click', (e) => {
                        e.stopPropagation();
                        checkbox.checked = !checkbox.checked;
                        
                        // Manejar opción "Todos"
                        if (option.dataset.value === 'todos') {
                            handleTodosOption(select.id, checkbox);
                        } else {
                            // Si se selecciona una opción específica, deseleccionar "Todos"
                            const todosCheckbox = select.querySelector('input[type="checkbox"][id$="-todos"]');
                            if (todosCheckbox && todosCheckbox.checked) {
                                todosCheckbox.checked = false;
                            }
                        }
                        
                        updateSelectText(select.id);
                        applyFilters();
                    });
                });
            });
            
            // Cerrar dropdowns al hacer clic fuera
            document.addEventListener('click', () => {
                customSelects.forEach(select => {
                    select.querySelector('.select-trigger').classList.remove('active');
                    select.querySelector('.select-dropdown').classList.remove('show');
                });
            });
        }

        // Configurar funcionalidad de filtros
        function setupFilters() {
            const filtersBtn = document.getElementById('filters-btn');
            const filtersSidePanel = document.getElementById('filters-side-panel');
            const filtersOverlay = document.getElementById('filters-overlay');
            const closeFiltersBtn = document.getElementById('close-filters-btn');
            const applyFiltersBtn = document.getElementById('apply-filters-btn');
            const clearFiltersBtn = document.getElementById('clear-filters-btn');

            // Abrir side panel
            filtersBtn.addEventListener('click', () => {
                filtersSidePanel.classList.add('show');
                filtersOverlay.classList.add('show');
            });

            // Cerrar side panel
            function closeFilters() {
                filtersSidePanel.classList.remove('show');
                filtersOverlay.classList.remove('show');
            }

            closeFiltersBtn.addEventListener('click', closeFilters);
            filtersOverlay.addEventListener('click', closeFilters);

            // Aplicar filtros
            applyFiltersBtn.addEventListener('click', () => {
                applyFilters();
                closeFilters();
            });

            // Limpiar filtros
            clearFiltersBtn.addEventListener('click', () => {
                clearFilters();
                applyFilters();
            });

            // Configurar selects personalizados
            setupCustomSelects();
        }

        // Aplicar filtros
        function applyFilters() {
            const riskFilters = getSelectedValues('risk-select');
            const departmentFilters = getSelectedValues('department-select');
            const positionFilters = getSelectedValues('position-select');
            const genderFilters = getSelectedValues('gender-select');
            const maritalStatusFilters = getSelectedValues('marital-status-select');
            const ageFilters = getSelectedValues('age-select');
            const searchTerm = document.getElementById('participant-search').value.toLowerCase();

            console.log('Aplicando filtros:', {
                riskFilters,
                departmentFilters,
                positionFilters,
                genderFilters,
                maritalStatusFilters,
                ageFilters,
                searchTerm
            });

            let filteredParticipants = participantsData.filter(participant => {
                // Filtro por búsqueda
                const matchesSearch = !searchTerm || 
                    participant.name.toLowerCase().includes(searchTerm) ||
                    participant.role.toLowerCase().includes(searchTerm) ||
                    participant.details.department.toLowerCase().includes(searchTerm) ||
                    participant.details.position.toLowerCase().includes(searchTerm) ||
                    participant.details.gender.toLowerCase().includes(searchTerm) ||
                    participant.details.maritalStatus.toLowerCase().includes(searchTerm);

                // Filtro por nivel de riesgo
                const matchesRisk = riskFilters.length === 0 || riskFilters.includes('todos') || riskFilters.includes(participant.riskLevel);

                // Filtro por área (departamento)
                const matchesDepartment = departmentFilters.length === 0 || departmentFilters.includes('todos') || departmentFilters.includes(participant.details.department);

                // Filtro por cargo
                const matchesPosition = positionFilters.length === 0 || positionFilters.includes('todos') || positionFilters.includes(participant.details.position);

                // Filtro por sexo
                const matchesGender = genderFilters.length === 0 || genderFilters.includes('todos') || genderFilters.includes(participant.details.gender);

                // Filtro por estado civil
                const matchesMaritalStatus = maritalStatusFilters.length === 0 || maritalStatusFilters.includes('todos') || maritalStatusFilters.includes(participant.details.maritalStatus);

                // Filtro por edad
                const matchesAge = ageFilters.length === 0 || ageFilters.includes('todos') || matchesAgeRange(participant.details.age, ageFilters);

                const matches = matchesSearch && matchesRisk && matchesDepartment && matchesPosition && matchesGender && matchesMaritalStatus && matchesAge;
                
                if (departmentFilters.length > 0 && !departmentFilters.includes('todos')) {
                    console.log(`Participante ${participant.name} (${participant.details.department}): matchesDepartment = ${matchesDepartment}, departmentFilters = ${departmentFilters}`);
                }
                
                return matches;
            });

            console.log(`Filtrados ${filteredParticipants.length} de ${participantsData.length} participantes`);
            renderParticipantsList(filteredParticipants);
        }

        // Función auxiliar para verificar rango de edad
        function matchesAgeRange(age, ageFilters) {
            return ageFilters.some(range => {
                switch(range) {
                    case '20-30':
                        return age >= 20 && age <= 30;
                    case '31-40':
                        return age >= 31 && age <= 40;
                    case '41-50':
                        return age >= 41 && age <= 50;
                    case '51+':
                        return age >= 51;
                    default:
                        return false;
                }
            });
        }

        // Función auxiliar para obtener valores seleccionados
        function getSelectedValues(selectId) {
            const select = document.getElementById(selectId);
            const checkboxes = select.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(checkboxes).map(cb => cb.closest('.select-option').dataset.value);
        }

        // Limpiar filtros
        function clearFilters() {
            const selectIds = ['risk-select', 'department-select', 'position-select', 'gender-select', 'marital-status-select', 'age-select'];
            
            selectIds.forEach(selectId => {
                const select = document.getElementById(selectId);
                const checkboxes = select.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(cb => cb.checked = false);
                updateSelectText(selectId);
            });
            
            document.getElementById('participant-search').value = '';
            renderParticipantsList(participantsData);
        }

        // Actualizar función de búsqueda para incluir filtros
        function setupSearch() {
            const searchInput = document.getElementById('participant-search');
            searchInput.addEventListener('input', () => {
                applyFilters();
            });
        }
    </script>
</body>
</html>
